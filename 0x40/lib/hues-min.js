/*! For license information please see hues-min.js.LICENSE.txt */
(()=>{var t={643:()=>{String.prototype.score=function(t,e){"use strict";if(this===t)return 1;if(""===t)return 0;var n,i,s,r,a,o=0,l=this,d=l.toLowerCase(),c=l.length,h=t.toLowerCase(),u=t.length,p=0,m=1;if(e&&(r=1-e),e)for(a=0;a<u;a+=1)-1===(s=d.indexOf(h[a],p))?m+=r:(p===s?n=.7:(n=.1," "===l[s-1]&&(n+=.8)),l[s]===t[a]&&(n+=.1),o+=n,p=s+1);else for(a=0;a<u;a+=1){if(-1===(s=d.indexOf(h[a],p)))return 0;p===s?n=.7:(n=.1," "===l[s-1]&&(n+=.8)),l[s]===t[a]&&(n+=.1),o+=n,p=s+1}return i=.5*(o/c+o/u)/m,h[0]===d[0]&&i<.85&&(i+=.15),i}},555:function(t){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},267:function(t){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},31:function(t){(function(){var e,n,i,s,r,a,o,l={}.hasOwnProperty;e=function(t,...e){var n,i,s,a;if(r(Object.assign))Object.assign.apply(null,arguments);else for(n=0,s=e.length;n<s;n++)if(null!=(a=e[n]))for(i in a)l.call(a,i)&&(t[i]=a[i]);return t},r=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},a=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},i=function(t){return r(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},s=function(t){var e;if(i(t))return!t.length;for(e in t)if(l.call(t,e))return!1;return!0},o=function(t){var e,n;return a(t)&&(n=Object.getPrototypeOf(t))&&(e=n.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},n=function(t){return r(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=r,t.exports.isObject=a,t.exports.isArray=i,t.exports.isEmpty=s,t.exports.isPlainObject=o,t.exports.getValue=n}).call(this)},121:function(t){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},177:function(t,e,n){(function(){var e;e=n(267),n(251),t.exports=function(){class t{constructor(t,n,i){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==n)throw new Error("Missing attribute name. "+this.debugInfo(n));this.name=this.stringify.name(n),this.value=this.stringify.attValue(i),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}clone(){return Object.create(this)}toString(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))}debugInfo(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"}isEqualNode(t){return t.namespaceURI===this.namespaceURI&&t.prefix===this.prefix&&t.localName===this.localName&&t.value===this.value}}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t}.call(this)}).call(this)},954:function(t,e,n){(function(){var e,i;e=n(267),i=n(372),t.exports=class extends i{constructor(t,n){if(super(t),null==n)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))}}}).call(this)},372:function(t,e,n){(function(){var e;e=n(251),t.exports=function(){class t extends e{constructor(t){super(t),this.value=""}clone(){return Object.create(this)}substringData(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendData(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}insertData(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}deleteData(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceData(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(t){return!!super.isEqualNode(t)&&t.data===this.data}}return Object.defineProperty(t.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),t}.call(this)}).call(this)},190:function(t,e,n){(function(){var e,i;e=n(267),i=n(372),t.exports=class extends i{constructor(t,n){if(super(t),null==n)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))}}}).call(this)},958:function(t,e,n){(function(){var e,i;e=n(473),i=n(67),t.exports=function(){class t{constructor(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}getParameter(t){return this.params.hasOwnProperty(t)?this.params[t]:null}canSetParameter(t,e){return!0}setParameter(t,e){return null!=e?this.params[t]=e:delete this.params[t]}}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new i(Object.keys(this.defaultParams))}}),t}.call(this)}).call(this)},473:function(t){(function(){t.exports=class{constructor(){}handleError(t){throw new Error(t)}}}).call(this)},482:function(t){(function(){t.exports=class{hasFeature(t,e){return!0}createDocumentType(t,e,n){throw new Error("This DOM method is not implemented.")}createDocument(t,e,n){throw new Error("This DOM method is not implemented.")}createHTMLDocument(t){throw new Error("This DOM method is not implemented.")}getFeature(t,e){throw new Error("This DOM method is not implemented.")}}}).call(this)},67:function(t){(function(){t.exports=function(){class t{constructor(t){this.arr=t||[]}item(t){return this.arr[t]||null}contains(t){return-1!==this.arr.indexOf(t)}}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t}.call(this)}).call(this)},654:function(t,e,n){(function(){var e,i;i=n(251),e=n(267),t.exports=class extends i{constructor(t,n,i,s,r,a){if(super(t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==i)throw new Error("Missing DTD attribute name. "+this.debugInfo(n));if(!s)throw new Error("Missing DTD attribute type. "+this.debugInfo(n));if(!r)throw new Error("Missing DTD attribute default. "+this.debugInfo(n));if(0!==r.indexOf("#")&&(r="#"+r),!r.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(n));if(a&&!r.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(n));this.elementName=this.stringify.name(n),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(i),this.attributeType=this.stringify.dtdAttType(s),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=r}toString(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))}}}).call(this)},927:function(t,e,n){(function(){var e,i;i=n(251),e=n(267),t.exports=class extends i{constructor(t,n,i){if(super(t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());i||(i="(#PCDATA)"),Array.isArray(i)&&(i="("+i.join(",")+")"),this.name=this.stringify.name(n),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(i)}toString(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))}}}).call(this)},475:function(t,e,n){(function(){var e,i,s;({isObject:s}=n(31)),i=n(251),e=n(267),t.exports=function(){class t extends i{constructor(t,n,i,r){if(super(t),null==i)throw new Error("Missing DTD entity name. "+this.debugInfo(i));if(null==r)throw new Error("Missing DTD entity value. "+this.debugInfo(i));if(this.pe=!!n,this.name=this.stringify.name(i),this.type=e.EntityDeclaration,s(r)){if(!r.pubID&&!r.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(i));if(r.pubID&&!r.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(i));if(this.internal=!1,null!=r.pubID&&(this.pubID=this.stringify.dtdPubID(r.pubID)),null!=r.sysID&&(this.sysID=this.stringify.dtdSysID(r.sysID)),null!=r.nData&&(this.nData=this.stringify.dtdNData(r.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(i))}else this.value=this.stringify.dtdEntityValue(r),this.internal=!0}toString(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))}}return Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(t.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(t.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(t.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(t.prototype,"xmlVersion",{get:function(){return null}}),t}.call(this)}).call(this)},222:function(t,e,n){(function(){var e,i;i=n(251),e=n(267),t.exports=function(){class t extends i{constructor(t,n,i){if(super(t),null==n)throw new Error("Missing DTD notation name. "+this.debugInfo(n));if(!i.pubID&&!i.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(n));this.name=this.stringify.name(n),this.type=e.NotationDeclaration,null!=i.pubID&&(this.pubID=this.stringify.dtdPubID(i.pubID)),null!=i.sysID&&(this.sysID=this.stringify.dtdSysID(i.sysID))}toString(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))}}return Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),t}.call(this)}).call(this)},918:function(t,e,n){(function(){var e,i,s;({isObject:s}=n(31)),i=n(251),e=n(267),t.exports=class extends i{constructor(t,n,i,r){super(t),s(n)&&({version:n,encoding:i,standalone:r}=n),n||(n="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(n),null!=i&&(this.encoding=this.stringify.xmlEncoding(i)),null!=r&&(this.standalone=this.stringify.xmlStandalone(r))}toString(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))}}}).call(this)},3:function(t,e,n){(function(){var e,i,s,r,a,o,l,d;({isObject:d}=n(31)),l=n(251),e=n(267),i=n(654),r=n(475),s=n(927),a=n(222),o=n(385),t.exports=function(){class t extends l{constructor(t,n,i){var s,r,a,o;if(super(t),this.type=e.DocType,t.children)for(r=0,a=(o=t.children).length;r<a;r++)if((s=o[r]).type===e.Element){this.name=s.name;break}this.documentObject=t,d(n)&&({pubID:n,sysID:i}=n),null==i&&([i,n]=[n,i]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=i&&(this.sysID=this.stringify.dtdSysID(i))}element(t,e){var n;return n=new s(this,t,e),this.children.push(n),this}attList(t,e,n,s,r){var a;return a=new i(this,t,e,n,s,r),this.children.push(a),this}entity(t,e){var n;return n=new r(this,!1,t,e),this.children.push(n),this}pEntity(t,e){var n;return n=new r(this,!0,t,e),this.children.push(n),this}notation(t,e){var n;return n=new a(this,t,e),this.children.push(n),this}toString(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))}ele(t,e){return this.element(t,e)}att(t,e,n,i,s){return this.attList(t,e,n,i,s)}ent(t,e){return this.entity(t,e)}pent(t,e){return this.pEntity(t,e)}not(t,e){return this.notation(t,e)}up(){return this.root()||this.documentObject}isEqualNode(t){return!!super.isEqualNode(t)&&t.name===this.name&&t.publicId===this.publicId&&t.systemId===this.systemId}}return Object.defineProperty(t.prototype,"entities",{get:function(){var t,n,i,s,r;for(s={},n=0,i=(r=this.children).length;n<i;n++)(t=r[n]).type!==e.EntityDeclaration||t.pe||(s[t.name]=t);return new o(s)}}),Object.defineProperty(t.prototype,"notations",{get:function(){var t,n,i,s,r;for(s={},n=0,i=(r=this.children).length;n<i;n++)(t=r[n]).type===e.NotationDeclaration&&(s[t.name]=t);return new o(s)}}),Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(t.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t}.call(this)}).call(this)},726:function(t,e,n){(function(){var e,i,s,r,a,o,l;({isPlainObject:l}=n(31)),s=n(482),i=n(958),r=n(251),e=n(267),o=n(630),a=n(166),t.exports=function(){class t extends r{constructor(t){super(null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new i,t||(t={}),t.writer||(t.writer=new a),this.options=t,this.stringify=new o(t)}end(t){var e;return e={},t?l(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))}toString(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))}createElement(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createDocumentFragment(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTextNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createComment(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createCDATASection(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createProcessingInstruction(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttribute(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEntityReference(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}importNode(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createElementNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementById(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}adoptNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalizeDocument(){throw new Error("This DOM method is not implemented."+this.debugInfo())}renameNode(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEvent(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createRange(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createNodeIterator(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTreeWalker(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(t.prototype,"implementation",{value:new s}),Object.defineProperty(t.prototype,"doctype",{get:function(){var t,n,i,s;for(n=0,i=(s=this.children).length;n<i;n++)if((t=s[n]).type===e.DocType)return t;return null}}),Object.defineProperty(t.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(t.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(t.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(t.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(t.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(t.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(t.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(t.prototype,"origin",{get:function(){return null}}),Object.defineProperty(t.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(t.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(t.prototype,"contentType",{get:function(){return null}}),t}.call(this)}).call(this)},153:function(t,e,n){(function(){var e,i,s,r,a,o,l,d,c,h,u,p,m,f,g,b,w,x,v,y,k,_,A={}.hasOwnProperty;({isObject:k,isFunction:y,isPlainObject:_,getValue:v}=n(31)),e=n(267),p=n(726),m=n(632),r=n(954),a=n(190),g=n(830),x=n(690),f=n(879),h=n(918),u=n(3),o=n(654),d=n(475),l=n(927),c=n(222),s=n(177),w=n(630),b=n(166),i=n(121),t.exports=class{constructor(t,n,i){var s;this.name="?xml",this.type=e.Document,t||(t={}),s={},t.writer?_(t.writer)&&(s=t.writer,t.writer=new b):t.writer=new b,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(s),this.stringify=new w(t),this.onDataCallback=n||function(){},this.onEndCallback=i||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}createChildNode(t){var n,i,s,r,a,o,l,d;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(i in s={},l=t.attribs)A.call(l,i)&&(n=l[i],s[i]=n.value);this.node(t.name,s);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(a=0,o=(d=t.children).length;a<o;a++)r=d[a],this.createChildNode(r),r.type===e.Element&&this.up();return this}dummy(){return this}node(t,e,n){if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=v(t),null==e&&(e={}),e=v(e),k(e)||([n,e]=[e,n]),this.currentNode=new m(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this}element(t,n,i){var s,r,a,o,l,d;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement(...arguments);else if(Array.isArray(t)||k(t)||y(t))for(o=this.options.noValidation,this.options.noValidation=!0,(d=new p(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=o,r=0,a=(l=d.children).length;r<a;r++)s=l[r],this.createChildNode(s),s.type===e.Element&&this.up();else this.node(t,n,i);return this}attribute(t,e){var n,i;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=v(t)),k(t))for(n in t)A.call(t,n)&&(i=t[n],this.attribute(n,i));else y(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new s(this,t,""):null!=e&&(this.currentNode.attribs[t]=new s(this,t,e));return this}text(t){var e;return this.openCurrent(),e=new x(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}cdata(t){var e;return this.openCurrent(),e=new r(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}comment(t){var e;return this.openCurrent(),e=new a(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}raw(t){var e;return this.openCurrent(),e=new g(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}instruction(t,e){var n,i,s,r,a;if(this.openCurrent(),null!=t&&(t=v(t)),null!=e&&(e=v(e)),Array.isArray(t))for(n=0,r=t.length;n<r;n++)i=t[n],this.instruction(i);else if(k(t))for(i in t)A.call(t,i)&&(s=t[i],this.instruction(i,s));else y(e)&&(e=e.apply()),a=new f(this,t,e),this.onData(this.writer.processingInstruction(a,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}declaration(t,e,n){var i;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return i=new h(this,t,e,n),this.onData(this.writer.declaration(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}doctype(t,e,n){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new u(this,e,n),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this}dtdElement(t,e){var n;return this.openCurrent(),n=new l(this,t,e),this.onData(this.writer.dtdElement(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}attList(t,e,n,i,s){var r;return this.openCurrent(),r=new o(this,t,e,n,i,s),this.onData(this.writer.dtdAttList(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}entity(t,e){var n;return this.openCurrent(),n=new d(this,!1,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}pEntity(t,e){var n;return this.openCurrent(),n=new d(this,!0,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}notation(t,e){var n;return this.openCurrent(),n=new c(this,t,e),this.onData(this.writer.dtdNotation(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}up(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this}end(){for(;this.currentLevel>=0;)this.up();return this.onEnd()}openCurrent(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)}openNode(t){var n,s,r,a;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),s="",t.type===e.Element){for(r in this.writerOptions.state=i.OpenTag,s=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,a=t.attribs)A.call(a,r)&&(n=a[r],s+=this.writer.attribute(n,this.writerOptions,this.currentLevel));s+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=i.InsideTag}else this.writerOptions.state=i.OpenTag,s=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?s+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(s+=' SYSTEM "'+t.sysID+'"'),t.children?(s+=" [",this.writerOptions.state=i.InsideTag):(this.writerOptions.state=i.CloseTag,s+=">"),s+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(s,this.currentLevel),t.isOpen=!0}}closeNode(t){var n;if(!t.isClosed)return"",this.writerOptions.state=i.CloseTag,n=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=i.None,this.onData(n,this.currentLevel),t.isClosed=!0}onData(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)}onEnd(){return this.documentCompleted=!0,this.onEndCallback()}debugInfo(t){return null==t?"":"node: <"+t+">"}ele(){return this.element(...arguments)}nod(t,e,n){return this.node(t,e,n)}txt(t){return this.text(t)}dat(t){return this.cdata(t)}com(t){return this.comment(t)}ins(t,e){return this.instruction(t,e)}dec(t,e,n){return this.declaration(t,e,n)}dtd(t,e,n){return this.doctype(t,e,n)}e(t,e,n){return this.element(t,e,n)}n(t,e,n){return this.node(t,e,n)}t(t){return this.text(t)}d(t){return this.cdata(t)}c(t){return this.comment(t)}r(t){return this.raw(t)}i(t,e){return this.instruction(t,e)}att(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList(...arguments):this.attribute(...arguments)}a(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList(...arguments):this.attribute(...arguments)}ent(t,e){return this.entity(t,e)}pent(t,e){return this.pEntity(t,e)}not(t,e){return this.notation(t,e)}}}).call(this)},799:function(t,e,n){(function(){var e,i;i=n(251),e=n(267),t.exports=class extends i{constructor(t){super(t),this.type=e.Dummy}clone(){return Object.create(this)}toString(t){return""}}}).call(this)},632:function(t,e,n){(function(){var e,i,s,r,a,o,l,d={}.hasOwnProperty;({isObject:l,isFunction:o,getValue:a}=n(31)),r=n(251),e=n(267),i=n(177),s=n(385),t.exports=function(){class t extends r{constructor(t,n,i){var s,r,a,o;if(super(t),null==n)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(n),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=i&&this.attribute(i),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(r=0,a=(o=t.children).length;r<a;r++)if((s=o[r]).type===e.DocType){s.name=this.name;break}}clone(){var t,e,n,i;for(e in(n=Object.create(this)).isRoot&&(n.documentObject=null),n.attribs={},i=this.attribs)d.call(i,e)&&(t=i[e],n.attribs[e]=t.clone());return n.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=n,n.children.push(e)})),n}attribute(t,e){var n,s;if(null!=t&&(t=a(t)),l(t))for(n in t)d.call(t,n)&&(s=t[n],this.attribute(n,s));else o(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new i(this,t,""):null!=e&&(this.attribs[t]=new i(this,t,e));return this}removeAttribute(t){var e,n,i;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=a(t),Array.isArray(t))for(n=0,i=t.length;n<i;n++)e=t[n],delete this.attribs[e];else delete this.attribs[t];return this}toString(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))}att(t,e){return this.attribute(t,e)}a(t,e){return this.attribute(t,e)}getAttribute(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null}setAttribute(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNode(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null}setAttributeNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNS(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNodeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNodeNS(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasAttribute(t){return this.attribs.hasOwnProperty(t)}hasAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttribute(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e}setIdAttributeNS(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttributeNode(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(t){var e,n,i;if(!super.isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=n=0,i=this.attribs.length-1;0<=i?n<=i:n>=i;e=0<=i?++n:--n)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0}}return Object.defineProperty(t.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new s(this.attribs)),this.attributeMap}}),t}.call(this)}).call(this)},385:function(t){(function(){t.exports=function(){class t{constructor(t){this.nodes=t}clone(){return this.nodes=null}getNamedItem(t){return this.nodes[t]}setNamedItem(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null}removeNamedItem(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null}item(t){return this.nodes[Object.keys(this.nodes)[t]]||null}getNamedItemNS(t,e){throw new Error("This DOM method is not implemented.")}setNamedItemNS(t){throw new Error("This DOM method is not implemented.")}removeNamedItemNS(t,e){throw new Error("This DOM method is not implemented.")}}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t}.call(this)}).call(this)},251:function(t,e,n){(function(){var e,i,s,r,a,o,l,d,c,h,u,p,m,f,g,b,w={}.hasOwnProperty,x=[].splice;({isObject:b,isFunction:g,isEmpty:f,getValue:m}=n(31)),d=null,s=null,r=null,a=null,o=null,u=null,p=null,h=null,l=null,i=null,c=null,e=null,t.exports=function(){class t{constructor(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,d||(d=n(632),s=n(954),r=n(190),a=n(918),o=n(3),u=n(830),p=n(690),h=n(879),l=n(799),i=n(267),c=n(787),n(385),e=n(555))}setParent(t){var e,n,i,s,r;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),r=[],n=0,i=(s=this.children).length;n<i;n++)e=s[n],r.push(e.setParent(this));return r}element(t,e,n){var i,s,r,a,o,l,d,c,h;if(l=null,null===e&&null==n&&([e,n]=[{},null]),null==e&&(e={}),e=m(e),b(e)||([n,e]=[e,n]),null!=t&&(t=m(t)),Array.isArray(t))for(r=0,d=t.length;r<d;r++)s=t[r],l=this.element(s);else if(g(t))l=this.element(t.apply());else if(b(t)){for(o in t)if(w.call(t,o))if(h=t[o],g(h)&&(h=h.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===o.indexOf(this.stringify.convertAttKey))l=this.attribute(o.substr(this.stringify.convertAttKey.length),h);else if(!this.options.separateArrayItems&&Array.isArray(h)&&f(h))l=this.dummy();else if(b(h)&&f(h))l=this.element(o);else if(this.options.keepNullNodes||null!=h)if(!this.options.separateArrayItems&&Array.isArray(h))for(a=0,c=h.length;a<c;a++)s=h[a],(i={})[o]=s,l=this.element(i);else b(h)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===o.indexOf(this.stringify.convertTextKey)?l=this.element(h):(l=this.element(o)).element(h):l=this.element(o,h);else l=this.dummy()}else l=this.options.keepNullNodes||null!==n?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),n):this.node(t,e,n):this.dummy();if(null==l)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return l}insertBefore(t,e,n){var i,s,r,a,o;if(null!=t?t.type:void 0)return a=e,(r=t).setParent(this),a?(s=children.indexOf(a),o=children.splice(s),children.push(r),Array.prototype.push.apply(children,o)):children.push(r),r;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return s=this.parent.children.indexOf(this),o=this.parent.children.splice(s),i=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,o),i}insertAfter(t,e,n){var i,s,r;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return s=this.parent.children.indexOf(this),r=this.parent.children.splice(s+1),i=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,r),i}remove(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),x.apply(this.parent.children,[t,t-t+1].concat([])),this.parent}node(t,e,n){var i;return null!=t&&(t=m(t)),e||(e={}),e=m(e),b(e)||([n,e]=[e,n]),i=new d(this,t,e),null!=n&&i.text(n),this.children.push(i),i}text(t){var e;return b(t)&&this.element(t),e=new p(this,t),this.children.push(e),this}cdata(t){var e;return e=new s(this,t),this.children.push(e),this}comment(t){var e;return e=new r(this,t),this.children.push(e),this}commentBefore(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this}commentAfter(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this}raw(t){var e;return e=new u(this,t),this.children.push(e),this}dummy(){return new l(this)}instruction(t,e){var n,i,s,r,a;if(null!=t&&(t=m(t)),null!=e&&(e=m(e)),Array.isArray(t))for(r=0,a=t.length;r<a;r++)n=t[r],this.instruction(n);else if(b(t))for(n in t)w.call(t,n)&&(i=t[n],this.instruction(n,i));else g(e)&&(e=e.apply()),s=new h(this,t,e),this.children.push(s);return this}instructionBefore(t,e){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,i),this}instructionAfter(t,e){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,i),this}declaration(t,e,n){var s,r;return s=this.document(),r=new a(s,t,e,n),0===s.children.length?s.children.unshift(r):s.children[0].type===i.Declaration?s.children[0]=r:s.children.unshift(r),s.root()||s}dtd(t,e){var n,s,r,a,l,d,c,h,u;for(n=this.document(),s=new o(n,t,e),r=a=0,d=(h=n.children).length;a<d;r=++a)if(h[r].type===i.DocType)return n.children[r]=s,s;for(r=l=0,c=(u=n.children).length;l<c;r=++l)if(u[r].isRoot)return n.children.splice(r,0,s),s;return n.children.push(s),s}up(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent}root(){var t;for(t=this;t;){if(t.type===i.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}}document(){var t;for(t=this;t;){if(t.type===i.Document)return t;t=t.parent}}end(t){return this.document().end(t)}prev(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]}next(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]}importDocument(t){var e,n,s,r,a;if((n=t.root().clone()).parent=this,n.isRoot=!1,this.children.push(n),this.type===i.Document&&(n.isRoot=!0,n.documentObject=this,this.rootObject=n,this.children))for(s=0,r=(a=this.children).length;s<r;s++)if((e=a[s]).type===i.DocType){e.name=n.name;break}return this}debugInfo(t){var e,n;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(n=this.parent)?n.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""}ele(t,e,n){return this.element(t,e,n)}nod(t,e,n){return this.node(t,e,n)}txt(t){return this.text(t)}dat(t){return this.cdata(t)}com(t){return this.comment(t)}ins(t,e){return this.instruction(t,e)}doc(){return this.document()}dec(t,e,n){return this.declaration(t,e,n)}e(t,e,n){return this.element(t,e,n)}n(t,e,n){return this.node(t,e,n)}t(t){return this.text(t)}d(t){return this.cdata(t)}c(t){return this.comment(t)}r(t){return this.raw(t)}i(t,e){return this.instruction(t,e)}u(){return this.up()}importXMLBuilder(t){return this.importDocument(t)}attribute(t,e){throw new Error("attribute() applies to element nodes only.")}att(t,e){return this.attribute(t,e)}a(t,e){return this.attribute(t,e)}removeAttribute(t){throw new Error("attribute() applies to element nodes only.")}replaceChild(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeChild(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendChild(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasChildNodes(){return 0!==this.children.length}cloneNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalize(){throw new Error("This DOM method is not implemented."+this.debugInfo())}isSupported(t,e){return!0}hasAttributes(){return 0!==this.attribs.length}compareDocumentPosition(t){var n,i;return(n=this)===t?0:this.document()!==t.document()?(i=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?i|=e.Preceding:i|=e.Following,i):n.isAncestor(t)?e.Contains|e.Preceding:n.isDescendant(t)?e.Contains|e.Following:n.isPreceding(t)?e.Preceding:e.Following}isSameNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupPrefix(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}isDefaultNamespace(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupNamespaceURI(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(t){var e,n,i;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=n=0,i=this.children.length-1;0<=i?n<=i:n>=i;e=0<=i?++n:--n)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0}getFeature(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setUserData(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}getUserData(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}contains(t){return!!t&&(t===this||this.isDescendant(t))}isDescendant(t){var e,n,i,s;for(n=0,i=(s=this.children).length;n<i;n++){if(t===(e=s[n]))return!0;if(e.isDescendant(t))return!0}return!1}isAncestor(t){return t.isDescendant(this)}isPreceding(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e<n}isFollowing(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e>n}treePosition(t){var e,n;return n=0,e=!1,this.foreachTreeNode(this.document(),(function(i){if(n++,!e&&i===t)return e=!0})),e?n:-1}foreachTreeNode(t,e){var n,i,s,r,a;for(t||(t=this.document()),i=0,s=(r=t.children).length;i<s;i++){if(a=e(n=r[i]))return a;if(a=this.foreachTreeNode(n,e))return a}}}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new c(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,n,s,r;if(this.nodeType===i.Element||this.nodeType===i.DocumentFragment){for(r="",e=0,n=(s=this.children).length;e<n;e++)(t=s[e]).textContent&&(r+=t.textContent);return r}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t}.call(this)}).call(this)},787:function(t){(function(){t.exports=function(){class t{constructor(t){this.nodes=t}clone(){return this.nodes=null}item(t){return this.nodes[t]||null}}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t}.call(this)}).call(this)},879:function(t,e,n){(function(){var e,i;e=n(267),i=n(372),t.exports=class extends i{constructor(t,n,i){if(super(t),null==n)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(n),this.name=this.target,i&&(this.value=this.stringify.insValue(i))}clone(){return Object.create(this)}toString(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))}isEqualNode(t){return!!super.isEqualNode(t)&&t.target===this.target}}}).call(this)},830:function(t,e,n){(function(){var e,i;e=n(267),i=n(251),t.exports=class extends i{constructor(t,n){if(super(t),null==n)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))}}}).call(this)},957:function(t,e,n){(function(){var e,i,s,r={}.hasOwnProperty;e=n(267),s=n(300),i=n(121),t.exports=class extends s{constructor(t,e){super(e),this.stream=t}endline(t,e,n){return t.isLastRootNode&&e.state===i.CloseTag?"":super.endline(t,e,n)}document(t,e){var n,i,s,r,a,o,l,d,c;for(i=s=0,a=(l=t.children).length;s<a;i=++s)(n=l[i]).isLastRootNode=i===t.children.length-1;for(e=this.filterOptions(e),c=[],r=0,o=(d=t.children).length;r<o;r++)n=d[r],c.push(this.writeChildNode(n,e,0));return c}cdata(t,e,n){return this.stream.write(super.cdata(t,e,n))}comment(t,e,n){return this.stream.write(super.comment(t,e,n))}declaration(t,e,n){return this.stream.write(super.declaration(t,e,n))}docType(t,e,n){var s,r,a,o;if(n||(n=0),this.openNode(t,e,n),e.state=i.OpenTag,this.stream.write(this.indent(t,e,n)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,n)),e.state=i.InsideTag,r=0,a=(o=t.children).length;r<a;r++)s=o[r],this.writeChildNode(s,e,n+1);e.state=i.CloseTag,this.stream.write("]")}return e.state=i.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,n)),e.state=i.None,this.closeNode(t,e,n)}element(t,n,s){var a,o,l,d,c,h,u,p,m,f,g,b,w,x;if(s||(s=0),this.openNode(t,n,s),n.state=i.OpenTag,m=this.indent(t,n,s)+"<"+t.name,n.pretty&&n.width>0)for(p in h=m.length,g=t.attribs)r.call(g,p)&&(a=g[p],h+(f=this.attribute(a,n,s)).length>n.width?(x=this.indent(t,n,s+1)+f,m+=this.endline(t,n,s)+x,h=x.length):(m+=x=" "+f,h+=x.length));else for(p in b=t.attribs)r.call(b,p)&&(a=b[p],m+=this.attribute(a,n,s));if(this.stream.write(m),d=0===(l=t.children.length)?null:t.children[0],0===l||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw||t.type===e.CData)&&""===t.value})))n.allowEmpty?(this.stream.write(">"),n.state=i.CloseTag,this.stream.write("</"+t.name+">")):(n.state=i.CloseTag,this.stream.write(n.spaceBeforeSlash+"/>"));else if(!n.pretty||1!==l||d.type!==e.Text&&d.type!==e.Raw&&d.type!==e.CData||null==d.value){for(this.stream.write(">"+this.endline(t,n,s)),n.state=i.InsideTag,c=0,u=(w=t.children).length;c<u;c++)o=w[c],this.writeChildNode(o,n,s+1);n.state=i.CloseTag,this.stream.write(this.indent(t,n,s)+"</"+t.name+">")}else this.stream.write(">"),n.state=i.InsideTag,n.suppressPrettyCount++,this.writeChildNode(d,n,s+1),n.suppressPrettyCount--,n.state=i.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,n,s)),n.state=i.None,this.closeNode(t,n,s)}processingInstruction(t,e,n){return this.stream.write(super.processingInstruction(t,e,n))}raw(t,e,n){return this.stream.write(super.raw(t,e,n))}text(t,e,n){return this.stream.write(super.text(t,e,n))}dtdAttList(t,e,n){return this.stream.write(super.dtdAttList(t,e,n))}dtdElement(t,e,n){return this.stream.write(super.dtdElement(t,e,n))}dtdEntity(t,e,n){return this.stream.write(super.dtdEntity(t,e,n))}dtdNotation(t,e,n){return this.stream.write(super.dtdNotation(t,e,n))}}}).call(this)},166:function(t,e,n){(function(){var e;e=n(300),t.exports=class extends e{constructor(t){super(t)}document(t,e){var n,i,s,r,a;for(e=this.filterOptions(e),r="",i=0,s=(a=t.children).length;i<s;i++)n=a[i],r+=this.writeChildNode(n,e,0);return e.pretty&&r.slice(-e.newline.length)===e.newline&&(r=r.slice(0,-e.newline.length)),r}}}).call(this)},630:function(t){(function(){var e={}.hasOwnProperty;t.exports=function(){class t{constructor(t){var n,i,s;for(n in this.assertLegalChar=this.assertLegalChar.bind(this),this.assertLegalName=this.assertLegalName.bind(this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),i=t.stringify||{})e.call(i,n)&&(s=i[n],this[n]=s)}name(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")}text(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))}cdata(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))}comment(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)}raw(t){return this.options.noValidation?t:""+t||""}attValue(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))}insTarget(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}insValue(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)}xmlVersion(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t}xmlEncoding(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)}xmlStandalone(t){return this.options.noValidation?t:t?"yes":"no"}dtdPubID(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdSysID(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdElementValue(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdAttType(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdAttDefault(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdEntityValue(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdNData(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}assertLegalChar(t){var e,n;if(this.options.noValidation)return t;if("1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g,void 0!==this.options.invalidCharReplacement)t=t.replace(e,this.options.invalidCharReplacement);else if(n=t.match(e))throw new Error(`Invalid character in string: ${t} at index ${n.index}`)}else if("1.1"===this.options.version)if(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g,void 0!==this.options.invalidCharReplacement)t=t.replace(e,this.options.invalidCharReplacement);else if(n=t.match(e))throw new Error(`Invalid character in string: ${t} at index ${n.index}`);return t}assertLegalName(t){var e;if(this.options.noValidation)return t;if(e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!(t=this.assertLegalChar(t)).match(e))throw new Error(`Invalid character in name: ${t}`);return t}textEscape(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))}attEscape(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))}}return t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t}.call(this)}).call(this)},690:function(t,e,n){(function(){var e,i;e=n(267),i=n(372),t.exports=function(){class t extends i{constructor(t,n){if(super(t),null==n)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))}splitText(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceWholeText(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(t.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"wholeText",{get:function(){var t,e,n;for(n="",e=this.previousSibling;e;)n=e.data+n,e=e.previousSibling;for(n+=this.data,t=this.nextSibling;t;)n+=t.data,t=t.nextSibling;return n}}),t}.call(this)}).call(this)},300:function(t,e,n){(function(){var e,i,s,r={}.hasOwnProperty;({assign:s}=n(31)),e=n(267),n(918),n(3),n(954),n(190),n(632),n(830),n(690),n(879),n(799),n(654),n(927),n(475),n(222),i=n(121),t.exports=class{constructor(t){var e,n,i;for(e in t||(t={}),this.options=t,n=t.writer||{})r.call(n,e)&&(i=n[e],this["_"+e]=this[e],this[e]=i)}filterOptions(t){var e,n,r,a,o,l,d,c,h;return t||(t={}),t=s({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(n=t.indent)?n:"  ",e.newline=null!=(r=t.newline)?r:"\n",e.offset=null!=(a=t.offset)?a:0,e.width=null!=(o=t.width)?o:0,e.dontPrettyTextNodes=null!=(l=null!=(d=t.dontPrettyTextNodes)?d:t.dontprettytextnodes)?l:0,e.spaceBeforeSlash=null!=(c=null!=(h=t.spaceBeforeSlash)?h:t.spacebeforeslash)?c:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=i.None,e}indent(t,e,n){var i;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(i=(n||0)+e.offset+1)>0?new Array(i).join(e.indent):""}endline(t,e,n){return!e.pretty||e.suppressPrettyCount?"":e.newline}attribute(t,e,n){var i;return this.openAttribute(t,e,n),i=e.pretty&&e.width>0?t.name+'="'+t.value+'"':" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,n),i}cdata(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n)+"<![CDATA[",e.state=i.InsideTag,s+=t.value,e.state=i.CloseTag,s+="]]>"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}comment(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n)+"\x3c!-- ",e.state=i.InsideTag,s+=t.value,e.state=i.CloseTag,s+=" --\x3e"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}declaration(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n)+"<?xml",e.state=i.InsideTag,s+=' version="'+t.version+'"',null!=t.encoding&&(s+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(s+=' standalone="'+t.standalone+'"'),e.state=i.CloseTag,s+=e.spaceBeforeSlash+"?>",s+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}docType(t,e,n){var s,r,a,o,l;if(n||(n=0),this.openNode(t,e,n),e.state=i.OpenTag,o=this.indent(t,e,n),o+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?o+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(o+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(o+=" [",o+=this.endline(t,e,n),e.state=i.InsideTag,r=0,a=(l=t.children).length;r<a;r++)s=l[r],o+=this.writeChildNode(s,e,n+1);e.state=i.CloseTag,o+="]"}return e.state=i.CloseTag,o+=e.spaceBeforeSlash+">",o+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),o}element(t,n,s){var a,o,l,d,c,h,u,p,m,f,g,b,w,x,v,y,k,_;if(s||(s=0),g=!1,this.openNode(t,n,s),n.state=i.OpenTag,b=this.indent(t,n,s)+"<"+t.name,n.pretty&&n.width>0)for(f in u=b.length,x=t.attribs)r.call(x,f)&&(a=x[f],u+(w=this.attribute(a,n,s)).length>n.width?(_=this.indent(t,n,s+1)+w,b+=this.endline(t,n,s)+_,u=_.length):(b+=_=" "+w,u+=_.length));else for(f in v=t.attribs)r.call(v,f)&&(a=v[f],b+=this.attribute(a,n,s));if(d=0===(l=t.children.length)?null:t.children[0],0===l||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw||t.type===e.CData)&&""===t.value})))n.allowEmpty?(b+=">",n.state=i.CloseTag,b+="</"+t.name+">"+this.endline(t,n,s)):(n.state=i.CloseTag,b+=n.spaceBeforeSlash+"/>"+this.endline(t,n,s));else if(!n.pretty||1!==l||d.type!==e.Text&&d.type!==e.Raw&&d.type!==e.CData||null==d.value){if(n.dontPrettyTextNodes)for(c=0,p=(y=t.children).length;c<p;c++)if(((o=y[c]).type===e.Text||o.type===e.Raw||o.type===e.CData)&&null!=o.value){n.suppressPrettyCount++,g=!0;break}for(b+=">"+this.endline(t,n,s),n.state=i.InsideTag,h=0,m=(k=t.children).length;h<m;h++)o=k[h],b+=this.writeChildNode(o,n,s+1);n.state=i.CloseTag,b+=this.indent(t,n,s)+"</"+t.name+">",g&&n.suppressPrettyCount--,b+=this.endline(t,n,s),n.state=i.None}else b+=">",n.state=i.InsideTag,n.suppressPrettyCount++,g=!0,b+=this.writeChildNode(d,n,s+1),n.suppressPrettyCount--,g=!1,n.state=i.CloseTag,b+="</"+t.name+">"+this.endline(t,n,s);return this.closeNode(t,n,s),b}writeChildNode(t,n,i){switch(t.type){case e.CData:return this.cdata(t,n,i);case e.Comment:return this.comment(t,n,i);case e.Element:return this.element(t,n,i);case e.Raw:return this.raw(t,n,i);case e.Text:return this.text(t,n,i);case e.ProcessingInstruction:return this.processingInstruction(t,n,i);case e.Dummy:return"";case e.Declaration:return this.declaration(t,n,i);case e.DocType:return this.docType(t,n,i);case e.AttributeDeclaration:return this.dtdAttList(t,n,i);case e.ElementDeclaration:return this.dtdElement(t,n,i);case e.EntityDeclaration:return this.dtdEntity(t,n,i);case e.NotationDeclaration:return this.dtdNotation(t,n,i);default:throw new Error("Unknown XML node type: "+t.constructor.name)}}processingInstruction(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n)+"<?",e.state=i.InsideTag,s+=t.target,t.value&&(s+=" "+t.value),e.state=i.CloseTag,s+=e.spaceBeforeSlash+"?>",s+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}raw(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n),e.state=i.InsideTag,s+=t.value,e.state=i.CloseTag,s+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}text(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n),e.state=i.InsideTag,s+=t.value,e.state=i.CloseTag,s+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}dtdAttList(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n)+"<!ATTLIST",e.state=i.InsideTag,s+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(s+=" "+t.defaultValueType),t.defaultValue&&(s+=' "'+t.defaultValue+'"'),e.state=i.CloseTag,s+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}dtdElement(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n)+"<!ELEMENT",e.state=i.InsideTag,s+=" "+t.name+" "+t.value,e.state=i.CloseTag,s+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}dtdEntity(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n)+"<!ENTITY",e.state=i.InsideTag,t.pe&&(s+=" %"),s+=" "+t.name,t.value?s+=' "'+t.value+'"':(t.pubID&&t.sysID?s+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(s+=' SYSTEM "'+t.sysID+'"'),t.nData&&(s+=" NDATA "+t.nData)),e.state=i.CloseTag,s+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}dtdNotation(t,e,n){var s;return this.openNode(t,e,n),e.state=i.OpenTag,s=this.indent(t,e,n)+"<!NOTATION",e.state=i.InsideTag,s+=" "+t.name,t.pubID&&t.sysID?s+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?s+=' PUBLIC "'+t.pubID+'"':t.sysID&&(s+=' SYSTEM "'+t.sysID+'"'),e.state=i.CloseTag,s+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),s}openNode(t,e,n){}closeNode(t,e,n){}openAttribute(t,e,n){}closeAttribute(t,e,n){}}}).call(this)},211:function(t,e,n){(function(){var e,i,s,r,a,o,l,d,c;({assign:d,isFunction:c}=n(31)),s=n(482),r=n(726),a=n(153),l=n(166),o=n(957),e=n(267),i=n(121),t.exports.create=function(t,e,n,i){var s,a;if(null==t)throw new Error("Root element needs a name.");return i=d({},e,n,i),a=(s=new r(i)).element(t),i.headless||(s.declaration(i),null==i.pubID&&null==i.sysID||s.dtd(i)),a},t.exports.begin=function(t,e,n){return c(t)&&([e,n]=[t,e],t={}),e?new a(t,e,n):new r(t)},t.exports.stringWriter=function(t){return new l(t)},t.exports.streamWriter=function(t,e){return new o(t,e)},t.exports.implementation=new s,t.exports.nodeType=e,t.exports.writerState=i}).call(this)}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t+"../"})();var i={};(()=>{"use strict";function t(){}function e(t){return t()}function s(){return Object.create(null)}function r(t){t.forEach(e)}function a(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t){return 0===Object.keys(t).length}function d(t,e,n,i){if(t){const s=c(t,e,n,i);return t[0](s)}}function c(t,e,n,i){return t[1]&&i?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](i(e))):n.ctx}function h(t,e,n,i){if(t[2]&&i){const s=t[2](i(n));if(void 0===e.dirty)return s;if("object"==typeof s){const t=[],n=Math.max(e.dirty.length,s.length);for(let i=0;i<n;i+=1)t[i]=e.dirty[i]|s[i];return t}return e.dirty|s}return e.dirty}function u(t,e,n,i,s,r){if(s){const a=c(e,n,i,r);t.p(a,s)}}function p(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}n.d(i,{eD:()=>qr,gT:()=>jr}),new Set;let m,f=!1;function g(t,e){t.appendChild(e)}function b(t,e,n){const i=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}(t);if(!i.getElementById(e)){const t=y("style");t.id=e,t.textContent=n,function(t,e){g(t.head||t,e)}(i,t)}}function w(t,e,n){t.insertBefore(e,n||null)}function x(t){t.parentNode.removeChild(t)}function v(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function y(t){return document.createElement(t)}function k(t){return document.createTextNode(t)}function _(){return k(" ")}function A(){return k("")}function C(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function S(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function I(t){return""===t?null:+t}function V(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function E(t,e){t.value=null==e?"":e}function $(t,e,n,i){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,i?"important":"")}function T(t,e,n){t.classList[n?"add":"remove"](e)}class L{constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){var i;this.e||(this.is_svg?this.e=(i=e.nodeName,document.createElementNS("http://www.w3.org/2000/svg",i)):this.e=y(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)w(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(x)}}function B(t){m=t}function D(){if(!m)throw new Error("Function called outside component initialization");return m}function M(t){D().$$.on_mount.push(t)}function N(){const t=D();return(e,n,{cancelable:i=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=function(t,e,{bubbles:n=!1,cancelable:i=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,i,e),s}(e,n,{cancelable:i});return s.slice().forEach((e=>{e.call(t,r)})),!r.defaultPrevented}return!0}}function O(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}new Map;const z=[],U=[],F=[],R=[],P=Promise.resolve();let j=!1;function q(){j||(j=!0,P.then(X))}function W(){return q(),P}function H(t){F.push(t)}function K(t){R.push(t)}const Z=new Set;let Q=0;function X(){const t=m;do{for(;Q<z.length;){const t=z[Q];Q++,B(t),G(t.$$)}for(B(null),z.length=0,Q=0;U.length;)U.pop()();for(let t=0;t<F.length;t+=1){const e=F[t];Z.has(e)||(Z.add(e),e())}F.length=0}while(z.length);for(;R.length;)R.pop()();j=!1,Z.clear(),B(t)}function G(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(H)}}const J=new Set;let Y,tt;function et(){Y={r:0,c:[],p:Y}}function nt(){Y.r||r(Y.c),Y=Y.p}function it(t,e){t&&t.i&&(J.delete(t),t.i(e))}function st(t,e,n,i){if(t&&t.o){if(J.has(t))return;J.add(t),Y.c.push((()=>{J.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}}function rt(t,e){const n=e.token={};function i(t,i,s,r){if(e.token!==n)return;e.resolved=r;let a=e.ctx;void 0!==s&&(a=a.slice(),a[s]=r);const o=t&&(e.current=t)(a);let l=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==i&&t&&(et(),st(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),nt())})):e.block.d(1),o.c(),it(o,1),o.m(e.mount(),e.anchor),l=!0),e.block=o,e.blocks&&(e.blocks[i]=o),l&&X()}if((s=t)&&"object"==typeof s&&"function"==typeof s.then){const n=D();if(t.then((t=>{B(n),i(e.then,1,e.value,t),B(null)}),(t=>{if(B(n),i(e.catch,2,e.error,t),B(null),!e.hasCatch)throw t})),e.current!==e.pending)return i(e.pending,0),!0}else{if(e.current!==e.then)return i(e.then,1,e.value,t),!0;e.resolved=t}var s}function at(t,e,n){const i=e.slice(),{resolved:s}=t;t.current===t.then&&(i[t.value]=s),t.current===t.catch&&(i[t.error]=s),t.block.p(i,n)}function ot(t,e,n){const i=t.$$.props[e];void 0!==i&&(t.$$.bound[i]=n,n(t.$$.ctx[i]))}function lt(t){t&&t.c()}function dt(t,n,i,s){const{fragment:o,on_mount:l,on_destroy:d,after_update:c}=t.$$;o&&o.m(n,i),s||H((()=>{const n=l.map(e).filter(a);d?d.push(...n):r(n),t.$$.on_mount=[]})),c.forEach(H)}function ct(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ht(e,n,i,a,o,l,d,c=[-1]){const h=m;B(e);const u=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:o,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(h?h.$$.context:[])),callbacks:s(),dirty:c,skip_bound:!1,root:n.target||h.$$.root};d&&d(u.root);let p=!1;if(u.ctx=i?i(e,n.props||{},((t,n,...i)=>{const s=i.length?i[0]:n;return u.ctx&&o(u.ctx[t],u.ctx[t]=s)&&(!u.skip_bound&&u.bound[t]&&u.bound[t](s),p&&function(t,e){-1===t.$$.dirty[0]&&(z.push(t),q(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],u.update(),p=!0,r(u.before_update),u.fragment=!!a&&a(u.ctx),n.target){if(n.hydrate){f=!0;const t=(g=n.target,Array.from(g.childNodes));u.fragment&&u.fragment.l(t),t.forEach(x)}else u.fragment&&u.fragment.c();n.intro&&it(e.$$.fragment),dt(e,n.target,n.anchor,n.customElement),f=!1,X()}var g;B(h)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(tt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(a);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){r(this.$$.on_disconnect)}$destroy(){ct(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!l(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class ut{$destroy(){ct(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!l(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}class pt{constructor(t,e){e.addEventListener("settingsupdated",this.settingsUpdated.bind(this)),this.core=e,this.baseWidth=1280,this.baseHeight=720,this.trippyRadius=0,this.shutterWidth=1,this.setBlurQuality("high"),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=this.baseWidth,this.canvas.height=this.baseHeight,this.canvas.className="hues-canvas",t.appendChild(this.canvas),this.offCanvas=document.createElement("canvas"),this.offContext=this.offCanvas.getContext("2d"),this.offCanvas2=document.createElement("canvas"),this.offContext2=this.offCanvas2.getContext("2d"),window.addEventListener("resize",this.resize.bind(this)),this.resize()}settingsUpdated(){this.setBlurQuality(this.core.settings.blurQuality)}setBlurQuality(t){this.blurIterations={low:-1,medium:11,high:19,extreme:35}[t],this.blurDelta=1/(this.blurIterations/2),this.blurAlpha=1/(this.blurIterations/2)}resize(){let t=this.core.root.clientHeight,e=this.core.root.clientWidth/t;this.canvas.height=Math.min(t,this.baseHeight),this.canvas.width=Math.ceil(this.canvas.height*e),this.offCanvas.height=this.canvas.height,this.offCanvas.width=this.canvas.width,this.offCanvas2.height=this.canvas.height,this.offCanvas2.width=this.canvas.width,this.trippyRadius=Math.max(this.canvas.width,this.canvas.height)/2*Math.SQRT2}draw(t){let e=this.canvas.width,n=this.canvas.height;if(this.context.globalAlpha=1,this.context.globalCompositeOperation="source-over",t.overlayPercent>=1)return this.context.fillStyle=this.intToHex(t.overlayColour),this.context.fillRect(0,0,e,n),void(t.invert&&this.drawInvert());if(this.context.save(),this.context.fillStyle="#FFF",this.context.fillRect(0,0,e,n),void 0!==t.shutter){let i,s,r;switch(t.shutterDir){case"→":s=!1,i=!1;break;case"←":s=!0,i=!1;break;case"↑":s=!0,i=!0;break;case"↓":s=!1,i=!0}r=i?n+this.shutterWidth:e+this.shutterWidth;let a=Math.floor(r*t.shutter);s&&(a=r-a);let o=new Path2D,l=new Path2D;if(i?(o.rect(0,a,e,r-a),l.rect(0,0,e,a-this.shutterWidth)):(o.rect(a,0,r-a,n),l.rect(0,0,a-this.shutterWidth,n)),s){let t=o;o=l,l=t}this.context.fillStyle="#000",i?this.context.fillRect(0,a-this.shutterWidth,e,this.shutterWidth):this.context.fillRect(a-this.shutterWidth,0,this.shutterWidth,n),this.context.save(),this.context.clip(o),this.drawBitmap(t.lastBitmap,t.lastBitmapAlign,e,n,t.slices,t.xBlur,t.yBlur),this.drawColour(t.lastColour,t.blendMode,t.outTrippy,t.inTrippy,e,n),this.context.restore(),this.context.clip(l)}this.drawBitmap(t.bitmap,t.bitmapAlign,e,n,t.slices,t.xBlur,t.yBlur),this.drawColour(t.colour,t.blendMode,t.outTrippy,t.inTrippy,e,n),this.context.restore(),t.overlayPercent>0&&(this.context.globalAlpha=t.overlayPercent,this.context.fillStyle=this.intToHex(t.overlayColour),this.context.fillRect(0,0,e,n)),t.invert&&this.drawInvert()}drawBitmap(t,e,n,i,s,r,a){let o;if(t){let l=t.height*(i/t.height),d=t.width/t.height*l;switch(e){case"left":o=0;break;case"right":o=n-d;break;default:o=n/2-d/2}s&&(t=this.drawSlice(s,t,o,d,l,n,i),d=n,l=i,o=0),r||a?this.drawBlur(t,o,d,l,r,a):(this.context.globalAlpha=1,this.context.drawImage(t,o,0,d,l))}}drawColour(t,e,n,i,s,r){void 0!==n||void 0!==i?this.drawTrippy(n,i,t,s,r):(this.offContext.fillStyle=this.intToHex(t),this.offContext.fillRect(0,0,s,r)),this.context.globalAlpha=.7,this.context.globalCompositeOperation=e,this.context.drawImage(this.offCanvas,0,0)}drawInvert(){this.context.globalAlpha=1,this.context.globalCompositeOperation="difference",this.context.fillStyle="#FFF",this.context.fillRect(0,0,this.canvas.width,this.canvas.height)}drawSlice(t,e,n,i,s,r,a){if(this.offContext.clearRect(0,0,r,a),!e)return this.offCanvas;const o=t;let l=0,d=n;for(let t=0;t<o.x.count;t++){let n=o.x.segments[t],r=o.x.distances[t]*o.x.percent*this.canvas.width,a=Math.ceil(n*e.width),c=Math.ceil(n*i),h=0,u=0;for(let t=0;t<o.y.count;t++){let n=o.y.segments[t],i=o.y.distances[t]*o.y.percent*this.canvas.width,p=Math.ceil(n*e.height),m=Math.ceil(n*s);this.offContext.drawImage(e,l,h,a,p,d+i,u+r,c,m),h+=p,u+=m}l+=a,d+=c}return this.offCanvas}drawBlur(t,e,n,i,s,r){let a=t;if(this.blurIterations<0){let t=720*s,o=720*r;this.context.globalAlpha=1,this.context.drawImage(a,Math.floor(e-t/2),Math.floor(-o/2),n+t,i+o)}else{let t;if(this.context.globalAlpha=this.blurAlpha,s){let o=this.context;r&&(this.offContext2.globalAlpha=this.blurAlpha,this.offContext2.clearRect(0,0,this.canvas.width,this.canvas.height),o=this.offContext2),t=720*s;for(let s=-1;s<=1;s+=this.blurDelta)o.drawImage(a,Math.floor(t*s)+e,0,n,i);r&&(e=0,a=this.offCanvas2,n=this.canvas.width,i=this.canvas.height)}if(r){t=720*r;for(let s=-1;s<=1;s+=this.blurDelta)this.context.drawImage(a,e,Math.floor(t*s),n,i)}}}drawTrippy(t,e,n,i,s){let r;r=(t=void 0===t?1:t)>(e=void 0===e?0:e)?[t,e]:[e,t];let a=this.intToHex(16777215^n),o=this.intToHex(n);this.offContext.fillStyle=a,this.offContext.fillRect(0,0,i,s);let l=!1;for(let t=0;t<2;t++)this.offContext.beginPath(),this.offContext.fillStyle=l?a:o,this.offContext.arc(i/2,s/2,Math.floor(r[t]*this.trippyRadius),0,2*Math.PI,!1),this.offContext.fill(),this.offContext.closePath(),l=!l}intToHex(t){return"#"+("00000"+t.toString(16)).slice(-6)}}class mt{constructor(t,e){this.core=e,this.audio=t,e.addEventListener("beat",this.beat.bind(this)),e.addEventListener("songstarted",this.resetAnimation.bind(this)),this.animFrame=0,this.animTimeout=0,this.lastBeat=0}resetAnimation(){this.animTimeout=this.audio.currentTime}beat(){this.lastBeat=this.audio.currentTime}sameAs(t){return this.image==t}setImage(t){if(this.image=t,t&&t.bitmaps.length&&(this.animFrame=0,t.animated)){let e=this.audio.currentTime;this.animTimeout=e+t.frameDurations[0]/1e3,t.beatsPerAnim&&this.core.currentSong&&this.core.currentSong.charsPerBeat&&this.syncAnim(e)}}getBitmap(){return this.image&&this.image.bitmaps.length?this.image.bitmaps[this.animFrame]:void 0}getBitmapAlign(){return this.image?this.image.align:void 0}onRedraw(){let t=this.audio.currentTime,e=!1;if(this.image&&this.image.animated)if(this.image.beatsPerAnim&&this.core.currentSong&&this.core.currentSong.charsPerBeat){let n=this.animFrame;this.syncAnim(t),this.animFrame!=n&&(e=!0,this.animTimeout=t)}else for(;this.animTimeout<t;)this.animFrame++,this.animFrame%=this.image.frameDurations.length,this.animTimeout+=this.image.frameDurations[this.animFrame]/1e3,e=!0;return e}syncAnim(t){const e=this.core.currentSong;if(!e||!this.image)return;let n=this.core.beatIndex;if(this.lastBeat&&this.core.getBeatLength()){let e=(t-this.lastBeat)/this.core.getBeatLength();n+=Math.min(e,1)}let i=n/e.charsPerBeat%this.image.beatsPerAnim,s=this.image.bitmaps.length;this.animFrame=Math.floor(s*(i/this.image.beatsPerAnim)),this.image.syncOffset&&(this.animFrame+=this.image.syncOffset),this.animFrame=(this.animFrame%s+s)%s}}class ft{constructor(t,e,n){this.render=new pt(t,n),this.audio=e,e.addEventListener("seek",this.resetEffects.bind(this)),n.addEventListener("newsong",this.resetEffects.bind(this)),n.addEventListener("newimage",this.setImage.bind(this)),n.addEventListener("newcolour",this.setColour.bind(this)),n.addEventListener("invert",this.setInvert.bind(this)),n.addEventListener("settingsupdated",this.settingsUpdated.bind(this)),n.addEventListener("frame",this.animationLoop.bind(this)),this.core=n,this.needsRedraw=!1,this.colour=16777215,this.lastColour=16777215,this.image=new mt(e,n),this.lastImage=new mt(e,n),this.smartAlign=!0,this.blurStart=[void 0,void 0],this.blurDistance=[0,0],this.slices={x:this.makeSliceObj(25),y:this.makeSliceObj(15)},this.shutterDuration=0,this.sliceInfo={x:{},y:{}},this.trippyStart=[void 0,void 0],this.trippyRadii=[void 0,void 0],this.trippyOn=!1,this.blackoutColour=0,this.bOpacity=0,this.lastBlackout=0,this.currentBlackout=-1,this.lastFrameBlack=!1,this.invert=!1,this.blendMode="hard-light",this.setBlurAmount("medium"),this.setBlurDecay("fast"),window.addEventListener("resize",this.resize.bind(this)),this.resize()}makeSliceObj(t){return{count:0,percent:0,avgSegments:t,segments:[],distances:[]}}setInvert(t){this.invert=t,this.needsRedraw=!0}settingsUpdated(){this.setSmartAlign(this.core.settings.smartAlign),this.setBlurAmount(this.core.settings.blurAmount),this.setBlurDecay(this.core.settings.blurDecay),this.trippyOn="on"==this.core.settings.trippyMode}resetEffects(){this.colourFadeStart=void 0,this.trippyStart=[void 0,void 0],this.sliceInfo.x.start=void 0,this.sliceInfo.y.start=void 0,this.resetSliceSegments("x"),this.resetSliceSegments("y"),this.blurStart=[void 0,void 0]}resize(){this.needsRedraw=!0}redraw(){let t=this.core.settings.fullAuto?this.lastImage:this.image,e={colour:this.colour,lastColour:this.lastColour,blendMode:this.blendMode,overlayColour:this.blackoutColour,overlayPercent:this.bOpacity,invert:this.invert,bitmap:this.image.getBitmap(),bitmapAlign:this.smartAlign?this.image.getBitmapAlign():void 0,lastBitmap:t.getBitmap(),lastBitmapAlign:t.getBitmapAlign(),shutter:this.shutterProgress,shutterDir:this.shutterDir,xBlur:this.blurDistance[0],yBlur:this.blurDistance[1],outTrippy:this.trippyRadii[1],inTrippy:this.trippyRadii[0],slices:void 0!==this.sliceInfo.x.start||void 0!==this.sliceInfo.y.start?this.slices:void 0};this.render.draw(e)}animationLoop(){if(void 0!==this.colourFadeStart){let t=(this.audio.currentTime-this.colourFadeStart)/this.colourFadeLength;t>=1?(this.stopFade(),this.colour=this.newColour):this.mixColours(t),this.needsRedraw=!0}void 0!==this.blackoutTimeout&&this.audio.currentTime>this.blackoutTimeout&&this.clearBlackout(),void 0!==this.blackoutStart?(this.bOpacity=10*(this.audio.currentTime-this.blackoutStart),this.bOpacity>=1&&(this.lastBlackout==this.currentBlackout||!this.lastFrameBlack)?(this.lastFrameBlack=!0,this.lastBlackout=this.currentBlackout):this.lastFrameBlack=!1):this.bOpacity=0,this.image.onRedraw()&&(this.needsRedraw=!0);for(const[t,e]of this.blurStart.entries())if(void 0!==e){let n=this.audio.currentTime-e+1/30;this.blurDistance[t]=this.blurAmount*Math.exp(-this.blurDecay*n),this.updateCoreBlur()}else this.blurDistance[t]=0;for(const[t,e]of Object.entries(this.sliceInfo)){const n=t;if(void 0===e.start)continue;let i,s,r=.8,a=this.audio.currentTime;if(a<e.rampUp)i=e.rampUp-a,s=(1-i/e.transitionTime)*r;else if(a<e.rampDown)i=e.rampDown-a,s=r+(1-i/(e.rampDown-e.rampUp))*(1-r);else{let t=e.rampDown+e.transitionTime;a>t?(e.start=void 0,this.resetSliceSegments(n),s=0):(i=t-a,s=i/e.transitionTime)}this.slices[n].percent=s,this.needsRedraw=!0}if(void 0!==this.shutterEnd)if(this.audio.currentTime<this.shutterEnd){let t=this.shutterEnd-this.audio.currentTime;this.shutterProgress=(this.shutterDuration-t)/this.shutterDuration}else this.shutterEnd=void 0,this.shutterProgress=void 0;for(let t=0;t<2;t++)if(void 0!==this.trippyStart[t]){if(this.needsRedraw=!0,this.trippyRadii[t]=2*(this.audio.currentTime-this.trippyStart[t]),this.trippyRadii[t]>1){this.trippyStart[t]=void 0,this.trippyRadii[t]=void 0;continue}t%2==0&&(this.trippyRadii[t]=1-this.trippyRadii[t])}else this.trippyRadii[t]=void 0;for(const[t,e]of this.blurStart.entries())void 0!==e&&this.blurDistance[t]<1e-4?(this.blurDistance[t]=0,this.blurStart[t]=void 0,this.updateCoreBlur(),this.needsRedraw=!0):void 0!==e&&(this.needsRedraw=!0);this.needsRedraw&&this.redraw()}setImage(t){this.needsRedraw=!0;let e=this.lastImage;this.lastImage=this.image,this.image=e,this.image.setImage(t)}setColour(t,e){t.c!=this.colour&&(this.lastColour=this.colour,e?this.newColour=t.c:(this.stopFade(),this.colour=t.c),this.needsRedraw=!0)}doBlackout(t=!1){var e;this.blackoutColour=t?16777215:0,this.blackoutTimeout=void 0,null==this.blackoutStart&&(this.blackoutStart=this.audio.currentTime),this.needsRedraw=!0,"on"==this.core.settings.blackoutUI&&(null===(e=this.core.userInterface)||void 0===e||e.hide())}clearBlackout(){var t;this.blackoutStart=void 0,this.blackoutTimeout=void 0,this.needsRedraw=!0,"on"==this.core.settings.blackoutUI&&(null===(t=this.core.userInterface)||void 0===t||t.show())}doShortBlackout(t,e=!1){this.doInstantBlackout(e),this.blackoutTimeout=this.audio.currentTime+t/1.7,this.currentBlackout++}doInstantBlackout(t=!1){this.doBlackout(t),this.blackoutStart=-Math.pow(2,32)}doColourFade(t){this.colourFadeLength=t,this.colourFadeStart=this.audio.currentTime,this.oldColour=this.colour}stopFade(){this.colourFadeStart=void 0}mixColours(t){t=Math.min(1,t);let e=this.oldColour>>16&255,n=this.oldColour>>8&255,i=255&this.oldColour,s=e*(1-t)+(this.newColour>>16&255)*t,r=n*(1-t)+(this.newColour>>8&255)*t,a=i*(1-t)+(255&this.newColour)*t;this.colour=s<<16|r<<8|a}updateCoreBlur(){let t=this.blurDistance[0]/this.blurAmount,e=this.blurDistance[1]/this.blurAmount;this.core.blurUpdated(t,e)}doBlur(t){this.blurStart[t]=this.audio.currentTime,this.trippyOn&&(this.trippyStart[t]=this.blurStart[t]),this.needsRedraw=!0}doXBlur(){this.doBlur(0)}doYBlur(){this.doBlur(1)}doTrippy(t){let e=this.trippyOn;this.trippyOn=!0,this.doBlur(t),this.trippyOn=e}doTrippyX(){this.doTrippy(0)}doTrippyY(){this.doTrippy(1)}doShutter(t,e,n){let i=e*n*.8;this.shutterDuration=Math.min(.2,i),this.shutterEnd=this.audio.currentTime+this.shutterDuration,this.shutterDir=t,this.needsRedraw=!0}doSlice(t,e,n){let i=Math.min(.06,t),s=this.sliceInfo[n];s.start=this.audio.currentTime,s.rampUp=s.start+i,s.rampDown=s.start+t*e-i,s.transitionTime=i,this.generateSliceSegments(n),this.needsRedraw=!0}generateSliceSegments(t){let e,n=1/this.slices[t].avgSegments,i=n/2,s=0;for(e=0;;e++){let r=n+Math.random()*i*2-i;if(this.slices[t].segments[e]=r,s+=r,this.slices[t].distances[e]=Math.random()*this.blurAmount-this.blurAmount/2,s>1){this.slices[t].segments[e]-=s-1;break}}this.slices[t].count=e+1}resetSliceSegments(t){this.slices[t].count=1,this.slices[t].segments[0]=1,this.slices[t].distances[0]=0}setBlurDecay(t){this.blurDecay={slow:7.8,medium:14.1,fast:20.8,"faster!":28.7}[t]}setBlurAmount(t){this.blurAmount={low:.0375,medium:.075,high:.3}[t]}setSmartAlign(t){this.smartAlign="on"==t}}var gt=n(211),bt=n.n(gt);const wt=-2;function xt(t){return vt(t.map((([t,e])=>new Array(t).fill(e,0,t))))}function vt(t){return t.reduce(((t,e)=>t.concat(Array.isArray(e)?vt(e):e)),[])}const yt=[0,1,2,3].concat(...xt([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function kt(){const t=this;function e(t,e){let n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}t.build_tree=function(n){const i=t.dyn_tree,s=t.stat_desc.static_tree,r=t.stat_desc.elems;let a,o,l,d=-1;for(n.heap_len=0,n.heap_max=573,a=0;a<r;a++)0!==i[2*a]?(n.heap[++n.heap_len]=d=a,n.depth[a]=0):i[2*a+1]=0;for(;n.heap_len<2;)l=n.heap[++n.heap_len]=d<2?++d:0,i[2*l]=1,n.depth[l]=0,n.opt_len--,s&&(n.static_len-=s[2*l+1]);for(t.max_code=d,a=Math.floor(n.heap_len/2);a>=1;a--)n.pqdownheap(i,a);l=r;do{a=n.heap[1],n.heap[1]=n.heap[n.heap_len--],n.pqdownheap(i,1),o=n.heap[1],n.heap[--n.heap_max]=a,n.heap[--n.heap_max]=o,i[2*l]=i[2*a]+i[2*o],n.depth[l]=Math.max(n.depth[a],n.depth[o])+1,i[2*a+1]=i[2*o+1]=l,n.heap[1]=l++,n.pqdownheap(i,1)}while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],function(e){const n=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.extra_bits,r=t.stat_desc.extra_base,a=t.stat_desc.max_length;let o,l,d,c,h,u,p=0;for(c=0;c<=15;c++)e.bl_count[c]=0;for(n[2*e.heap[e.heap_max]+1]=0,o=e.heap_max+1;o<573;o++)l=e.heap[o],c=n[2*n[2*l+1]+1]+1,c>a&&(c=a,p++),n[2*l+1]=c,l>t.max_code||(e.bl_count[c]++,h=0,l>=r&&(h=s[l-r]),u=n[2*l],e.opt_len+=u*(c+h),i&&(e.static_len+=u*(i[2*l+1]+h)));if(0!==p){do{for(c=a-1;0===e.bl_count[c];)c--;e.bl_count[c]--,e.bl_count[c+1]+=2,e.bl_count[a]--,p-=2}while(p>0);for(c=a;0!==c;c--)for(l=e.bl_count[c];0!==l;)d=e.heap[--o],d>t.max_code||(n[2*d+1]!=c&&(e.opt_len+=(c-n[2*d+1])*n[2*d],n[2*d+1]=c),l--)}}(n),function(t,n,i){const s=[];let r,a,o,l=0;for(r=1;r<=15;r++)s[r]=l=l+i[r-1]<<1;for(a=0;a<=n;a++)o=t[2*a+1],0!==o&&(t[2*a]=e(s[o]++,o))}(i,t.max_code,n.bl_count)}}function _t(t,e,n,i,s){const r=this;r.static_tree=t,r.extra_bits=e,r.extra_base=n,r.elems=i,r.max_length=s}function At(t,e,n,i,s){const r=this;r.good_length=t,r.max_lazy=e,r.nice_length=n,r.max_chain=i,r.func=s}kt._length_code=[0,1,2,3,4,5,6,7].concat(...xt([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),kt.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],kt.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],kt.d_code=function(t){return t<256?yt[t]:yt[256+(t>>>7)]},kt.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],kt.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],kt.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],kt.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],_t.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,8,99,8,227,8],_t.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5],_t.static_l_desc=new _t(_t.static_ltree,kt.extra_lbits,257,286,15),_t.static_d_desc=new _t(_t.static_dtree,kt.extra_dbits,0,30,15),_t.static_bl_desc=new _t(null,kt.extra_blbits,0,19,7);const Ct=[new At(0,0,0,0,0),new At(4,4,8,4,1),new At(4,5,16,8,1),new At(4,6,32,32,1),new At(4,4,16,16,2),new At(8,16,32,32,2),new At(8,16,128,128,2),new At(8,32,128,256,2),new At(32,128,258,1024,2),new At(32,258,258,4096,2)],St=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],It=113,Vt=666,Et=262;function $t(t,e,n,i){const s=t[2*e],r=t[2*n];return s<r||s==r&&i[e]<=i[n]}function Tt(){const t=this;let e,n,i,s,r,a,o,l,d,c,h,u,p,m,f,g,b,w,x,v,y,k,_,A,C,S,I,V,E,$,T,L,B;const D=new kt,M=new kt,N=new kt;let O,z,U,F,R,P,j,q;function W(){let e;for(e=0;e<286;e++)T[2*e]=0;for(e=0;e<30;e++)L[2*e]=0;for(e=0;e<19;e++)B[2*e]=0;T[512]=1,t.opt_len=t.static_len=0,U=R=0}function H(t,e){let n,i=-1,s=t[1],r=0,a=7,o=4;0===s&&(a=138,o=3),t[2*(e+1)+1]=65535;for(let l=0;l<=e;l++)n=s,s=t[2*(l+1)+1],++r<a&&n==s||(r<o?B[2*n]+=r:0!==n?(n!=i&&B[2*n]++,B[32]++):r<=10?B[34]++:B[36]++,r=0,i=n,0===s?(a=138,o=3):n==s?(a=6,o=3):(a=7,o=4))}function K(e){t.pending_buf[t.pending++]=e}function Z(t){K(255&t),K(t>>>8&255)}function Q(t,e){let n;const i=e;q>16-i?(n=t,j|=n<<q&65535,Z(j),j=n>>>16-q,q+=i-16):(j|=t<<q&65535,q+=i)}function X(t,e){const n=2*t;Q(65535&e[n],65535&e[n+1])}function G(t,e){let n,i,s=-1,r=t[1],a=0,o=7,l=4;for(0===r&&(o=138,l=3),n=0;n<=e;n++)if(i=r,r=t[2*(n+1)+1],!(++a<o&&i==r)){if(a<l)do{X(i,B)}while(0!=--a);else 0!==i?(i!=s&&(X(i,B),a--),X(16,B),Q(a-3,2)):a<=10?(X(17,B),Q(a-3,3)):(X(18,B),Q(a-11,7));a=0,s=i,0===r?(o=138,l=3):i==r?(o=6,l=3):(o=7,l=4)}}function J(){16==q?(Z(j),j=0,q=0):q>=8&&(K(255&j),j>>>=8,q-=8)}function Y(e,n){let i,s,r;if(t.pending_buf[F+2*U]=e>>>8&255,t.pending_buf[F+2*U+1]=255&e,t.pending_buf[O+U]=255&n,U++,0===e?T[2*n]++:(R++,e--,T[2*(kt._length_code[n]+256+1)]++,L[2*kt.d_code(e)]++),0==(8191&U)&&I>2){for(i=8*U,s=y-b,r=0;r<30;r++)i+=L[2*r]*(5+kt.extra_dbits[r]);if(i>>>=3,R<Math.floor(U/2)&&i<Math.floor(s/2))return!0}return U==z-1}function tt(e,n){let i,s,r,a,o=0;if(0!==U)do{i=t.pending_buf[F+2*o]<<8&65280|255&t.pending_buf[F+2*o+1],s=255&t.pending_buf[O+o],o++,0===i?X(s,e):(r=kt._length_code[s],X(r+256+1,e),a=kt.extra_lbits[r],0!==a&&(s-=kt.base_length[r],Q(s,a)),i--,r=kt.d_code(i),X(r,n),a=kt.extra_dbits[r],0!==a&&(i-=kt.base_dist[r],Q(i,a)))}while(o<U);X(256,e),P=e[513]}function et(){q>8?Z(j):q>0&&K(255&j),j=0,q=0}function nt(e,n,i){Q(0+(i?1:0),3),function(e,n,i){et(),P=8,Z(n),Z(~n),t.pending_buf.set(l.subarray(e,e+n),t.pending),t.pending+=n}(e,n)}function it(n){(function(e,n,i){let s,r,a=0;I>0?(D.build_tree(t),M.build_tree(t),a=function(){let e;for(H(T,D.max_code),H(L,M.max_code),N.build_tree(t),e=18;e>=3&&0===B[2*kt.bl_order[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(),s=t.opt_len+3+7>>>3,r=t.static_len+3+7>>>3,r<=s&&(s=r)):s=r=n+5,n+4<=s&&-1!=e?nt(e,n,i):r==s?(Q(2+(i?1:0),3),tt(_t.static_ltree,_t.static_dtree)):(Q(4+(i?1:0),3),function(t,e,n){let i;for(Q(t-257,5),Q(e-1,5),Q(n-4,4),i=0;i<n;i++)Q(B[2*kt.bl_order[i]+1],3);G(T,t-1),G(L,e-1)}(D.max_code+1,M.max_code+1,a+1),tt(T,L)),W(),i&&et()})(b>=0?b:-1,y-b,n),b=y,e.flush_pending()}function st(){let t,n,i,s;do{if(s=d-_-y,0===s&&0===y&&0===_)s=r;else if(-1==s)s--;else if(y>=r+r-Et){l.set(l.subarray(r,r+r),0),k-=r,y-=r,b-=r,t=p,i=t;do{n=65535&h[--i],h[i]=n>=r?n-r:0}while(0!=--t);t=r,i=t;do{n=65535&c[--i],c[i]=n>=r?n-r:0}while(0!=--t);s+=r}if(0===e.avail_in)return;t=e.read_buf(l,y+_,s),_+=t,_>=3&&(u=255&l[y],u=(u<<g^255&l[y+1])&f)}while(_<Et&&0!==e.avail_in)}function rt(t){let e,n,i=C,s=y,a=A;const d=y>r-Et?y-(r-Et):0;let h=$;const u=o,p=y+258;let m=l[s+a-1],f=l[s+a];A>=E&&(i>>=2),h>_&&(h=_);do{if(e=t,l[e+a]==f&&l[e+a-1]==m&&l[e]==l[s]&&l[++e]==l[s+1]){s+=2,e++;do{}while(l[++s]==l[++e]&&l[++s]==l[++e]&&l[++s]==l[++e]&&l[++s]==l[++e]&&l[++s]==l[++e]&&l[++s]==l[++e]&&l[++s]==l[++e]&&l[++s]==l[++e]&&s<p);if(n=258-(p-s),s=p-258,n>a){if(k=t,a=n,n>=h)break;m=l[s+a-1],f=l[s+a]}}}while((t=65535&c[t&u])>d&&0!=--i);return a<=_?a:_}t.depth=[],t.bl_count=[],t.heap=[],T=[],L=[],B=[],t.pqdownheap=function(e,n){const i=t.heap,s=i[n];let r=n<<1;for(;r<=t.heap_len&&(r<t.heap_len&&$t(e,i[r+1],i[r],t.depth)&&r++,!$t(e,s,i[r],t.depth));)i[n]=i[r],n=r,r<<=1;i[n]=s},t.deflateInit=function(e,x,k,U,R,H){return U||(U=8),R||(R=8),H||(H=0),e.msg=null,-1==x&&(x=6),R<1||R>9||8!=U||k<9||k>15||x<0||x>9||H<0||H>2?wt:(e.dstate=t,a=k,r=1<<a,o=r-1,m=R+7,p=1<<m,f=p-1,g=Math.floor((m+3-1)/3),l=new Uint8Array(2*r),c=[],h=[],z=1<<R+6,t.pending_buf=new Uint8Array(4*z),i=4*z,F=Math.floor(z/2),O=3*z,I=x,V=H,function(e){return e.total_in=e.total_out=0,e.msg=null,t.pending=0,t.pending_out=0,n=It,s=0,D.dyn_tree=T,D.stat_desc=_t.static_l_desc,M.dyn_tree=L,M.stat_desc=_t.static_d_desc,N.dyn_tree=B,N.stat_desc=_t.static_bl_desc,j=0,q=0,P=8,W(),function(){d=2*r,h[p-1]=0;for(let t=0;t<p-1;t++)h[t]=0;S=Ct[I].max_lazy,E=Ct[I].good_length,$=Ct[I].nice_length,C=Ct[I].max_chain,y=0,b=0,_=0,w=A=2,v=0,u=0}(),0}(e))},t.deflateEnd=function(){return 42!=n&&n!=It&&n!=Vt?wt:(t.pending_buf=null,h=null,c=null,l=null,t.dstate=null,n==It?-3:0)},t.deflateParams=function(t,e,n){let i=0;return-1==e&&(e=6),e<0||e>9||n<0||n>2?wt:(Ct[I].func!=Ct[e].func&&0!==t.total_in&&(i=t.deflate(1)),I!=e&&(I=e,S=Ct[I].max_lazy,E=Ct[I].good_length,$=Ct[I].nice_length,C=Ct[I].max_chain),V=n,i)},t.deflateSetDictionary=function(t,e,i){let s,a=i,d=0;if(!e||42!=n)return wt;if(a<3)return 0;for(a>r-Et&&(a=r-Et,d=i-a),l.set(e.subarray(d,d+a),0),y=a,b=a,u=255&l[0],u=(u<<g^255&l[1])&f,s=0;s<=a-3;s++)u=(u<<g^255&l[s+2])&f,c[s&o]=h[u],h[u]=s;return 0},t.deflate=function(d,m){let C,E,$,T,L;if(m>4||m<0)return wt;if(!d.next_out||!d.next_in&&0!==d.avail_in||n==Vt&&4!=m)return d.msg=St[4],wt;if(0===d.avail_out)return d.msg=St[7],-5;var B;if(e=d,T=s,s=m,42==n&&(E=8+(a-8<<4)<<8,$=(I-1&255)>>1,$>3&&($=3),E|=$<<6,0!==y&&(E|=32),E+=31-E%31,n=It,K((B=E)>>8&255),K(255&B)),0!==t.pending){if(e.flush_pending(),0===e.avail_out)return s=-1,0}else if(0===e.avail_in&&m<=T&&4!=m)return e.msg=St[7],-5;if(n==Vt&&0!==e.avail_in)return d.msg=St[7],-5;if(0!==e.avail_in||0!==_||0!=m&&n!=Vt){switch(L=-1,Ct[I].func){case 0:L=function(t){let n,s=65535;for(s>i-5&&(s=i-5);;){if(_<=1){if(st(),0===_&&0==t)return 0;if(0===_)break}if(y+=_,_=0,n=b+s,(0===y||y>=n)&&(_=y-n,y=n,it(!1),0===e.avail_out))return 0;if(y-b>=r-Et&&(it(!1),0===e.avail_out))return 0}return it(4==t),0===e.avail_out?4==t?2:0:4==t?3:1}(m);break;case 1:L=function(t){let n,i=0;for(;;){if(_<Et){if(st(),_<Et&&0==t)return 0;if(0===_)break}if(_>=3&&(u=(u<<g^255&l[y+2])&f,i=65535&h[u],c[y&o]=h[u],h[u]=y),0!==i&&(y-i&65535)<=r-Et&&2!=V&&(w=rt(i)),w>=3)if(n=Y(y-k,w-3),_-=w,w<=S&&_>=3){w--;do{y++,u=(u<<g^255&l[y+2])&f,i=65535&h[u],c[y&o]=h[u],h[u]=y}while(0!=--w);y++}else y+=w,w=0,u=255&l[y],u=(u<<g^255&l[y+1])&f;else n=Y(0,255&l[y]),_--,y++;if(n&&(it(!1),0===e.avail_out))return 0}return it(4==t),0===e.avail_out?4==t?2:0:4==t?3:1}(m);break;case 2:L=function(t){let n,i,s=0;for(;;){if(_<Et){if(st(),_<Et&&0==t)return 0;if(0===_)break}if(_>=3&&(u=(u<<g^255&l[y+2])&f,s=65535&h[u],c[y&o]=h[u],h[u]=y),A=w,x=k,w=2,0!==s&&A<S&&(y-s&65535)<=r-Et&&(2!=V&&(w=rt(s)),w<=5&&(1==V||3==w&&y-k>4096)&&(w=2)),A>=3&&w<=A){i=y+_-3,n=Y(y-1-x,A-3),_-=A-1,A-=2;do{++y<=i&&(u=(u<<g^255&l[y+2])&f,s=65535&h[u],c[y&o]=h[u],h[u]=y)}while(0!=--A);if(v=0,w=2,y++,n&&(it(!1),0===e.avail_out))return 0}else if(0!==v){if(n=Y(0,255&l[y-1]),n&&it(!1),y++,_--,0===e.avail_out)return 0}else v=1,y++,_--}return 0!==v&&(n=Y(0,255&l[y-1]),v=0),it(4==t),0===e.avail_out?4==t?2:0:4==t?3:1}(m)}if(2!=L&&3!=L||(n=Vt),0==L||2==L)return 0===e.avail_out&&(s=-1),0;if(1==L){if(1==m)Q(2,3),X(256,_t.static_ltree),J(),1+P+10-q<9&&(Q(2,3),X(256,_t.static_ltree),J()),P=7;else if(nt(0,0,!1),3==m)for(C=0;C<p;C++)h[C]=0;if(e.flush_pending(),0===e.avail_out)return s=-1,0}}return 4!=m?0:1}}function Lt(){const t=this;t.next_in_index=0,t.next_out_index=0,t.avail_in=0,t.total_in=0,t.avail_out=0,t.total_out=0}Lt.prototype={deflateInit:function(t,e){const n=this;return n.dstate=new Tt,e||(e=15),n.dstate.deflateInit(n,t,e)},deflate:function(t){const e=this;return e.dstate?e.dstate.deflate(e,t):wt},deflateEnd:function(){const t=this;if(!t.dstate)return wt;const e=t.dstate.deflateEnd();return t.dstate=null,e},deflateParams:function(t,e){const n=this;return n.dstate?n.dstate.deflateParams(n,t,e):wt},deflateSetDictionary:function(t,e){const n=this;return n.dstate?n.dstate.deflateSetDictionary(n,t,e):wt},read_buf:function(t,e,n){const i=this;let s=i.avail_in;return s>n&&(s=n),0===s?0:(i.avail_in-=s,t.set(i.next_in.subarray(i.next_in_index,i.next_in_index+s),e),i.next_in_index+=s,i.total_in+=s,s)},flush_pending:function(){const t=this;let e=t.dstate.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.next_out.set(t.dstate.pending_buf.subarray(t.dstate.pending_out,t.dstate.pending_out+e),t.next_out_index),t.next_out_index+=e,t.dstate.pending_out+=e,t.total_out+=e,t.avail_out-=e,t.dstate.pending-=e,0===t.dstate.pending&&(t.dstate.pending_out=0))}};const Bt=-2,Dt=-3,Mt=-5,Nt=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],Ot=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],zt=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],Ut=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Ft=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],Rt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Pt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function jt(){let t,e,n,i,s,r;function a(t,e,a,o,l,d,c,h,u,p,m){let f,g,b,w,x,v,y,k,_,A,C,S,I,V,E;A=0,x=a;do{n[t[e+A]]++,A++,x--}while(0!==x);if(n[0]==a)return c[0]=-1,h[0]=0,0;for(k=h[0],v=1;v<=15&&0===n[v];v++);for(y=v,k<v&&(k=v),x=15;0!==x&&0===n[x];x--);for(b=x,k>x&&(k=x),h[0]=k,V=1<<v;v<x;v++,V<<=1)if((V-=n[v])<0)return Dt;if((V-=n[x])<0)return Dt;for(n[x]+=V,r[1]=v=0,A=1,I=2;0!=--x;)r[I]=v+=n[A],I++,A++;x=0,A=0;do{0!==(v=t[e+A])&&(m[r[v]++]=x),A++}while(++x<a);for(a=r[b],r[0]=x=0,A=0,w=-1,S=-k,s[0]=0,C=0,E=0;y<=b;y++)for(f=n[y];0!=f--;){for(;y>S+k;){if(w++,S+=k,E=b-S,E=E>k?k:E,(g=1<<(v=y-S))>f+1&&(g-=f+1,I=y,v<E))for(;++v<E&&!((g<<=1)<=n[++I]);)g-=n[I];if(E=1<<v,p[0]+E>1440)return Dt;s[w]=C=p[0],p[0]+=E,0!==w?(r[w]=x,i[0]=v,i[1]=k,v=x>>>S-k,i[2]=C-s[w-1]-v,u.set(i,3*(s[w-1]+v))):c[0]=C}for(i[1]=y-S,A>=a?i[0]=192:m[A]<o?(i[0]=m[A]<256?0:96,i[2]=m[A++]):(i[0]=d[m[A]-o]+16+64,i[2]=l[m[A++]-o]),g=1<<y-S,v=x>>>S;v<E;v+=g)u.set(i,3*(C+v));for(v=1<<y-1;0!=(x&v);v>>>=1)x^=v;for(x^=v,_=(1<<S)-1;(x&_)!=r[w];)w--,S-=k,_=(1<<S)-1}return 0!==V&&1!=b?Mt:0}function o(a){let o;for(t||(t=[],e=[],n=new Int32Array(16),i=[],s=new Int32Array(15),r=new Int32Array(16)),e.length<a&&(e=[]),o=0;o<a;o++)e[o]=0;for(o=0;o<16;o++)n[o]=0;for(o=0;o<3;o++)i[o]=0;s.set(n.subarray(0,15),0),r.set(n.subarray(0,16),0)}this.inflate_trees_bits=function(n,i,s,r,l){let d;return o(19),t[0]=0,d=a(n,0,19,19,null,null,s,i,r,t,e),d==Dt?l.msg="oversubscribed dynamic bit lengths tree":d!=Mt&&0!==i[0]||(l.msg="incomplete dynamic bit lengths tree",d=Dt),d},this.inflate_trees_dynamic=function(n,i,s,r,l,d,c,h,u){let p;return o(288),t[0]=0,p=a(s,0,n,257,Ut,Ft,d,r,h,t,e),0!=p||0===r[0]?(p==Dt?u.msg="oversubscribed literal/length tree":-4!=p&&(u.msg="incomplete literal/length tree",p=Dt),p):(o(288),p=a(s,n,i,0,Rt,Pt,c,l,h,t,e),0!=p||0===l[0]&&n>257?(p==Dt?u.msg="oversubscribed distance tree":p==Mt?(u.msg="incomplete distance tree",p=Dt):-4!=p&&(u.msg="empty distance tree with lengths",p=Dt),p):0)}}function qt(){const t=this;let e,n,i,s,r=0,a=0,o=0,l=0,d=0,c=0,h=0,u=0,p=0,m=0;function f(t,e,n,i,s,r,a,o){let l,d,c,h,u,p,m,f,g,b,w,x,v,y,k,_;m=o.next_in_index,f=o.avail_in,u=a.bitb,p=a.bitk,g=a.write,b=g<a.read?a.read-g-1:a.end-g,w=Nt[t],x=Nt[e];do{for(;p<20;)f--,u|=(255&o.read_byte(m++))<<p,p+=8;if(l=u&w,d=n,c=i,_=3*(c+l),0!==(h=d[_]))for(;;){if(u>>=d[_+1],p-=d[_+1],0!=(16&h)){for(h&=15,v=d[_+2]+(u&Nt[h]),u>>=h,p-=h;p<15;)f--,u|=(255&o.read_byte(m++))<<p,p+=8;for(l=u&x,d=s,c=r,_=3*(c+l),h=d[_];;){if(u>>=d[_+1],p-=d[_+1],0!=(16&h)){for(h&=15;p<h;)f--,u|=(255&o.read_byte(m++))<<p,p+=8;if(y=d[_+2]+(u&Nt[h]),u>>=h,p-=h,b-=v,g>=y)k=g-y,g-k>0&&2>g-k?(a.window[g++]=a.window[k++],a.window[g++]=a.window[k++],v-=2):(a.window.set(a.window.subarray(k,k+2),g),g+=2,k+=2,v-=2);else{k=g-y;do{k+=a.end}while(k<0);if(h=a.end-k,v>h){if(v-=h,g-k>0&&h>g-k)do{a.window[g++]=a.window[k++]}while(0!=--h);else a.window.set(a.window.subarray(k,k+h),g),g+=h,k+=h,h=0;k=0}}if(g-k>0&&v>g-k)do{a.window[g++]=a.window[k++]}while(0!=--v);else a.window.set(a.window.subarray(k,k+v),g),g+=v,k+=v,v=0;break}if(0!=(64&h))return o.msg="invalid distance code",v=o.avail_in-f,v=p>>3<v?p>>3:v,f+=v,m-=v,p-=v<<3,a.bitb=u,a.bitk=p,o.avail_in=f,o.total_in+=m-o.next_in_index,o.next_in_index=m,a.write=g,Dt;l+=d[_+2],l+=u&Nt[h],_=3*(c+l),h=d[_]}break}if(0!=(64&h))return 0!=(32&h)?(v=o.avail_in-f,v=p>>3<v?p>>3:v,f+=v,m-=v,p-=v<<3,a.bitb=u,a.bitk=p,o.avail_in=f,o.total_in+=m-o.next_in_index,o.next_in_index=m,a.write=g,1):(o.msg="invalid literal/length code",v=o.avail_in-f,v=p>>3<v?p>>3:v,f+=v,m-=v,p-=v<<3,a.bitb=u,a.bitk=p,o.avail_in=f,o.total_in+=m-o.next_in_index,o.next_in_index=m,a.write=g,Dt);if(l+=d[_+2],l+=u&Nt[h],_=3*(c+l),0===(h=d[_])){u>>=d[_+1],p-=d[_+1],a.window[g++]=d[_+2],b--;break}}else u>>=d[_+1],p-=d[_+1],a.window[g++]=d[_+2],b--}while(b>=258&&f>=10);return v=o.avail_in-f,v=p>>3<v?p>>3:v,f+=v,m-=v,p-=v<<3,a.bitb=u,a.bitk=p,o.avail_in=f,o.total_in+=m-o.next_in_index,o.next_in_index=m,a.write=g,0}t.init=function(t,r,a,o,l,d){e=0,h=t,u=r,i=a,p=o,s=l,m=d,n=null},t.proc=function(t,g,b){let w,x,v,y,k,_,A,C=0,S=0,I=0;for(I=g.next_in_index,y=g.avail_in,C=t.bitb,S=t.bitk,k=t.write,_=k<t.read?t.read-k-1:t.end-k;;)switch(e){case 0:if(_>=258&&y>=10&&(t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,b=f(h,u,i,p,s,m,t,g),I=g.next_in_index,y=g.avail_in,C=t.bitb,S=t.bitk,k=t.write,_=k<t.read?t.read-k-1:t.end-k,0!=b)){e=1==b?7:9;break}o=h,n=i,a=p,e=1;case 1:for(w=o;S<w;){if(0===y)return t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);b=0,y--,C|=(255&g.read_byte(I++))<<S,S+=8}if(x=3*(a+(C&Nt[w])),C>>>=n[x+1],S-=n[x+1],v=n[x],0===v){l=n[x+2],e=6;break}if(0!=(16&v)){d=15&v,r=n[x+2],e=2;break}if(0==(64&v)){o=v,a=x/3+n[x+2];break}if(0!=(32&v)){e=7;break}return e=9,g.msg="invalid literal/length code",b=Dt,t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);case 2:for(w=d;S<w;){if(0===y)return t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);b=0,y--,C|=(255&g.read_byte(I++))<<S,S+=8}r+=C&Nt[w],C>>=w,S-=w,o=u,n=s,a=m,e=3;case 3:for(w=o;S<w;){if(0===y)return t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);b=0,y--,C|=(255&g.read_byte(I++))<<S,S+=8}if(x=3*(a+(C&Nt[w])),C>>=n[x+1],S-=n[x+1],v=n[x],0!=(16&v)){d=15&v,c=n[x+2],e=4;break}if(0==(64&v)){o=v,a=x/3+n[x+2];break}return e=9,g.msg="invalid distance code",b=Dt,t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);case 4:for(w=d;S<w;){if(0===y)return t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);b=0,y--,C|=(255&g.read_byte(I++))<<S,S+=8}c+=C&Nt[w],C>>=w,S-=w,e=5;case 5:for(A=k-c;A<0;)A+=t.end;for(;0!==r;){if(0===_&&(k==t.end&&0!==t.read&&(k=0,_=k<t.read?t.read-k-1:t.end-k),0===_&&(t.write=k,b=t.inflate_flush(g,b),k=t.write,_=k<t.read?t.read-k-1:t.end-k,k==t.end&&0!==t.read&&(k=0,_=k<t.read?t.read-k-1:t.end-k),0===_)))return t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);t.window[k++]=t.window[A++],_--,A==t.end&&(A=0),r--}e=0;break;case 6:if(0===_&&(k==t.end&&0!==t.read&&(k=0,_=k<t.read?t.read-k-1:t.end-k),0===_&&(t.write=k,b=t.inflate_flush(g,b),k=t.write,_=k<t.read?t.read-k-1:t.end-k,k==t.end&&0!==t.read&&(k=0,_=k<t.read?t.read-k-1:t.end-k),0===_)))return t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);b=0,t.window[k++]=l,_--,e=0;break;case 7:if(S>7&&(S-=8,y++,I--),t.write=k,b=t.inflate_flush(g,b),k=t.write,_=k<t.read?t.read-k-1:t.end-k,t.read!=t.write)return t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);e=8;case 8:return b=1,t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);case 9:return b=Dt,t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b);default:return b=Bt,t.bitb=C,t.bitk=S,g.avail_in=y,g.total_in+=I-g.next_in_index,g.next_in_index=I,t.write=k,t.inflate_flush(g,b)}},t.free=function(){}}jt.inflate_trees_fixed=function(t,e,n,i){return t[0]=9,e[0]=5,n[0]=Ot,i[0]=zt,0};const Wt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function Ht(t,e){const n=this;let i,s=0,r=0,a=0,o=0;const l=[0],d=[0],c=new qt;let h=0,u=new Int32Array(4320);const p=new jt;n.bitk=0,n.bitb=0,n.window=new Uint8Array(e),n.end=e,n.read=0,n.write=0,n.reset=function(t,e){e&&(e[0]=0),6==s&&c.free(t),s=0,n.bitk=0,n.bitb=0,n.read=n.write=0},n.reset(t,null),n.inflate_flush=function(t,e){let i,s,r;return s=t.next_out_index,r=n.read,i=(r<=n.write?n.write:n.end)-r,i>t.avail_out&&(i=t.avail_out),0!==i&&e==Mt&&(e=0),t.avail_out-=i,t.total_out+=i,t.next_out.set(n.window.subarray(r,r+i),s),s+=i,r+=i,r==n.end&&(r=0,n.write==n.end&&(n.write=0),i=n.write-r,i>t.avail_out&&(i=t.avail_out),0!==i&&e==Mt&&(e=0),t.avail_out-=i,t.total_out+=i,t.next_out.set(n.window.subarray(r,r+i),s),s+=i,r+=i),t.next_out_index=s,n.read=r,e},n.proc=function(t,e){let m,f,g,b,w,x,v,y;for(b=t.next_in_index,w=t.avail_in,f=n.bitb,g=n.bitk,x=n.write,v=x<n.read?n.read-x-1:n.end-x;;){let k,_,A,C,S,I,V,E;switch(s){case 0:for(;g<3;){if(0===w)return n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);e=0,w--,f|=(255&t.read_byte(b++))<<g,g+=8}switch(m=7&f,h=1&m,m>>>1){case 0:f>>>=3,g-=3,m=7&g,f>>>=m,g-=m,s=1;break;case 1:k=[],_=[],A=[[]],C=[[]],jt.inflate_trees_fixed(k,_,A,C),c.init(k[0],_[0],A[0],0,C[0],0),f>>>=3,g-=3,s=6;break;case 2:f>>>=3,g-=3,s=3;break;case 3:return f>>>=3,g-=3,s=9,t.msg="invalid block type",e=Dt,n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e)}break;case 1:for(;g<32;){if(0===w)return n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);e=0,w--,f|=(255&t.read_byte(b++))<<g,g+=8}if((~f>>>16&65535)!=(65535&f))return s=9,t.msg="invalid stored block lengths",e=Dt,n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);r=65535&f,f=g=0,s=0!==r?2:0!==h?7:0;break;case 2:if(0===w)return n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);if(0===v&&(x==n.end&&0!==n.read&&(x=0,v=x<n.read?n.read-x-1:n.end-x),0===v&&(n.write=x,e=n.inflate_flush(t,e),x=n.write,v=x<n.read?n.read-x-1:n.end-x,x==n.end&&0!==n.read&&(x=0,v=x<n.read?n.read-x-1:n.end-x),0===v)))return n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);if(e=0,m=r,m>w&&(m=w),m>v&&(m=v),n.window.set(t.read_buf(b,m),x),b+=m,w-=m,x+=m,v-=m,0!=(r-=m))break;s=0!==h?7:0;break;case 3:for(;g<14;){if(0===w)return n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);e=0,w--,f|=(255&t.read_byte(b++))<<g,g+=8}if(a=m=16383&f,(31&m)>29||(m>>5&31)>29)return s=9,t.msg="too many length or distance symbols",e=Dt,n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);if(m=258+(31&m)+(m>>5&31),!i||i.length<m)i=[];else for(y=0;y<m;y++)i[y]=0;f>>>=14,g-=14,o=0,s=4;case 4:for(;o<4+(a>>>10);){for(;g<3;){if(0===w)return n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);e=0,w--,f|=(255&t.read_byte(b++))<<g,g+=8}i[Wt[o++]]=7&f,f>>>=3,g-=3}for(;o<19;)i[Wt[o++]]=0;if(l[0]=7,m=p.inflate_trees_bits(i,l,d,u,t),0!=m)return(e=m)==Dt&&(i=null,s=9),n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);o=0,s=5;case 5:for(;m=a,!(o>=258+(31&m)+(m>>5&31));){let r,c;for(m=l[0];g<m;){if(0===w)return n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);e=0,w--,f|=(255&t.read_byte(b++))<<g,g+=8}if(m=u[3*(d[0]+(f&Nt[m]))+1],c=u[3*(d[0]+(f&Nt[m]))+2],c<16)f>>>=m,g-=m,i[o++]=c;else{for(y=18==c?7:c-14,r=18==c?11:3;g<m+y;){if(0===w)return n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);e=0,w--,f|=(255&t.read_byte(b++))<<g,g+=8}if(f>>>=m,g-=m,r+=f&Nt[y],f>>>=y,g-=y,y=o,m=a,y+r>258+(31&m)+(m>>5&31)||16==c&&y<1)return i=null,s=9,t.msg="invalid bit length repeat",e=Dt,n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);c=16==c?i[y-1]:0;do{i[y++]=c}while(0!=--r);o=y}}if(d[0]=-1,S=[],I=[],V=[],E=[],S[0]=9,I[0]=6,m=a,m=p.inflate_trees_dynamic(257+(31&m),1+(m>>5&31),i,S,I,V,E,u,t),0!=m)return m==Dt&&(i=null,s=9),e=m,n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);c.init(S[0],I[0],u,V[0],u,E[0]),s=6;case 6:if(n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,1!=(e=c.proc(n,t,e)))return n.inflate_flush(t,e);if(e=0,c.free(t),b=t.next_in_index,w=t.avail_in,f=n.bitb,g=n.bitk,x=n.write,v=x<n.read?n.read-x-1:n.end-x,0===h){s=0;break}s=7;case 7:if(n.write=x,e=n.inflate_flush(t,e),x=n.write,v=x<n.read?n.read-x-1:n.end-x,n.read!=n.write)return n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);s=8;case 8:return e=1,n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);case 9:return e=Dt,n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e);default:return e=Bt,n.bitb=f,n.bitk=g,t.avail_in=w,t.total_in+=b-t.next_in_index,t.next_in_index=b,n.write=x,n.inflate_flush(t,e)}}},n.free=function(t){n.reset(t,null),n.window=null,u=null},n.set_dictionary=function(t,e,i){n.window.set(t.subarray(e,e+i),0),n.read=n.write=i},n.sync_point=function(){return 1==s?1:0}}const Kt=13,Zt=[0,0,255,255];function Qt(){const t=this;function e(t){return t&&t.istate?(t.total_in=t.total_out=0,t.msg=null,t.istate.mode=7,t.istate.blocks.reset(t,null),0):Bt}t.mode=0,t.method=0,t.was=[0],t.need=0,t.marker=0,t.wbits=0,t.inflateEnd=function(e){return t.blocks&&t.blocks.free(e),t.blocks=null,0},t.inflateInit=function(n,i){return n.msg=null,t.blocks=null,i<8||i>15?(t.inflateEnd(n),Bt):(t.wbits=i,n.istate.blocks=new Ht(n,1<<i),e(n),0)},t.inflate=function(t,e){let n,i;if(!t||!t.istate||!t.next_in)return Bt;const s=t.istate;for(e=4==e?Mt:0,n=Mt;;)switch(s.mode){case 0:if(0===t.avail_in)return n;if(n=e,t.avail_in--,t.total_in++,8!=(15&(s.method=t.read_byte(t.next_in_index++)))){s.mode=Kt,t.msg="unknown compression method",s.marker=5;break}if(8+(s.method>>4)>s.wbits){s.mode=Kt,t.msg="invalid window size",s.marker=5;break}s.mode=1;case 1:if(0===t.avail_in)return n;if(n=e,t.avail_in--,t.total_in++,i=255&t.read_byte(t.next_in_index++),((s.method<<8)+i)%31!=0){s.mode=Kt,t.msg="incorrect header check",s.marker=5;break}if(0==(32&i)){s.mode=7;break}s.mode=2;case 2:if(0===t.avail_in)return n;n=e,t.avail_in--,t.total_in++,s.need=(255&t.read_byte(t.next_in_index++))<<24&4278190080,s.mode=3;case 3:if(0===t.avail_in)return n;n=e,t.avail_in--,t.total_in++,s.need+=(255&t.read_byte(t.next_in_index++))<<16&16711680,s.mode=4;case 4:if(0===t.avail_in)return n;n=e,t.avail_in--,t.total_in++,s.need+=(255&t.read_byte(t.next_in_index++))<<8&65280,s.mode=5;case 5:return 0===t.avail_in?n:(n=e,t.avail_in--,t.total_in++,s.need+=255&t.read_byte(t.next_in_index++),s.mode=6,2);case 6:return s.mode=Kt,t.msg="need dictionary",s.marker=0,Bt;case 7:if(n=s.blocks.proc(t,n),n==Dt){s.mode=Kt,s.marker=0;break}if(0==n&&(n=e),1!=n)return n;n=e,s.blocks.reset(t,s.was),s.mode=12;case 12:return 1;case Kt:return Dt;default:return Bt}},t.inflateSetDictionary=function(t,e,n){let i=0,s=n;if(!t||!t.istate||6!=t.istate.mode)return Bt;const r=t.istate;return s>=1<<r.wbits&&(s=(1<<r.wbits)-1,i=n-s),r.blocks.set_dictionary(e,i,s),r.mode=7,0},t.inflateSync=function(t){let n,i,s,r,a;if(!t||!t.istate)return Bt;const o=t.istate;if(o.mode!=Kt&&(o.mode=Kt,o.marker=0),0===(n=t.avail_in))return Mt;for(i=t.next_in_index,s=o.marker;0!==n&&s<4;)t.read_byte(i)==Zt[s]?s++:s=0!==t.read_byte(i)?0:4-s,i++,n--;return t.total_in+=i-t.next_in_index,t.next_in_index=i,t.avail_in=n,o.marker=s,4!=s?Dt:(r=t.total_in,a=t.total_out,e(t),t.total_in=r,t.total_out=a,o.mode=7,0)},t.inflateSyncPoint=function(t){return t&&t.istate&&t.istate.blocks?t.istate.blocks.sync_point():Bt}}function Xt(){}Xt.prototype={inflateInit:function(t){const e=this;return e.istate=new Qt,t||(t=15),e.istate.inflateInit(e,t)},inflate:function(t){const e=this;return e.istate?e.istate.inflate(e,t):Bt},inflateEnd:function(){const t=this;if(!t.istate)return Bt;const e=t.istate.inflateEnd(t);return t.istate=null,e},inflateSync:function(){const t=this;return t.istate?t.istate.inflateSync(t):Bt},inflateSetDictionary:function(t,e){const n=this;return n.istate?n.istate.inflateSetDictionary(n,t,e):Bt},read_byte:function(t){return this.next_in[t]},read_buf:function(t,e){return this.next_in.subarray(t,t+e)}};const Gt={chunkSize:524288,maxWorkers:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||2,terminateWorkerTimeout:5e3,useWebWorkers:!0,workerScripts:void 0},Jt=Object.assign({},Gt);function Yt(){return Jt}function te(t){if(void 0!==t.chunkSize&&(Jt.chunkSize=t.chunkSize),void 0!==t.maxWorkers&&(Jt.maxWorkers=t.maxWorkers),void 0!==t.terminateWorkerTimeout&&(Jt.terminateWorkerTimeout=t.terminateWorkerTimeout),void 0!==t.useWebWorkers&&(Jt.useWebWorkers=t.useWebWorkers),void 0!==t.Deflate&&(Jt.Deflate=t.Deflate),void 0!==t.Inflate&&(Jt.Inflate=t.Inflate),void 0!==t.workerScripts){if(t.workerScripts.deflate){if(!Array.isArray(t.workerScripts.deflate))throw new Error("workerScripts.deflate must be an array");Jt.workerScripts||(Jt.workerScripts={}),Jt.workerScripts.deflate=t.workerScripts.deflate}if(t.workerScripts.inflate){if(!Array.isArray(t.workerScripts.inflate))throw new Error("workerScripts.inflate must be an array");Jt.workerScripts||(Jt.workerScripts={}),Jt.workerScripts.inflate=t.workerScripts.inflate}}}const ee={application:{"andrew-inset":"ez",annodex:"anx","atom+xml":"atom","atomcat+xml":"atomcat","atomserv+xml":"atomsrv",bbolin:"lin",cap:["cap","pcap"],"cu-seeme":"cu","davmount+xml":"davmount",dsptype:"tsp",ecmascript:["es","ecma"],futuresplash:"spl",hta:"hta","java-archive":"jar","java-serialized-object":"ser","java-vm":"class",javascript:"js",m3g:"m3g","mac-binhex40":"hqx",mathematica:["nb","ma","mb"],msaccess:"mdb",msword:["doc","dot"],mxf:"mxf",oda:"oda",ogg:"ogx",pdf:"pdf","pgp-keys":"key","pgp-signature":["asc","sig"],"pics-rules":"prf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],rar:"rar","rdf+xml":"rdf","rss+xml":"rss",rtf:"rtf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd"],"xspf+xml":"xspf",zip:"zip","vnd.android.package-archive":"apk","vnd.cinderella":"cdy","vnd.google-earth.kml+xml":"kml","vnd.google-earth.kmz":"kmz","vnd.mozilla.xul+xml":"xul","vnd.ms-excel":["xls","xlb","xlt","xlm","xla","xlc","xlw"],"vnd.ms-pki.seccat":"cat","vnd.ms-pki.stl":"stl","vnd.ms-powerpoint":["ppt","pps","pot"],"vnd.oasis.opendocument.chart":"odc","vnd.oasis.opendocument.database":"odb","vnd.oasis.opendocument.formula":"odf","vnd.oasis.opendocument.graphics":"odg","vnd.oasis.opendocument.graphics-template":"otg","vnd.oasis.opendocument.image":"odi","vnd.oasis.opendocument.presentation":"odp","vnd.oasis.opendocument.presentation-template":"otp","vnd.oasis.opendocument.spreadsheet":"ods","vnd.oasis.opendocument.spreadsheet-template":"ots","vnd.oasis.opendocument.text":"odt","vnd.oasis.opendocument.text-master":"odm","vnd.oasis.opendocument.text-template":"ott","vnd.oasis.opendocument.text-web":"oth","vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","vnd.openxmlformats-officedocument.spreadsheetml.template":"xltx","vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","vnd.openxmlformats-officedocument.presentationml.slideshow":"ppsx","vnd.openxmlformats-officedocument.presentationml.template":"potx","vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","vnd.openxmlformats-officedocument.wordprocessingml.template":"dotx","vnd.smaf":"mmf","vnd.stardivision.calc":"sdc","vnd.stardivision.chart":"sds","vnd.stardivision.draw":"sda","vnd.stardivision.impress":"sdd","vnd.stardivision.math":["sdf","smf"],"vnd.stardivision.writer":["sdw","vor"],"vnd.stardivision.writer-global":"sgl","vnd.sun.xml.calc":"sxc","vnd.sun.xml.calc.template":"stc","vnd.sun.xml.draw":"sxd","vnd.sun.xml.draw.template":"std","vnd.sun.xml.impress":"sxi","vnd.sun.xml.impress.template":"sti","vnd.sun.xml.math":"sxm","vnd.sun.xml.writer":"sxw","vnd.sun.xml.writer.global":"sxg","vnd.sun.xml.writer.template":"stw","vnd.symbian.install":["sis","sisx"],"vnd.visio":["vsd","vst","vss","vsw"],"vnd.wap.wbxml":"wbxml","vnd.wap.wmlc":"wmlc","vnd.wap.wmlscriptc":"wmlsc","vnd.wordperfect":"wpd","vnd.wordperfect5.1":"wp5","x-123":"wk","x-7z-compressed":"7z","x-abiword":"abw","x-apple-diskimage":"dmg","x-bcpio":"bcpio","x-bittorrent":"torrent","x-cbr":["cbr","cba","cbt","cb7"],"x-cbz":"cbz","x-cdf":["cdf","cda"],"x-cdlink":"vcd","x-chess-pgn":"pgn","x-cpio":"cpio","x-csh":"csh","x-debian-package":["deb","udeb"],"x-director":["dcr","dir","dxr","cst","cct","cxt","w3d","fgd","swa"],"x-dms":"dms","x-doom":"wad","x-dvi":"dvi","x-httpd-eruby":"rhtml","x-font":"pcf.Z","x-freemind":"mm","x-gnumeric":"gnumeric","x-go-sgf":"sgf","x-graphing-calculator":"gcf","x-gtar":["gtar","taz"],"x-hdf":"hdf","x-httpd-php":["phtml","pht","php"],"x-httpd-php-source":"phps","x-httpd-php3":"php3","x-httpd-php3-preprocessed":"php3p","x-httpd-php4":"php4","x-httpd-php5":"php5","x-ica":"ica","x-info":"info","x-internet-signup":["ins","isp"],"x-iphone":"iii","x-iso9660-image":"iso","x-java-jnlp-file":"jnlp","x-jmol":"jmz","x-killustrator":"kil","x-koan":["skp","skd","skt","skm"],"x-kpresenter":["kpr","kpt"],"x-kword":["kwd","kwt"],"x-latex":"latex","x-lha":"lha","x-lyx":"lyx","x-lzh":"lzh","x-lzx":"lzx","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-ms-wmd":"wmd","x-ms-wmz":"wmz","x-msdos-program":["com","exe","bat","dll"],"x-msi":"msi","x-netcdf":["nc","cdf"],"x-ns-proxy-autoconfig":["pac","dat"],"x-nwc":"nwc","x-object":"o","x-oz-application":"oza","x-pkcs7-certreqresp":"p7r","x-python-code":["pyc","pyo"],"x-qgis":["qgs","shp","shx"],"x-quicktimeplayer":"qtl","x-redhat-package-manager":"rpm","x-ruby":"rb","x-sh":"sh","x-shar":"shar","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","x-stuffit":"sit","x-sv4cpio":"sv4cpio","x-sv4crc":"sv4crc","x-tar":"tar","x-tcl":"tcl","x-tex-gf":"gf","x-tex-pk":"pk","x-texinfo":["texinfo","texi"],"x-trash":["~","%","bak","old","sik"],"x-troff":["t","tr","roff"],"x-troff-man":"man","x-troff-me":"me","x-troff-ms":"ms","x-ustar":"ustar","x-wais-source":"src","x-wingz":"wz","x-x509-ca-cert":["crt","der","cer"],"x-xcf":"xcf","x-xfig":"fig","x-xpinstall":"xpi",applixware:"aw","atomsvc+xml":"atomsvc","ccxml+xml":"ccxml","cdmi-capability":"cdmia","cdmi-container":"cdmic","cdmi-domain":"cdmid","cdmi-object":"cdmio","cdmi-queue":"cdmiq","docbook+xml":"dbk","dssc+der":"dssc","dssc+xml":"xdssc","emma+xml":"emma","epub+zip":"epub",exi:"exi","font-tdpfr":"pfr","gml+xml":"gml","gpx+xml":"gpx",gxf:"gxf",hyperstudio:"stk","inkml+xml":["ink","inkml"],ipfix:"ipfix",json:"json","jsonml+json":"jsonml","lost+xml":"lostxml","mads+xml":"mads",marc:"mrc","marcxml+xml":"mrcx","mathml+xml":"mathml",mbox:"mbox","mediaservercontrol+xml":"mscml","metalink+xml":"metalink","metalink4+xml":"meta4","mets+xml":"mets","mods+xml":"mods",mp21:["m21","mp21"],mp4:"mp4s","oebps-package+xml":"opf","omdoc+xml":"omdoc",onenote:["onetoc","onetoc2","onetmp","onepkg"],oxps:"oxps","patch-ops-error+xml":"xer","pgp-encrypted":"pgp",pkcs10:"p10","pkcs7-mime":["p7m","p7c"],"pkcs7-signature":"p7s",pkcs8:"p8","pkix-attr-cert":"ac","pkix-crl":"crl","pkix-pkipath":"pkipath",pkixcmp:"pki","pls+xml":"pls","prs.cww":"cww","pskc+xml":"pskcxml","reginfo+xml":"rif","relax-ng-compact-syntax":"rnc","resource-lists+xml":"rl","resource-lists-diff+xml":"rld","rls-services+xml":"rs","rpki-ghostbusters":"gbr","rpki-manifest":"mft","rpki-roa":"roa","rsd+xml":"rsd","sbml+xml":"sbml","scvp-cv-request":"scq","scvp-cv-response":"scs","scvp-vp-request":"spq","scvp-vp-response":"spp",sdp:"sdp","set-payment-initiation":"setpay","set-registration-initiation":"setreg","shf+xml":"shf","sparql-query":"rq","sparql-results+xml":"srx",srgs:"gram","srgs+xml":"grxml","sru+xml":"sru","ssdl+xml":"ssdl","ssml+xml":"ssml","tei+xml":["tei","teicorpus"],"thraud+xml":"tfi","timestamped-data":"tsd","vnd.3gpp.pic-bw-large":"plb","vnd.3gpp.pic-bw-small":"psb","vnd.3gpp.pic-bw-var":"pvb","vnd.3gpp2.tcap":"tcap","vnd.3m.post-it-notes":"pwn","vnd.accpac.simply.aso":"aso","vnd.accpac.simply.imp":"imp","vnd.acucobol":"acu","vnd.acucorp":["atc","acutc"],"vnd.adobe.air-application-installer-package+zip":"air","vnd.adobe.formscentral.fcdt":"fcdt","vnd.adobe.fxp":["fxp","fxpl"],"vnd.adobe.xdp+xml":"xdp","vnd.adobe.xfdf":"xfdf","vnd.ahead.space":"ahead","vnd.airzip.filesecure.azf":"azf","vnd.airzip.filesecure.azs":"azs","vnd.amazon.ebook":"azw","vnd.americandynamics.acc":"acc","vnd.amiga.ami":"ami","vnd.anser-web-certificate-issue-initiation":"cii","vnd.anser-web-funds-transfer-initiation":"fti","vnd.antix.game-component":"atx","vnd.apple.installer+xml":"mpkg","vnd.apple.mpegurl":"m3u8","vnd.aristanetworks.swi":"swi","vnd.astraea-software.iota":"iota","vnd.audiograph":"aep","vnd.blueice.multipass":"mpm","vnd.bmi":"bmi","vnd.businessobjects":"rep","vnd.chemdraw+xml":"cdxml","vnd.chipnuts.karaoke-mmd":"mmd","vnd.claymore":"cla","vnd.cloanto.rp9":"rp9","vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"vnd.cluetrust.cartomobile-config":"c11amc","vnd.cluetrust.cartomobile-config-pkg":"c11amz","vnd.commonspace":"csp","vnd.contact.cmsg":"cdbcmsg","vnd.cosmocaller":"cmc","vnd.crick.clicker":"clkx","vnd.crick.clicker.keyboard":"clkk","vnd.crick.clicker.palette":"clkp","vnd.crick.clicker.template":"clkt","vnd.crick.clicker.wordbank":"clkw","vnd.criticaltools.wbs+xml":"wbs","vnd.ctc-posml":"pml","vnd.cups-ppd":"ppd","vnd.curl.car":"car","vnd.curl.pcurl":"pcurl","vnd.dart":"dart","vnd.data-vision.rdz":"rdz","vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"vnd.dece.ttml+xml":["uvt","uvvt"],"vnd.dece.unspecified":["uvx","uvvx"],"vnd.dece.zip":["uvz","uvvz"],"vnd.denovo.fcselayout-link":"fe_launch","vnd.dna":"dna","vnd.dolby.mlp":"mlp","vnd.dpgraph":"dpg","vnd.dreamfactory":"dfac","vnd.ds-keypoint":"kpxx","vnd.dvb.ait":"ait","vnd.dvb.service":"svc","vnd.dynageo":"geo","vnd.ecowin.chart":"mag","vnd.enliven":"nml","vnd.epson.esf":"esf","vnd.epson.msf":"msf","vnd.epson.quickanime":"qam","vnd.epson.salt":"slt","vnd.epson.ssf":"ssf","vnd.eszigno3+xml":["es3","et3"],"vnd.ezpix-album":"ez2","vnd.ezpix-package":"ez3","vnd.fdf":"fdf","vnd.fdsn.mseed":"mseed","vnd.fdsn.seed":["seed","dataless"],"vnd.flographit":"gph","vnd.fluxtime.clip":"ftc","vnd.framemaker":["fm","frame","maker","book"],"vnd.frogans.fnc":"fnc","vnd.frogans.ltf":"ltf","vnd.fsc.weblaunch":"fsc","vnd.fujitsu.oasys":"oas","vnd.fujitsu.oasys2":"oa2","vnd.fujitsu.oasys3":"oa3","vnd.fujitsu.oasysgp":"fg5","vnd.fujitsu.oasysprs":"bh2","vnd.fujixerox.ddd":"ddd","vnd.fujixerox.docuworks":"xdw","vnd.fujixerox.docuworks.binder":"xbd","vnd.fuzzysheet":"fzs","vnd.genomatix.tuxedo":"txd","vnd.geogebra.file":"ggb","vnd.geogebra.tool":"ggt","vnd.geometry-explorer":["gex","gre"],"vnd.geonext":"gxt","vnd.geoplan":"g2w","vnd.geospace":"g3w","vnd.gmx":"gmx","vnd.grafeq":["gqf","gqs"],"vnd.groove-account":"gac","vnd.groove-help":"ghf","vnd.groove-identity-message":"gim","vnd.groove-injector":"grv","vnd.groove-tool-message":"gtm","vnd.groove-tool-template":"tpl","vnd.groove-vcard":"vcg","vnd.hal+xml":"hal","vnd.handheld-entertainment+xml":"zmm","vnd.hbci":"hbci","vnd.hhe.lesson-player":"les","vnd.hp-hpgl":"hpgl","vnd.hp-hpid":"hpid","vnd.hp-hps":"hps","vnd.hp-jlyt":"jlt","vnd.hp-pcl":"pcl","vnd.hp-pclxl":"pclxl","vnd.hydrostatix.sof-data":"sfd-hdstx","vnd.ibm.minipay":"mpy","vnd.ibm.modcap":["afp","listafp","list3820"],"vnd.ibm.rights-management":"irm","vnd.ibm.secure-container":"sc","vnd.iccprofile":["icc","icm"],"vnd.igloader":"igl","vnd.immervision-ivp":"ivp","vnd.immervision-ivu":"ivu","vnd.insors.igm":"igm","vnd.intercon.formnet":["xpw","xpx"],"vnd.intergeo":"i2g","vnd.intu.qbo":"qbo","vnd.intu.qfx":"qfx","vnd.ipunplugged.rcprofile":"rcprofile","vnd.irepository.package+xml":"irp","vnd.is-xpr":"xpr","vnd.isac.fcs":"fcs","vnd.jam":"jam","vnd.jcp.javame.midlet-rms":"rms","vnd.jisp":"jisp","vnd.joost.joda-archive":"joda","vnd.kahootz":["ktz","ktr"],"vnd.kde.karbon":"karbon","vnd.kde.kchart":"chrt","vnd.kde.kformula":"kfo","vnd.kde.kivio":"flw","vnd.kde.kontour":"kon","vnd.kde.kpresenter":["kpr","kpt"],"vnd.kde.kspread":"ksp","vnd.kde.kword":["kwd","kwt"],"vnd.kenameaapp":"htke","vnd.kidspiration":"kia","vnd.kinar":["kne","knp"],"vnd.koan":["skp","skd","skt","skm"],"vnd.kodak-descriptor":"sse","vnd.las.las+xml":"lasxml","vnd.llamagraphics.life-balance.desktop":"lbd","vnd.llamagraphics.life-balance.exchange+xml":"lbe","vnd.lotus-1-2-3":"123","vnd.lotus-approach":"apr","vnd.lotus-freelance":"pre","vnd.lotus-notes":"nsf","vnd.lotus-organizer":"org","vnd.lotus-screencam":"scm","vnd.lotus-wordpro":"lwp","vnd.macports.portpkg":"portpkg","vnd.mcd":"mcd","vnd.medcalcdata":"mc1","vnd.mediastation.cdkey":"cdkey","vnd.mfer":"mwf","vnd.mfmp":"mfm","vnd.micrografx.flo":"flo","vnd.micrografx.igx":"igx","vnd.mif":"mif","vnd.mobius.daf":"daf","vnd.mobius.dis":"dis","vnd.mobius.mbk":"mbk","vnd.mobius.mqy":"mqy","vnd.mobius.msl":"msl","vnd.mobius.plc":"plc","vnd.mobius.txf":"txf","vnd.mophun.application":"mpn","vnd.mophun.certificate":"mpc","vnd.ms-artgalry":"cil","vnd.ms-cab-compressed":"cab","vnd.ms-excel.addin.macroenabled.12":"xlam","vnd.ms-excel.sheet.binary.macroenabled.12":"xlsb","vnd.ms-excel.sheet.macroenabled.12":"xlsm","vnd.ms-excel.template.macroenabled.12":"xltm","vnd.ms-fontobject":"eot","vnd.ms-htmlhelp":"chm","vnd.ms-ims":"ims","vnd.ms-lrm":"lrm","vnd.ms-officetheme":"thmx","vnd.ms-powerpoint.addin.macroenabled.12":"ppam","vnd.ms-powerpoint.presentation.macroenabled.12":"pptm","vnd.ms-powerpoint.slide.macroenabled.12":"sldm","vnd.ms-powerpoint.slideshow.macroenabled.12":"ppsm","vnd.ms-powerpoint.template.macroenabled.12":"potm","vnd.ms-project":["mpp","mpt"],"vnd.ms-word.document.macroenabled.12":"docm","vnd.ms-word.template.macroenabled.12":"dotm","vnd.ms-works":["wps","wks","wcm","wdb"],"vnd.ms-wpl":"wpl","vnd.ms-xpsdocument":"xps","vnd.mseq":"mseq","vnd.musician":"mus","vnd.muvee.style":"msty","vnd.mynfc":"taglet","vnd.neurolanguage.nlu":"nlu","vnd.nitf":["ntf","nitf"],"vnd.noblenet-directory":"nnd","vnd.noblenet-sealer":"nns","vnd.noblenet-web":"nnw","vnd.nokia.n-gage.data":"ngdat","vnd.nokia.n-gage.symbian.install":"n-gage","vnd.nokia.radio-preset":"rpst","vnd.nokia.radio-presets":"rpss","vnd.novadigm.edm":"edm","vnd.novadigm.edx":"edx","vnd.novadigm.ext":"ext","vnd.oasis.opendocument.chart-template":"otc","vnd.oasis.opendocument.formula-template":"odft","vnd.oasis.opendocument.image-template":"oti","vnd.olpc-sugar":"xo","vnd.oma.dd2+xml":"dd2","vnd.openofficeorg.extension":"oxt","vnd.openxmlformats-officedocument.presentationml.slide":"sldx","vnd.osgeo.mapguide.package":"mgp","vnd.osgi.dp":"dp","vnd.osgi.subsystem":"esa","vnd.palm":["pdb","pqa","oprc"],"vnd.pawaafile":"paw","vnd.pg.format":"str","vnd.pg.osasli":"ei6","vnd.picsel":"efif","vnd.pmi.widget":"wg","vnd.pocketlearn":"plf","vnd.powerbuilder6":"pbd","vnd.previewsystems.box":"box","vnd.proteus.magazine":"mgz","vnd.publishare-delta-tree":"qps","vnd.pvi.ptid1":"ptid","vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"vnd.realvnc.bed":"bed","vnd.recordare.musicxml":"mxl","vnd.recordare.musicxml+xml":"musicxml","vnd.rig.cryptonote":"cryptonote","vnd.rn-realmedia":"rm","vnd.rn-realmedia-vbr":"rmvb","vnd.route66.link66+xml":"link66","vnd.sailingtracker.track":"st","vnd.seemail":"see","vnd.sema":"sema","vnd.semd":"semd","vnd.semf":"semf","vnd.shana.informed.formdata":"ifm","vnd.shana.informed.formtemplate":"itp","vnd.shana.informed.interchange":"iif","vnd.shana.informed.package":"ipk","vnd.simtech-mindmapper":["twd","twds"],"vnd.smart.teacher":"teacher","vnd.solent.sdkm+xml":["sdkm","sdkd"],"vnd.spotfire.dxp":"dxp","vnd.spotfire.sfs":"sfs","vnd.stepmania.package":"smzip","vnd.stepmania.stepchart":"sm","vnd.sus-calendar":["sus","susp"],"vnd.svd":"svd","vnd.syncml+xml":"xsm","vnd.syncml.dm+wbxml":"bdm","vnd.syncml.dm+xml":"xdm","vnd.tao.intent-module-archive":"tao","vnd.tcpdump.pcap":["pcap","cap","dmp"],"vnd.tmobile-livetv":"tmo","vnd.trid.tpt":"tpt","vnd.triscape.mxs":"mxs","vnd.trueapp":"tra","vnd.ufdl":["ufd","ufdl"],"vnd.uiq.theme":"utz","vnd.umajin":"umj","vnd.unity":"unityweb","vnd.uoml+xml":"uoml","vnd.vcx":"vcx","vnd.visionary":"vis","vnd.vsf":"vsf","vnd.webturbo":"wtb","vnd.wolfram.player":"nbp","vnd.wqd":"wqd","vnd.wt.stf":"stf","vnd.xara":"xar","vnd.xfdl":"xfdl","vnd.yamaha.hv-dic":"hvd","vnd.yamaha.hv-script":"hvs","vnd.yamaha.hv-voice":"hvp","vnd.yamaha.openscoreformat":"osf","vnd.yamaha.openscoreformat.osfpvg+xml":"osfpvg","vnd.yamaha.smaf-audio":"saf","vnd.yamaha.smaf-phrase":"spf","vnd.yellowriver-custom-menu":"cmp","vnd.zul":["zir","zirz"],"vnd.zzazz.deck+xml":"zaz","voicexml+xml":"vxml",widget:"wgt",winhlp:"hlp","wsdl+xml":"wsdl","wspolicy+xml":"wspolicy","x-ace-compressed":"ace","x-authorware-bin":["aab","x32","u32","vox"],"x-authorware-map":"aam","x-authorware-seg":"aas","x-blorb":["blb","blorb"],"x-bzip":"bz","x-bzip2":["bz2","boz"],"x-cfs-compressed":"cfs","x-chat":"chat","x-conference":"nsc","x-dgc-compressed":"dgc","x-dtbncx+xml":"ncx","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-eva":"eva","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-freearc":"arc","x-gca-compressed":"gca","x-glulx":"ulx","x-gramps-xml":"gramps","x-install-instructions":"install","x-lzh-compressed":["lzh","lha"],"x-mie":"mie","x-mobipocket-ebook":["prc","mobi"],"x-ms-application":"application","x-ms-shortcut":"lnk","x-ms-xbap":"xbap","x-msbinder":"obd","x-mscardfile":"crd","x-msclip":"clp","x-msdownload":["exe","dll","com","bat","msi"],"x-msmediaview":["mvb","m13","m14"],"x-msmetafile":["wmf","wmz","emf","emz"],"x-msmoney":"mny","x-mspublisher":"pub","x-msschedule":"scd","x-msterminal":"trm","x-mswrite":"wri","x-nzb":"nzb","x-pkcs12":["p12","pfx"],"x-pkcs7-certificates":["p7b","spc"],"x-research-info-systems":"ris","x-silverlight-app":"xap","x-sql":"sql","x-stuffitx":"sitx","x-subrip":"srt","x-t3vm-image":"t3","x-tads":"gam","x-tex":"tex","x-tex-tfm":"tfm","x-tgif":"obj","x-xliff+xml":"xlf","x-xz":"xz","x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"xaml+xml":"xaml","xcap-diff+xml":"xdf","xenc+xml":"xenc","xml-dtd":"dtd","xop+xml":"xop","xproc+xml":"xpl","xslt+xml":"xslt","xv+xml":["mxml","xhvml","xvml","xvm"],yang:"yang","yin+xml":"yin",envoy:"evy",fractals:"fif","internet-property-stream":"acx",olescript:"axs","vnd.ms-outlook":"msg","vnd.ms-pkicertstore":"sst","x-compress":"z","x-compressed":"tgz","x-gzip":"gz","x-perfmon":["pma","pmc","pml","pmr","pmw"],"x-pkcs7-mime":["p7c","p7m"],"ynd.ms-pkipko":"pko"},audio:{amr:"amr","amr-wb":"awb",annodex:"axa",basic:["au","snd"],flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"prs.sid":"sid","x-aiff":["aif","aiff","aifc"],"x-gsm":"gsm","x-ms-wma":"wma","x-ms-wax":"wax","x-pn-realaudio":"ram","x-realaudio":"ra","x-sd2":"sd2","x-wav":"wav",adpcm:"adp",mp4:"mp4a",s3m:"s3m",silk:"sil","vnd.dece.audio":["uva","uvva"],"vnd.digital-winds":"eol","vnd.dra":"dra","vnd.dts":"dts","vnd.dts.hd":"dtshd","vnd.lucent.voice":"lvp","vnd.ms-playready.media.pya":"pya","vnd.nuera.ecelp4800":"ecelp4800","vnd.nuera.ecelp7470":"ecelp7470","vnd.nuera.ecelp9600":"ecelp9600","vnd.rip":"rip",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},chemical:{"x-alchemy":"alc","x-cache":["cac","cache"],"x-cache-csf":"csf","x-cactvs-binary":["cbin","cascii","ctab"],"x-cdx":"cdx","x-chem3d":"c3d","x-cif":"cif","x-cmdf":"cmdf","x-cml":"cml","x-compass":"cpa","x-crossfire":"bsd","x-csml":["csml","csm"],"x-ctx":"ctx","x-cxf":["cxf","cef"],"x-embl-dl-nucleotide":["emb","embl"],"x-gamess-input":["inp","gam","gamin"],"x-gaussian-checkpoint":["fch","fchk"],"x-gaussian-cube":"cub","x-gaussian-input":["gau","gjc","gjf"],"x-gaussian-log":"gal","x-gcg8-sequence":"gcg","x-genbank":"gen","x-hin":"hin","x-isostar":["istr","ist"],"x-jcamp-dx":["jdx","dx"],"x-kinemage":"kin","x-macmolecule":"mcm","x-macromodel-input":["mmd","mmod"],"x-mdl-molfile":"mol","x-mdl-rdfile":"rd","x-mdl-rxnfile":"rxn","x-mdl-sdfile":["sd","sdf"],"x-mdl-tgf":"tgf","x-mmcif":"mcif","x-mol2":"mol2","x-molconn-Z":"b","x-mopac-graph":"gpt","x-mopac-input":["mop","mopcrt","mpc","zmt"],"x-mopac-out":"moo","x-ncbi-asn1":"asn","x-ncbi-asn1-ascii":["prt","ent"],"x-ncbi-asn1-binary":["val","aso"],"x-pdb":["pdb","ent"],"x-rosdal":"ros","x-swissprot":"sw","x-vamas-iso14976":"vms","x-vmd":"vmd","x-xtel":"xtel","x-xyz":"xyz"},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"vnd.djvu":["djvu","djv"],"vnd.wap.wbmp":"wbmp","x-canon-cr2":"cr2","x-canon-crw":"crw","x-cmu-raster":"ras","x-coreldraw":"cdr","x-coreldrawpattern":"pat","x-coreldrawtemplate":"cdt","x-corelphotopaint":"cpt","x-epson-erf":"erf","x-icon":"ico","x-jg":"art","x-jng":"jng","x-nikon-nef":"nef","x-olympus-orf":"orf","x-photoshop":"psd","x-portable-anymap":"pnm","x-portable-bitmap":"pbm","x-portable-graymap":"pgm","x-portable-pixmap":"ppm","x-rgb":"rgb","x-xbitmap":"xbm","x-xpixmap":"xpm","x-xwindowdump":"xwd",bmp:"bmp",cgm:"cgm",g3fax:"g3",ktx:"ktx","prs.btif":"btif",sgi:"sgi","vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"vnd.dwg":"dwg","vnd.dxf":"dxf","vnd.fastbidsheet":"fbs","vnd.fpx":"fpx","vnd.fst":"fst","vnd.fujixerox.edmics-mmr":"mmr","vnd.fujixerox.edmics-rlc":"rlc","vnd.ms-modi":"mdi","vnd.ms-photo":"wdp","vnd.net-fpx":"npx","vnd.xiff":"xif",webp:"webp","x-3ds":"3ds","x-cmx":"cmx","x-freehand":["fh","fhc","fh4","fh5","fh7"],"x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod",pipeg:"jfif"},message:{rfc822:["eml","mime","mht","mhtml","nws"]},model:{iges:["igs","iges"],mesh:["msh","mesh","silo"],vrml:["wrl","vrml"],"x3d+vrml":["x3dv","x3dvz"],"x3d+xml":["x3d","x3dz"],"x3d+binary":["x3db","x3dbz"],"vnd.collada+xml":"dae","vnd.dwf":"dwf","vnd.gdl":"gdl","vnd.gtw":"gtw","vnd.mts":"mts","vnd.vtu":"vtu"},text:{"cache-manifest":["manifest","appcache"],calendar:["ics","icz","ifb"],css:"css",csv:"csv",h323:"323",html:["html","htm","shtml","stm"],iuls:"uls",mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx",scriptlet:["sct","wsc"],texmacs:["tm","ts"],"tab-separated-values":"tsv","vnd.sun.j2me.app-descriptor":"jad","vnd.wap.wml":"wml","vnd.wap.wmlscript":"wmls","x-bibtex":"bib","x-boo":"boo","x-c++hdr":["h++","hpp","hxx","hh"],"x-c++src":["c++","cpp","cxx","cc"],"x-component":"htc","x-dsrc":"d","x-diff":["diff","patch"],"x-haskell":"hs","x-java":"java","x-literate-haskell":"lhs","x-moc":"moc","x-pascal":["p","pas"],"x-pcs-gcd":"gcd","x-perl":["pl","pm"],"x-python":"py","x-scala":"scala","x-setext":"etx","x-tcl":["tcl","tk"],"x-tex":["tex","ltx","sty","cls"],"x-vcalendar":"vcs","x-vcard":"vcf",n3:"n3","prs.lines.tag":"dsc",sgml:["sgml","sgm"],troff:["t","tr","roff","man","me","ms"],turtle:"ttl","uri-list":["uri","uris","urls"],vcard:"vcard","vnd.curl":"curl","vnd.curl.dcurl":"dcurl","vnd.curl.scurl":"scurl","vnd.curl.mcurl":"mcurl","vnd.dvb.subtitle":"sub","vnd.fly":"fly","vnd.fmi.flexstor":"flx","vnd.graphviz":"gv","vnd.in3d.3dml":"3dml","vnd.in3d.spot":"spot","x-asm":["s","asm"],"x-c":["c","cc","cxx","cpp","h","hh","dic"],"x-fortran":["f","for","f77","f90"],"x-opml":"opml","x-nfo":"nfo","x-sfv":"sfv","x-uuencode":"uu",webviewhtml:"htt"},video:{avif:".avif","3gpp":"3gp",annodex:"axv",dl:"dl",dv:["dif","dv"],fli:"fli",gl:"gl",mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.dece.hd":["uvh","uvvh"],"vnd.dece.mobile":["uvm","uvvm"],"vnd.dece.pd":["uvp","uvvp"],"vnd.dece.sd":["uvs","uvvs"],"vnd.dece.video":["uvv","uvvv"],"vnd.dvb.file":"dvb","vnd.fvt":"fvt","vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"},"x-conference":{"x-cooltalk":"ice"},"x-world":{"x-vrml":["vrm","vrml","wrl","flr","wrz","xaf","xof"]}};(()=>{const t={};for(let e in ee)if(ee.hasOwnProperty(e))for(let n in ee[e])if(ee[e].hasOwnProperty(n)){const i=ee[e][n];if("string"==typeof i)t[i]=e+"/"+n;else for(let s=0;s<i.length;s++)t[i[s]]=e+"/"+n}})();const ne=[];for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)1&e?e=e>>>1^3988292384:e>>>=1;ne[t]=e}const ie=class{constructor(t){this.crc=t||-1}append(t){let e=0|this.crc;for(let n=0,i=0|t.length;n<i;n++)e=e>>>8^ne[255&(e^t[n])];this.crc=e}get(){return~this.crc}},se={concat(t,e){if(0===t.length||0===e.length)return t.concat(e);const n=t[t.length-1],i=se.getPartial(n);return 32===i?t.concat(e):se._shiftRight(e,i,0|n,t.slice(0,t.length-1))},bitLength(t){const e=t.length;if(0===e)return 0;const n=t[e-1];return 32*(e-1)+se.getPartial(n)},clamp(t,e){if(32*t.length<e)return t;const n=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,n>0&&e&&(t[n-1]=se.partial(e,t[n-1]&2147483648>>e-1,1)),t},partial:(t,e,n)=>32===t?e:(n?0|e:e<<32-t)+1099511627776*t,getPartial:t=>Math.round(t/1099511627776)||32,_shiftRight(t,e,n,i){for(void 0===i&&(i=[]);e>=32;e-=32)i.push(n),n=0;if(0===e)return i.concat(t);for(let s=0;s<t.length;s++)i.push(n|t[s]>>>e),n=t[s]<<32-e;const s=t.length?t[t.length-1]:0,r=se.getPartial(s);return i.push(se.partial(e+r&31,e+r>32?n:i.pop(),1)),i}},re={bytes:{fromBits(t){const e=se.bitLength(t)/8,n=new Uint8Array(e);let i;for(let s=0;s<e;s++)0==(3&s)&&(i=t[s/4]),n[s]=i>>>24,i<<=8;return n},toBits(t){const e=[];let n,i=0;for(n=0;n<t.length;n++)i=i<<8|t[n],3==(3&n)&&(e.push(i),i=0);return 3&n&&e.push(se.partial(8*(3&n),i)),e}}},ae={sha1:function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()}};ae.sha1.prototype={blockSize:512,reset:function(){const t=this;return t._h=this._init.slice(0),t._buffer=[],t._length=0,t},update:function(t){const e=this;"string"==typeof t&&(t=re.utf8String.toBits(t));const n=e._buffer=se.concat(e._buffer,t),i=e._length,s=e._length=i+se.bitLength(t);if(s>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");const r=new Uint32Array(n);let a=0;for(let t=e.blockSize+i-(e.blockSize+i&e.blockSize-1);t<=s;t+=e.blockSize)e._block(r.subarray(16*a,16*(a+1))),a+=1;return n.splice(0,16*a),e},finalize:function(){const t=this;let e=t._buffer;const n=t._h;e=se.concat(e,[se.partial(1,1)]);for(let t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(t._length/4294967296)),e.push(0|t._length);e.length;)t._block(e.splice(0,16));return t.reset(),n},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,n,i){return t<=19?e&n|~e&i:t<=39?e^n^i:t<=59?e&n|e&i|n&i:t<=79?e^n^i:void 0},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){const e=this,n=e._h,i=Array(80);for(let e=0;e<16;e++)i[e]=t[e];let s=n[0],r=n[1],a=n[2],o=n[3],l=n[4];for(let t=0;t<=79;t++){t>=16&&(i[t]=e._S(1,i[t-3]^i[t-8]^i[t-14]^i[t-16]));const n=e._S(5,s)+e._f(t,r,a,o)+l+i[t]+e._key[Math.floor(t/20)]|0;l=o,o=a,a=e._S(30,r),r=s,s=n}n[0]=n[0]+s|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+l|0}};const oe=class{constructor(t){const e=this;e._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],e._tables[0][0][0]||e._precompute();const n=e._tables[0][4],i=e._tables[1],s=t.length;let r,a,o,l=1;if(4!==s&&6!==s&&8!==s)throw new Error("invalid aes key size");for(e._key=[a=t.slice(0),o=[]],r=s;r<4*s+28;r++){let t=a[r-1];(r%s==0||8===s&&r%s==4)&&(t=n[t>>>24]<<24^n[t>>16&255]<<16^n[t>>8&255]<<8^n[255&t],r%s==0&&(t=t<<8^t>>>24^l<<24,l=l<<1^283*(l>>7))),a[r]=a[r-s]^t}for(let t=0;r;t++,r--){const e=a[3&t?r:r-4];o[t]=r<=4||t<4?e:i[0][n[e>>>24]]^i[1][n[e>>16&255]]^i[2][n[e>>8&255]]^i[3][n[255&e]]}}encrypt(t){return this._crypt(t,0)}decrypt(t){return this._crypt(t,1)}_precompute(){const t=this._tables[0],e=this._tables[1],n=t[4],i=e[4],s=[],r=[];let a,o,l,d;for(let t=0;t<256;t++)r[(s[t]=t<<1^283*(t>>7))^t]=t;for(let c=a=0;!n[c];c^=o||1,a=r[a]||1){let r=a^a<<1^a<<2^a<<3^a<<4;r=r>>8^255&r^99,n[c]=r,i[r]=c,d=s[l=s[o=s[c]]];let h=16843009*d^65537*l^257*o^16843008*c,u=257*s[r]^16843008*r;for(let n=0;n<4;n++)t[n][c]=u=u<<24^u>>>8,e[n][r]=h=h<<24^h>>>8}for(let n=0;n<5;n++)t[n]=t[n].slice(0),e[n]=e[n].slice(0)}_crypt(t,e){if(4!==t.length)throw new Error("invalid aes block size");const n=this._key[e],i=n.length/4-2,s=[0,0,0,0],r=this._tables[e],a=r[0],o=r[1],l=r[2],d=r[3],c=r[4];let h,u,p,m=t[0]^n[0],f=t[e?3:1]^n[1],g=t[2]^n[2],b=t[e?1:3]^n[3],w=4;for(let t=0;t<i;t++)h=a[m>>>24]^o[f>>16&255]^l[g>>8&255]^d[255&b]^n[w],u=a[f>>>24]^o[g>>16&255]^l[b>>8&255]^d[255&m]^n[w+1],p=a[g>>>24]^o[b>>16&255]^l[m>>8&255]^d[255&f]^n[w+2],b=a[b>>>24]^o[m>>16&255]^l[f>>8&255]^d[255&g]^n[w+3],w+=4,m=h,f=u,g=p;for(let t=0;t<4;t++)s[e?3&-t:t]=c[m>>>24]<<24^c[f>>16&255]<<16^c[g>>8&255]<<8^c[255&b]^n[w++],h=m,m=f,f=g,g=b,b=h;return s}},le=class{constructor(t,e){this._prf=t,this._initIv=e,this._iv=e}reset(){this._iv=this._initIv}update(t){return this.calculate(this._prf,t,this._iv)}incWord(t){if(255==(t>>24&255)){let e=t>>16&255,n=t>>8&255,i=255&t;255===e?(e=0,255===n?(n=0,255===i?i=0:++i):++n):++e,t=0,t+=e<<16,t+=n<<8,t+=i}else t+=1<<24;return t}incCounter(t){0===(t[0]=this.incWord(t[0]))&&(t[1]=this.incWord(t[1]))}calculate(t,e,n){let i;if(!(i=e.length))return[];const s=se.bitLength(e);for(let s=0;s<i;s+=4){this.incCounter(n);const i=t.encrypt(n);e[s]^=i[0],e[s+1]^=i[1],e[s+2]^=i[2],e[s+3]^=i[3]}return se.clamp(e,s)}},de=class{constructor(t){const e=this,n=e._hash=ae.sha1,i=[[],[]],s=n.prototype.blockSize/32;e._baseHash=[new n,new n],t.length>s&&(t=n.hash(t));for(let e=0;e<s;e++)i[0][e]=909522486^t[e],i[1][e]=1549556828^t[e];e._baseHash[0].update(i[0]),e._baseHash[1].update(i[1]),e._resultHash=new n(e._baseHash[0])}reset(){const t=this;t._resultHash=new t._hash(t._baseHash[0]),t._updated=!1}update(t){this._updated=!0,this._resultHash.update(t)}digest(){const t=this,e=t._resultHash.finalize(),n=new t._hash(t._baseHash[1]).update(e).finalize();return t.reset(),n}},ce="Invalid pasword",he=16,ue={name:"PBKDF2"},pe=Object.assign({hash:{name:"HMAC"}},ue),me=Object.assign({iterations:1e3,hash:{name:"SHA-1"}},ue),fe=["deriveBits"],ge=[8,12,16],be=[16,24,32],we=10,xe=[0,0,0,0],ve=re.bytes,ye=oe,ke=le,_e=de;class Ae{constructor(t,e,n){Object.assign(this,{password:t,signed:e,strength:n-1,pendingInput:new Uint8Array(0)})}async append(t){const e=this;if(e.password){const n=Ee(t,0,ge[e.strength]+2);await async function(t,e,n){await Ie(t,n,Ee(e,0,ge[t.strength]));const i=Ee(e,ge[t.strength]),s=t.keys.passwordVerification;if(s[0]!=i[0]||s[1]!=i[1])throw new Error(ce)}(e,n,e.password),e.password=null,e.aesCtrGladman=new ke(new ye(e.keys.key),Array.from(xe)),e.hmac=new _e(e.keys.authentication),t=Ee(t,ge[e.strength]+2)}return Se(e,t,new Uint8Array(t.length-we-(t.length-we)%he),0,we,!0)}flush(){const t=this,e=t.pendingInput,n=Ee(e,0,e.length-we),i=Ee(e,e.length-we);let s=new Uint8Array(0);if(n.length){const e=ve.toBits(n);t.hmac.update(e);const i=t.aesCtrGladman.update(e);s=ve.fromBits(i)}let r=!0;if(t.signed){const e=Ee(ve.fromBits(t.hmac.digest()),0,we);for(let t=0;t<we;t++)e[t]!=i[t]&&(r=!1)}return{valid:r,data:s}}}class Ce{constructor(t,e){Object.assign(this,{password:t,strength:e-1,pendingInput:new Uint8Array(0)})}async append(t){const e=this;let n=new Uint8Array(0);e.password&&(n=await async function(t,e){const n=crypto.getRandomValues(new Uint8Array(ge[t.strength]));return await Ie(t,e,n),Ve(n,t.keys.passwordVerification)}(e,e.password),e.password=null,e.aesCtrGladman=new ke(new ye(e.keys.key),Array.from(xe)),e.hmac=new _e(e.keys.authentication));const i=new Uint8Array(n.length+t.length-t.length%he);return i.set(n,0),Se(e,t,i,n.length,0)}flush(){const t=this;let e=new Uint8Array(0);if(t.pendingInput.length){const n=t.aesCtrGladman.update(ve.toBits(t.pendingInput));t.hmac.update(n),e=ve.fromBits(n)}const n=Ee(ve.fromBits(t.hmac.digest()),0,we);return{data:Ve(e,n),signature:n}}}function Se(t,e,n,i,s,r){const a=e.length-s;let o;for(t.pendingInput.length&&(e=Ve(t.pendingInput,e),n=function(t,e){if(e&&e>t.length){const n=t;(t=new Uint8Array(e)).set(n,0)}return t}(n,a-a%he)),o=0;o<=a-he;o+=he){const s=ve.toBits(Ee(e,o,o+he));r&&t.hmac.update(s);const a=t.aesCtrGladman.update(s);r||t.hmac.update(a),n.set(ve.fromBits(a),o+i)}return t.pendingInput=Ee(e,o),n}async function Ie(t,e,n){const i=(new TextEncoder).encode(e),s=await crypto.subtle.importKey("raw",i,pe,!1,fe),r=await crypto.subtle.deriveBits(Object.assign({salt:n},me),s,8*(2*be[t.strength]+2)),a=new Uint8Array(r);t.keys={key:ve.toBits(Ee(a,0,be[t.strength])),authentication:ve.toBits(Ee(a,be[t.strength],2*be[t.strength])),passwordVerification:Ee(a,2*be[t.strength])}}function Ve(t,e){let n=t;return t.length+e.length&&(n=new Uint8Array(t.length+e.length),n.set(t,0),n.set(e,t.length)),n}function Ee(t,e,n){return t.subarray(e,n)}class $e{constructor(t,e){Object.assign(this,{password:t,passwordVerification:e}),De(this,t)}append(t){const e=this;if(e.password){const n=Le(e,t.subarray(0,12));if(e.password=null,n[11]!=e.passwordVerification)throw new Error(ce);t=t.subarray(12)}return Le(e,t)}flush(){return{valid:!0,data:new Uint8Array(0)}}}class Te{constructor(t,e){Object.assign(this,{password:t,passwordVerification:e}),De(this,t)}append(t){const e=this;let n,i;if(e.password){e.password=null;const s=crypto.getRandomValues(new Uint8Array(12));s[11]=e.passwordVerification,n=new Uint8Array(t.length+s.length),n.set(Be(e,s),0),i=12}else n=new Uint8Array(t.length),i=0;return n.set(Be(e,t),i),n}flush(){return{data:new Uint8Array(0)}}}function Le(t,e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=Ne(t)^e[i],Me(t,n[i]);return n}function Be(t,e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=Ne(t)^e[i],Me(t,e[i]);return n}function De(t,e){t.keys=[305419896,591751049,878082192],t.crcKey0=new ie(t.keys[0]),t.crcKey2=new ie(t.keys[2]);for(let n=0;n<e.length;n++)Me(t,e.charCodeAt(n))}function Me(t,e){t.crcKey0.append([e]),t.keys[0]=~t.crcKey0.get(),t.keys[1]=ze(t.keys[1]+Oe(t.keys[0])),t.keys[1]=ze(Math.imul(t.keys[1],134775813)+1),t.crcKey2.append([t.keys[1]>>>24]),t.keys[2]=~t.crcKey2.get()}function Ne(t){const e=2|t.keys[2];return Oe(Math.imul(e,1^e)>>>8)}function Oe(t){return 255&t}function ze(t){return 4294967295&t}const Ue="deflate",Fe="inflate",Re="Invalid signature";class Pe{constructor(t,{signature:e,password:n,signed:i,compressed:s,zipCrypto:r,passwordVerification:a,encryptionStrength:o},{chunkSize:l}){const d=Boolean(n);Object.assign(this,{signature:e,encrypted:d,signed:i,compressed:s,inflate:s&&new t({chunkSize:l}),crc32:i&&new ie,zipCrypto:r,decrypt:d&&r?new $e(n,a):new Ae(n,i,o)})}async append(t){const e=this;return e.encrypted&&t.length&&(t=await e.decrypt.append(t)),e.compressed&&t.length&&(t=await e.inflate.append(t)),(!e.encrypted||e.zipCrypto)&&e.signed&&t.length&&e.crc32.append(t),t}async flush(){const t=this;let e,n=new Uint8Array(0);if(t.encrypted){const e=t.decrypt.flush();if(!e.valid)throw new Error(Re);n=e.data}if((!t.encrypted||t.zipCrypto)&&t.signed){const n=new DataView(new Uint8Array(4).buffer);if(e=t.crc32.get(),n.setUint32(0,e),t.signature!=n.getUint32(0,!1))throw new Error(Re)}return t.compressed&&(n=await t.inflate.append(n)||new Uint8Array(0),await t.inflate.flush()),{data:n,signature:e}}}class je{constructor(t,{encrypted:e,signed:n,compressed:i,level:s,zipCrypto:r,password:a,passwordVerification:o,encryptionStrength:l},{chunkSize:d}){Object.assign(this,{encrypted:e,signed:n,compressed:i,deflate:i&&new t({level:s||5,chunkSize:d}),crc32:n&&new ie,zipCrypto:r,encrypt:e&&r?new Te(a,o):new Ce(a,l)})}async append(t){const e=this;let n=t;return e.compressed&&t.length&&(n=await e.deflate.append(t)),e.encrypted&&n.length&&(n=await e.encrypt.append(n)),(!e.encrypted||e.zipCrypto)&&e.signed&&t.length&&e.crc32.append(t),n}async flush(){const t=this;let e,n=new Uint8Array(0);if(t.compressed&&(n=await t.deflate.flush()||new Uint8Array(0)),t.encrypted){n=await t.encrypt.append(n);const i=t.encrypt.flush();e=i.signature;const s=new Uint8Array(n.length+i.data.length);s.set(n,0),s.set(i.data,n.length),n=s}return t.encrypted&&!t.zipCrypto||!t.signed||(e=t.crc32.get()),{data:n,signature:e}}}const qe="init",We="append",He="flush";let Ke=!0;const Ze=(t,e,n,i,s,r,a)=>(Object.assign(t,{busy:!0,codecConstructor:e,options:Object.assign({},n),scripts:a,terminate(){t.worker&&!t.busy&&(t.worker.terminate(),t.interface=null)},onTaskFinished(){t.busy=!1,s(t)}}),r?function(t,e){let n;const i={type:"module"};if(!t.interface){if(Ke)try{t.worker=s()}catch(e){Ke=!1,t.worker=s(i)}else t.worker=s(i);t.worker.addEventListener("message",(function(e){const i=e.data;if(n){const e=i.error,s=i.type;if(e){const i=new Error(e.message);i.stack=e.stack,n.reject(i),n=null,t.onTaskFinished()}else if(s==qe||s==He||s==We){const e=i.data;s==He?(n.resolve({data:new Uint8Array(e),signature:i.signature}),n=null,t.onTaskFinished()):n.resolve(e&&new Uint8Array(e))}}}),!1),t.interface={append:t=>r({type:We,data:t}),flush:()=>r({type:He})}}return t.interface;function s(e={}){return new Worker(new URL(t.scripts[0],"file:///C:/Users/Will/Dropbox/Projects/0x40-web/node_modules/@zip.js/zip.js/lib/core/codecs/codec-pool-worker.js"),e)}async function r(i){if(!n){const n=t.options,i=t.scripts.slice(1);await a({scripts:i,type:qe,options:n,config:{chunkSize:e.chunkSize}})}return a(i)}function a(e){const i=t.worker,s=new Promise(((t,e)=>n={resolve:t,reject:e}));try{if(e.data)try{e.data=e.data.buffer,i.postMessage(e,[e.data])}catch(t){i.postMessage(e)}else i.postMessage(e)}catch(e){n.reject(e),n=null,t.onTaskFinished()}return s}}(t,i):function(t,e){const n=function(t,e,n){return e.codecType.startsWith(Ue)?new je(t,e,n):e.codecType.startsWith(Fe)?new Pe(t,e,n):void 0}(t.codecConstructor,t.options,e);return{async append(e){try{return await n.append(e)}catch(e){throw t.onTaskFinished(),e}},async flush(){try{return await n.flush()}finally{t.onTaskFinished()}}}}(t,i));let Qe=[],Xe=[];function Ge(t,e,n){const i=!(!e.compressed&&!e.signed&&!e.encrypted)&&(e.useWebWorkers||void 0===e.useWebWorkers&&n.useWebWorkers),s=i&&n.workerScripts?n.workerScripts[e.codecType]:[];if(Qe.length<n.maxWorkers){const a={};return Qe.push(a),Ze(a,t,e,n,r,i,s)}{const a=Qe.find((t=>!t.busy));return a?(Je(a),Ze(a,t,e,n,r,i,s)):new Promise((n=>Xe.push({resolve:n,codecConstructor:t,options:e,webWorker:i,scripts:s})))}function r(t){if(Xe.length){const[{resolve:e,codecConstructor:i,options:s,webWorker:a,scripts:o}]=Xe.splice(0,1);e(Ze(t,i,s,n,r,a,o))}else t.worker?(Je(t),Number.isFinite(n.terminateWorkerTimeout)&&n.terminateWorkerTimeout>=0&&(t.terminateTimeout=setTimeout((()=>{Qe=Qe.filter((e=>e!=t)),t.terminate()}),n.terminateWorkerTimeout))):Qe=Qe.filter((e=>e!=t))}}function Je(t){t.terminateTimeout&&(clearTimeout(t.terminateTimeout),t.terminateTimeout=null)}const Ye="text/plain";class tn{constructor(){this.size=0}init(){this.initialized=!0}}class en extends tn{}class nn extends tn{writeUint8Array(t){this.size+=t.length}}class sn extends en{constructor(t){super(),this.blobReader=new on(new Blob([t],{type:Ye}))}async init(){super.init(),this.blobReader.init(),this.size=this.blobReader.size}async readUint8Array(t,e){return this.blobReader.readUint8Array(t,e)}}class rn extends nn{constructor(t){super(),this.encoding=t,this.blob=new Blob([],{type:Ye})}async writeUint8Array(t){super.writeUint8Array(t),this.blob=new Blob([this.blob,t.buffer],{type:Ye})}getData(){if(this.blob.text)return this.blob.text();{const t=new FileReader;return new Promise(((e,n)=>{t.onload=t=>e(t.target.result),t.onerror=()=>n(t.error),t.readAsText(this.blob,this.encoding)}))}}}class an extends nn{constructor(t){super(),this.data="data:"+(t||"")+";base64,",this.pending=[]}async writeUint8Array(t){super.writeUint8Array(t);let e=0,n=this.pending;const i=this.pending.length;for(this.pending="",e=0;e<3*Math.floor((i+t.length)/3)-i;e++)n+=String.fromCharCode(t[e]);for(;e<t.length;e++)this.pending+=String.fromCharCode(t[e]);n.length>2?this.data+=btoa(n):this.pending=n}getData(){return this.data+btoa(this.pending)}}class on extends en{constructor(t){super(),this.blob=t,this.size=t.size}async readUint8Array(t,e){if(this.blob.arrayBuffer)return new Uint8Array(await this.blob.slice(t,t+e).arrayBuffer());{const n=new FileReader;return new Promise(((i,s)=>{n.onload=t=>i(new Uint8Array(t.target.result)),n.onerror=()=>s(n.error),n.readAsArrayBuffer(this.blob.slice(t,t+e))}))}}}class ln extends nn{constructor(t){super(),this.contentType=t,this.arrayBuffers=[]}async writeUint8Array(t){super.writeUint8Array(t),this.arrayBuffers.push(t.buffer)}getData(){return this.blob||(this.blob=new Blob(this.arrayBuffers,{type:this.contentType})),this.blob}}class dn extends en{constructor(t){super(),this.array=t,this.size=t.length}async readUint8Array(t,e){return this.array.slice(t,t+e)}}class cn extends nn{constructor(){super(),this.array=new Uint8Array(0)}async writeUint8Array(t){super.writeUint8Array(t);const e=this.array;this.array=new Uint8Array(e.length+t.length),this.array.set(e),this.array.set(t,e.length)}getData(){return this.array}}const hn=4294967295,un=65535,pn=67324752,mn=33639248,fn=101010256,gn=101075792,bn=117853008,wn=21589,xn=2048,vn="/",yn=new Date(2107,11,31),kn=new Date(1980,0,1),_n="\0☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ ".split("");async function An(t,e,n,i,s,r,a){const o=Math.max(r.chunkSize,64);return async function r(l=0,d=0){const c=a.signal;if(l<s){Cn(c,t);const h=await e.readUint8Array(l+i,Math.min(o,s-l)),u=h.length;Cn(c,t);const p=await t.append(h);if(Cn(c,t),d+=await Sn(n,p),a.onprogress)try{a.onprogress(l+u,s)}catch(t){}return r(l+o,d)}{const e=await t.flush();return d+=await Sn(n,e.data),{signature:e.signature,length:d}}}()}function Cn(t,e){if(t&&t.aborted)throw e.flush(),new Error("Abort error")}async function Sn(t,e){return e.length&&await t.writeUint8Array(e),e.length}const In=["filename","rawFilename","directory","encrypted","compressedSize","uncompressedSize","lastModDate","rawLastModDate","comment","rawComment","signature","extraField","rawExtraField","bitFlag","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","filenameUTF8","commentUTF8","offset","zip64","compressionMethod","extraFieldNTFS","lastAccessDate","creationDate","extraFieldExtendedTimestamp","version","versionMadeBy","msDosCompatible","internalFileAttribute","externalFileAttribute"];class Vn{constructor(t){In.forEach((e=>this[e]=t[e]))}}const En="File format is not recognized",$n="Compression method not supported",Tn="utf-8",Ln=["uncompressedSize","compressedSize","offset"];class Bn{constructor(t,e={}){Object.assign(this,{reader:t,options:e,config:Yt()})}async getEntries(t={}){const e=this,n=e.reader;if(n.initialized||await n.init(),n.size<22)throw new Error(En);const i=await async function(t,e,n,i,s){const r=new Uint8Array(4);!function(t,e,n){t.setUint32(0,101010256,!0)}(Hn(r));return await a(22)||await a(Math.min(1048582,n));async function a(e){const i=n-e,s=await Kn(t,i,e);for(let t=s.length-22;t>=0;t--)if(s[t]==r[0]&&s[t+1]==r[1]&&s[t+2]==r[2]&&s[t+3]==r[3])return{offset:i+t,buffer:s.slice(t,t+22).buffer}}}(n,0,n.size);if(!i)throw new Error("End of central directory not found");const s=Hn(i);let r=qn(s,12),a=qn(s,16),o=jn(s,8),l=0;if(a==hn||r==hn||o==un){const t=Hn(await Kn(n,i.offset-20,20));if(qn(t,0)!=bn)throw new Error("End of Zip64 central directory not found");a=Wn(t,8);let e=await Kn(n,a,56),s=Hn(e);const d=i.offset-20-56;if(qn(s,0)!=gn&&a!=d){const t=a;a=d,l=a-t,e=await Kn(n,a,56),s=Hn(e)}if(qn(s,0)!=gn)throw new Error("End of Zip64 central directory locator not found");o=Wn(s,32),r=Wn(s,40),a-=r}if(a<0||a>=n.size)throw new Error(En);let d=0,c=await Kn(n,a,r),h=Hn(c);const u=i.offset-r;if(qn(h,d)!=mn&&a!=u){const t=a;a=u,l=a-t,c=await Kn(n,a,r),h=Hn(c)}if(a<0||a>=n.size)throw new Error(En);const p=[];for(let i=0;i<o;i++){const s=new Dn(n,e.config,e.options);if(qn(h,d)!=mn)throw new Error("Central directory header not found");Mn(s,h,d+6);const r=Boolean(s.bitFlag.languageEncodingFlag),a=d+46,u=a+s.filenameLength,m=u+s.extraFieldLength,f=jn(h,d+4),g=0==(0&f);Object.assign(s,{versionMadeBy:f,msDosCompatible:g,compressedSize:0,uncompressedSize:0,commentLength:jn(h,d+32),directory:g&&16==(16&Pn(h,d+38)),offset:qn(h,d+42)+l,internalFileAttribute:qn(h,d+34),externalFileAttribute:qn(h,d+38),rawFilename:c.subarray(a,u),filenameUTF8:r,commentUTF8:r,rawExtraField:c.subarray(u,m)});const b=m+s.commentLength;s.rawComment=c.subarray(m,b),s.filename=Un(s.rawFilename,s.filenameUTF8?Tn:zn(e,t,"filenameEncoding")),s.comment=Un(s.rawComment,s.commentUTF8?Tn:zn(e,t,"commentEncoding")),!s.directory&&s.filename.endsWith(vn)&&(s.directory=!0),Nn(s,s,h,d+6);const w=new Vn(s);if(w.getData=(t,e)=>s.getData(t,w,e),p.push(w),d=b,t.onprogress)try{t.onprogress(i+1,o,new Vn(s))}catch(t){}}return p}async close(){}}class Dn{constructor(t,e,n){Object.assign(this,{reader:t,config:e,options:n})}async getData(t,e,n={}){const i=this,{reader:s,offset:r,extraFieldAES:a,compressionMethod:o,config:l,bitFlag:d,signature:c,rawLastModDate:h,compressedSize:u}=i,p=i.localDirectory={};s.initialized||await s.init();let m=await Kn(s,r,30);const f=Hn(m);let g=zn(i,n,"password");if(g=g&&g.length&&g,a&&99!=a.originalCompressionMethod)throw new Error($n);if(0!=o&&8!=o)throw new Error($n);if(qn(f,0)!=pn)throw new Error("Local file header not found");Mn(p,f,4),m=await Kn(s,r,30+p.filenameLength+p.extraFieldLength),p.rawExtraField=m.subarray(30+p.filenameLength),Nn(i,p,f,4),e.lastAccessDate=p.lastAccessDate,e.creationDate=p.creationDate;const b=i.encrypted&&p.encrypted,w=b&&!a;if(b){if(!w&&void 0===a.strength)throw new Error("Encryption method not supported");if(!g)throw new Error("File contains encrypted entry")}const x=await Ge(l.Inflate,{codecType:Fe,password:g,zipCrypto:w,encryptionStrength:a&&a.strength,signed:zn(i,n,"checkSignature"),passwordVerification:w&&(d.dataDescriptor?h>>>8&255:c>>>24&255),signature:c,compressed:0!=o,encrypted:b,useWebWorkers:zn(i,n,"useWebWorkers")},l);t.initialized||await t.init();const v=zn(i,n,"signal"),y=r+30+p.filenameLength+p.extraFieldLength;return await An(x,s,t,y,u,l,{onprogress:n.onprogress,signal:v}),t.getData()}}function Mn(t,e,n){const i=t.rawBitFlag=jn(e,n+2),s=1==(1&i),r=qn(e,n+6);Object.assign(t,{encrypted:s,version:jn(e,n),bitFlag:{level:(6&i)>>1,dataDescriptor:8==(8&i),languageEncodingFlag:(i&xn)==xn},rawLastModDate:r,lastModDate:Fn(r),filenameLength:jn(e,n+22),extraFieldLength:jn(e,n+24)})}function Nn(t,e,n,i){const s=e.rawExtraField,r=e.extraField=new Map,a=Hn(new Uint8Array(s));let o=0;try{for(;o<s.length;){const t=jn(a,o),e=jn(a,o+2);r.set(t,{type:t,data:s.slice(o+4,o+4+e)}),o+=4+e}}catch(t){}const l=jn(n,i+4);e.signature=qn(n,i+10),e.uncompressedSize=qn(n,i+18),e.compressedSize=qn(n,i+14);const d=r.get(1);d&&(function(t,e){e.zip64=!0;const n=Hn(t.data);t.values=[];for(let e=0;e<Math.floor(t.data.length/8);e++)t.values.push(Wn(n,0+8*e));const i=Ln.filter((t=>e[t]==hn));for(let e=0;e<i.length;e++)t[i[e]]=t.values[e];Ln.forEach((n=>{if(e[n]==hn){if(void 0===t[n])throw new Error("Zip64 extra field not found");e[n]=t[n]}}))}(d,e),e.extraFieldZip64=d);const c=r.get(28789);c&&(On(c,"filename","rawFilename",e,t),e.extraFieldUnicodePath=c);const h=r.get(25461);h&&(On(h,"comment","rawComment",e,t),e.extraFieldUnicodeComment=h);const u=r.get(39169);u?(function(t,e,n){const i=Hn(t.data);t.vendorVersion=Pn(i,0),t.vendorId=Pn(i,2);const s=Pn(i,4);t.strength=s,t.originalCompressionMethod=n,e.compressionMethod=t.compressionMethod=jn(i,5)}(u,e,l),e.extraFieldAES=u):e.compressionMethod=l;const p=r.get(10);p&&(function(t,e){const n=Hn(t.data);let i,s=4;try{for(;s<t.data.length&&!i;){const e=jn(n,s),r=jn(n,s+2);1==e&&(i=t.data.slice(s+4,s+4+r)),s+=4+r}}catch(t){}try{if(i&&24==i.length){const n=Hn(i),s=n.getBigUint64(0,!0),r=n.getBigUint64(8,!0),a=n.getBigUint64(16,!0);Object.assign(t,{rawLastModDate:s,rawLastAccessDate:r,rawCreationDate:a});const o=Rn(s),l={lastModDate:o,lastAccessDate:Rn(r),creationDate:Rn(a)};Object.assign(t,l),Object.assign(e,l)}}catch(t){}}(p,e),e.extraFieldNTFS=p);const m=r.get(wn);m&&(function(t,e){const n=Hn(t.data),i=Pn(n,0),s=[],r=[];1==(1&i)&&(s.push("lastModDate"),r.push("rawLastModDate")),2==(2&i)&&(s.push("lastAccessDate"),r.push("rawLastAccessDate")),4==(4&i)&&(s.push("creationDate"),r.push("rawCreationDate"));let a=1;s.forEach(((i,s)=>{if(t.data.length>=a+4){const o=qn(n,a);e[i]=t[i]=new Date(1e3*o);const l=r[s];t[l]=o}a+=4}))}(m,e),e.extraFieldExtendedTimestamp=m)}function On(t,e,n,i,s){const r=Hn(t.data);t.version=Pn(r,0),t.signature=qn(r,1);const a=new ie;a.append(s[n]);const o=Hn(new Uint8Array(4));o.setUint32(0,a.get(),!0),t[e]=(new TextDecoder).decode(t.data.subarray(5)),t.valid=!s.bitFlag.languageEncodingFlag&&t.signature==qn(o,0),t.valid&&(i[e]=t[e],i[e+"UTF8"]=!0)}function zn(t,e,n){return void 0===e[n]?t.options[n]:e[n]}function Un(t,e){return e&&"cp437"!=e.trim().toLowerCase()?new TextDecoder(e).decode(t):(t=>{let e="";for(let n=0;n<t.length;n++)e+=_n[t[n]];return e})(t)}function Fn(t){const e=(4294901760&t)>>16,n=65535&t;try{return new Date(1980+((65024&e)>>9),((480&e)>>5)-1,31&e,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(t){}}function Rn(t){return new Date(Number(t/BigInt(1e4)-BigInt(116444736e5)))}function Pn(t,e){return t.getUint8(e)}function jn(t,e){return t.getUint16(e,!0)}function qn(t,e){return t.getUint32(e,!0)}function Wn(t,e){return Number(t.getBigUint64(e,!0))}function Hn(t){return new DataView(t.buffer)}function Kn(t,e,n){return t.readUint8Array(e,n)}const Zn="Version exceeds 65535",Qn="Zip64 is not supported",Xn=new Uint8Array([7,0,2,0,65,69,3,0,0]);let Gn=0;class Jn{constructor(t,e={}){Object.assign(this,{writer:t,options:e,config:Yt(),files:new Map,offset:t.size,pendingCompressedSize:0,pendingEntries:[]})}async add(t="",e,n={}){const i=this;if(!(Gn<i.config.maxWorkers))return new Promise(((s,r)=>i.pendingEntries.push({name:t,reader:e,options:n,resolve:s,reject:r})));Gn++;try{return await async function(t,e,n,i){if(e=e.trim(),i.directory&&!e.endsWith(vn)?e+=vn:i.directory=e.endsWith(vn),t.files.has(e))throw new Error("File already exists");const s=(new TextEncoder).encode(e);if(s.length>un)throw new Error("File entry name exceeds 64KB");const r=i.comment||"",a=(new TextEncoder).encode(r);if(a.length>un)throw new Error("File entry comment exceeds 64KB");const o=t.options.version||i.version||0;if(o>un)throw new Error(Zn);const l=t.options.versionMadeBy||i.versionMadeBy||20;if(l>un)throw new Error(Zn);const d=ei(t,i,"lastModDate")||new Date,c=ei(t,i,"lastAccessDate"),h=ei(t,i,"creationDate"),u=ei(t,i,"password"),p=ei(t,i,"encryptionStrength")||3,m=ei(t,i,"zipCrypto");if(void 0!==u&&void 0!==p&&(p<1||p>3))throw new Error("The strength must equal 1, 2, or 3");let f=new Uint8Array(0);const g=i.extraField;if(g){let t=0,e=0;g.forEach((e=>t+=4+e.length)),f=new Uint8Array(t),g.forEach(((t,n)=>{if(n>un)throw new Error("Extra field type exceeds 65535");if(t.length>un)throw new Error("Extra field data exceeds 64KB");ai(f,new Uint16Array([n]),e),ai(f,new Uint16Array([t.length]),e+2),ai(f,t,e+4),e+=4+t.length}))}let b=ei(t,i,"extendedTimestamp");void 0===b&&(b=!0);let w=0,x=ei(t,i,"keepOrder");void 0===x&&(x=!0);let v=0,y=ei(t,i,"msDosCompatible");void 0===y&&(y=!0);const k=ei(t,i,"internalFileAttribute")||0,_=ei(t,i,"externalFileAttribute")||0;n&&(n.initialized||await n.init(),v=n.size,w=function(t){return t+5*(Math.floor(t/16383)+1)}(v));let A=i.zip64||t.options.zip64||!1;if(t.offset+t.pendingCompressedSize>=hn||v>=hn||w>=hn){if(!1===i.zip64||!1===t.options.zip64||!x)throw new Error(Qn);A=!0}t.pendingCompressedSize+=w,await Promise.resolve();const C=ei(t,i,"level"),S=ei(t,i,"useWebWorkers"),I=ei(t,i,"bufferedWrite");let V=ei(t,i,"dataDescriptor"),E=ei(t,i,"dataDescriptorSignature");const $=ei(t,i,"signal");void 0===V&&(V=!0),V&&void 0===E&&(E=!0);const T=await async function(t,e,n,i){const s=t.files,r=t.writer,a=Array.from(s.values()).pop();let o,l,d,c={};s.set(e,c);try{let h,u,p;if(i.keepOrder&&(h=a&&a.lock),c.lock=p=new Promise((t=>d=t)),i.bufferedWrite||t.lockWrite||!i.dataDescriptor?(u=new ln,u.init(),o=!0):(t.lockWrite=new Promise((t=>l=t)),r.initialized||await r.init(),u=r),c=await async function(t,e,n,i){const{rawFilename:s,lastAccessDate:r,creationDate:a,password:o,level:l,zip64:d,zipCrypto:c,dataDescriptor:h,dataDescriptorSignature:u,directory:p,version:m,versionMadeBy:f,rawComment:g,rawExtraField:b,useWebWorkers:w,onprogress:x,signal:v,encryptionStrength:y,extendedTimestamp:k,msDosCompatible:_,internalFileAttribute:A,externalFileAttribute:C}=i,S=Boolean(o&&o.length),I=0!==l&&!p;let V,E,$;if(S&&!c){V=new Uint8Array(Xn.length+2);const t=oi(V);ii(t,0,39169),ai(V,Xn,2),ni(t,8,y)}else V=new Uint8Array(0);if(k){$=new Uint8Array(9+(r?4:0)+(a?4:0));const t=oi($);ii(t,0,wn),ii(t,2,$.length-4),ni(t,4,1+(r?2:0)+(a?4:0)),si(t,5,Math.floor(i.lastModDate.getTime()/1e3)),r&&si(t,9,Math.floor(r.getTime()/1e3)),a&&si(t,13,Math.floor(a.getTime()/1e3));try{E=new Uint8Array(36);const t=oi(E),e=ti(i.lastModDate);ii(t,0,10),ii(t,2,32),ii(t,8,1),ii(t,10,24),ri(t,12,e),ri(t,20,ti(r)||e),ri(t,28,ti(a)||e)}catch(t){E=new Uint8Array(0)}}else E=$=new Uint8Array(0);const T={version:m||20,versionMadeBy:f,zip64:d,directory:Boolean(p),filenameUTF8:!0,rawFilename:s,commentUTF8:!0,rawComment:g,rawExtraFieldZip64:d?new Uint8Array(28):new Uint8Array(0),rawExtraFieldExtendedTimestamp:$,rawExtraFieldNTFS:E,rawExtraFieldAES:V,rawExtraField:b,extendedTimestamp:k,msDosCompatible:_,internalFileAttribute:A,externalFileAttribute:C};let L=T.uncompressedSize=0,B=xn;h&&(B|=8);let D=0;I&&(D=8),d&&(T.version=T.version>45?T.version:45),S&&(B|=1,c||(T.version=T.version>51?T.version:51,D=99,I&&(T.rawExtraFieldAES[9]=8))),T.compressionMethod=D;const M=T.headerArray=new Uint8Array(26),N=oi(M);ii(N,0,T.version),ii(N,2,B),ii(N,4,D);const O=new Uint32Array(1),z=oi(O);let U;U=i.lastModDate<kn?kn:i.lastModDate>yn?yn:i.lastModDate,ii(z,0,(U.getHours()<<6|U.getMinutes())<<5|U.getSeconds()/2),ii(z,2,(U.getFullYear()-1980<<4|U.getMonth()+1)<<5|U.getDate());const F=O[0];si(N,6,F),ii(N,22,s.length);const R=V.length+$.length+E.length+T.rawExtraField.length;ii(N,24,R);const P=new Uint8Array(30+s.length+R);let j;si(oi(P),0,pn),ai(P,M,4),ai(P,s,30),ai(P,V,30+s.length),ai(P,$,30+s.length+V.length),ai(P,E,30+s.length+V.length+$.length),ai(P,T.rawExtraField,30+s.length+V.length+$.length+E.length);let q=0;if(t){L=T.uncompressedSize=t.size;const i=await Ge(n.Deflate,{codecType:Ue,level:l,password:o,encryptionStrength:y,zipCrypto:S&&c,passwordVerification:S&&c&&F>>8&255,signed:!0,compressed:I,encrypted:S,useWebWorkers:w},n);await e.writeUint8Array(P),T.dataWritten=!0,j=await An(i,t,e,0,L,n,{onprogress:x,signal:v}),q=j.length}else await e.writeUint8Array(P),T.dataWritten=!0;let W,H=new Uint8Array(0),K=0;if(h&&(H=new Uint8Array(d?u?24:20:u?16:12),W=oi(H),u&&(K=4,si(W,0,134695760))),t){const t=j.signature;if(S&&!c||void 0===t||(si(N,10,t),T.signature=t,h&&si(W,K,t)),d){const t=oi(T.rawExtraFieldZip64);ii(t,0,1),ii(t,2,24),si(N,14,hn),ri(t,12,BigInt(q)),si(N,18,hn),ri(t,4,BigInt(L)),h&&(ri(W,K+4,BigInt(q)),ri(W,K+12,BigInt(L)))}else si(N,14,q),si(N,18,L),h&&(si(W,K+4,q),si(W,K+8,L))}h&&await e.writeUint8Array(H);const Z=P.length+q+H.length;return Object.assign(T,{compressedSize:q,lastModDate:U,rawLastModDate:F,creationDate:a,lastAccessDate:r,encrypted:S,length:Z}),T}(n,u,t.config,i),c.lock=p,s.set(e,c),c.filename=e,o){let e=0;const n=u.getData();let a;await Promise.all([t.lockWrite,h]);do{a=Array.from(s.values()).find((t=>t.writingBufferedData)),a&&await a.lock}while(a&&a.lock);if(c.writingBufferedData=!0,!i.dataDescriptor){const t=26,s=await Yn(n,0,t),a=new DataView(s);c.encrypted&&!i.zipCrypto||si(a,14,c.signature),c.zip64?(si(a,18,hn),si(a,22,hn)):(si(a,18,c.compressedSize),si(a,22,c.uncompressedSize)),await r.writeUint8Array(new Uint8Array(s)),e=t}await async function(t,e,n=0){const i=536870912;await async function s(){if(n<e.size){const r=await Yn(e,n,n+i);await t.writeUint8Array(new Uint8Array(r)),n+=i,await s()}}()}(r,n,e),delete c.writingBufferedData}if(c.offset=t.offset,c.zip64)ri(oi(c.rawExtraFieldZip64),20,BigInt(c.offset));else if(c.offset>=hn)throw new Error(Qn);return t.offset+=c.length,c}catch(n){throw(o&&c.writingBufferedData||!o&&c.dataWritten)&&(n.corruptedEntry=t.hasCorruptedEntries=!0,c.uncompressedSize&&(t.offset+=c.uncompressedSize)),s.delete(e),n}finally{d(),l&&l()}}(t,e,n,Object.assign({},i,{rawFilename:s,rawComment:a,version:o,versionMadeBy:l,lastModDate:d,lastAccessDate:c,creationDate:h,rawExtraField:f,zip64:A,password:u,level:C,useWebWorkers:S,encryptionStrength:p,extendedTimestamp:b,zipCrypto:m,bufferedWrite:I,keepOrder:x,dataDescriptor:V,dataDescriptorSignature:E,signal:$,msDosCompatible:y,internalFileAttribute:k,externalFileAttribute:_}));return w&&(t.pendingCompressedSize-=w),Object.assign(T,{name:e,comment:r,extraField:g}),new Vn(T)}(i,t,e,n)}finally{Gn--;const t=i.pendingEntries.shift();t&&i.add(t.name,t.reader,t.options).then(t.resolve).catch(t.reject)}}async close(t=new Uint8Array(0),e={}){return await async function(t,e,n){const i=t.writer,s=t.files;let r=0,a=0,o=t.offset,l=s.size;for(const[,t]of s)a+=46+t.rawFilename.length+t.rawComment.length+t.rawExtraFieldZip64.length+t.rawExtraFieldAES.length+t.rawExtraFieldExtendedTimestamp.length+t.rawExtraFieldNTFS.length+t.rawExtraField.length;let d=n.zip64||t.options.zip64||!1;if(o>=hn||a>=hn||l>=un){if(!1===n.zip64||!1===t.options.zip64)throw new Error(Qn);d=!0}const c=new Uint8Array(a+(d?98:22)),h=oi(c);if(e&&e.length){if(!(e.length<=un))throw new Error("Zip file comment exceeds 64KB");ii(h,r+20,e.length)}for(const[t,e]of Array.from(s.values()).entries()){const{rawFilename:i,rawExtraFieldZip64:a,rawExtraFieldAES:o,rawExtraField:l,rawComment:d,versionMadeBy:u,headerArray:p,directory:m,zip64:f,msDosCompatible:g,internalFileAttribute:b,externalFileAttribute:w}=e;let x,v;if(e.extendedTimestamp){v=e.rawExtraFieldNTFS,x=new Uint8Array(9);const t=oi(x);ii(t,0,wn),ii(t,2,x.length-4),ni(t,4,1),si(t,5,Math.floor(e.lastModDate.getTime()/1e3))}else v=x=new Uint8Array(0);const y=a.length+o.length+x.length+v.length+l.length;if(si(h,r,mn),ii(h,r+4,u),ai(c,p,r+6),ii(h,r+30,y),ii(h,r+32,d.length),si(h,r+34,b),w?si(h,r+38,w):m&&g&&ni(h,r+38,16),si(h,r+42,f?hn:e.offset),ai(c,i,r+46),ai(c,a,r+46+i.length),ai(c,o,r+46+i.length+a.length),ai(c,x,r+46+i.length+a.length+o.length),ai(c,v,r+46+i.length+a.length+o.length+x.length),ai(c,l,r+46+i.length+a.length+o.length+x.length+v.length),ai(c,d,r+46+i.length+y),r+=46+i.length+y+d.length,n.onprogress)try{n.onprogress(t+1,s.size,new Vn(e))}catch(t){}}d&&(si(h,r,gn),ri(h,r+4,BigInt(44)),ii(h,r+12,45),ii(h,r+14,45),ri(h,r+24,BigInt(l)),ri(h,r+32,BigInt(l)),ri(h,r+40,BigInt(a)),ri(h,r+48,BigInt(o)),si(h,r+56,bn),ri(h,r+64,BigInt(o)+BigInt(a)),si(h,r+72,1),l=un,o=hn,a=hn,r+=76),si(h,r,fn),ii(h,r+8,l),ii(h,r+10,l),si(h,r+12,a),si(h,r+16,o),await i.writeUint8Array(c),e&&e.length&&await i.writeUint8Array(e)}(this,t,e),this.writer.getData()}}function Yn(t,e,n){if(t.arrayBuffer)return e||n?t.slice(e,n).arrayBuffer():t.arrayBuffer();{const i=new FileReader;return new Promise(((s,r)=>{i.onload=t=>s(t.target.result),i.onerror=()=>r(i.error),i.readAsArrayBuffer(e||n?t.slice(e,n):t)}))}}function ti(t){if(t)return(BigInt(t.getTime())+BigInt(116444736e5))*BigInt(1e4)}function ei(t,e,n){return void 0===e[n]?t.options[n]:e[n]}function ni(t,e,n){t.setUint8(e,n)}function ii(t,e,n){t.setUint16(e,n,!0)}function si(t,e,n){t.setUint32(e,n,!0)}function ri(t,e,n){t.setBigUint64(e,n,!0)}function ai(t,e,n){t.set(e,n)}function oi(t){return new DataView(t.buffer)}(()=>{if("function"==typeof URL.createObjectURL){const t='\n\t\t\t\n\nconst t=[];for(let e=0;e<256;e++){let n=e;for(let t=0;t<8;t++)1&n?n=n>>>1^3988292384:n>>>=1;t[e]=n;}class e{constructor(t){this.crc=t||-1;}append(e){let n=0|this.crc;for(let i=0,a=0|e.length;i<a;i++)n=n>>>8^t[255&(n^e[i])];this.crc=n;}get(){return ~this.crc}}const n={concat(t,e){if(0===t.length||0===e.length)return t.concat(e);const i=t[t.length-1],a=n.getPartial(i);return 32===a?t.concat(e):n._shiftRight(e,a,0|i,t.slice(0,t.length-1))},bitLength(t){const e=t.length;if(0===e)return 0;const i=t[e-1];return 32*(e-1)+n.getPartial(i)},clamp(t,e){if(32*t.length<e)return t;const i=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,i>0&&e&&(t[i-1]=n.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:(t,e,n)=>32===t?e:(n?0|e:e<<32-t)+1099511627776*t,getPartial:t=>Math.round(t/1099511627776)||32,_shiftRight(t,e,i,a){for(void 0===a&&(a=[]);e>=32;e-=32)a.push(i),i=0;if(0===e)return a.concat(t);for(let n=0;n<t.length;n++)a.push(i|t[n]>>>e),i=t[n]<<32-e;const r=t.length?t[t.length-1]:0,s=n.getPartial(r);return a.push(n.partial(e+s&31,e+s>32?i:a.pop(),1)),a}},i={bytes:{fromBits(t){const e=n.bitLength(t)/8,i=new Uint8Array(e);let a;for(let n=0;n<e;n++)0==(3&n)&&(a=t[n/4]),i[n]=a>>>24,a<<=8;return i},toBits(t){const e=[];let i,a=0;for(i=0;i<t.length;i++)a=a<<8|t[i],3==(3&i)&&(e.push(a),a=0);return 3&i&&e.push(n.partial(8*(3&i),a)),e}}},a={sha1:function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset();}};a.sha1.prototype={blockSize:512,reset:function(){const t=this;return t._h=this._init.slice(0),t._buffer=[],t._length=0,t},update:function(t){const e=this;"string"==typeof t&&(t=i.utf8String.toBits(t));const a=e._buffer=n.concat(e._buffer,t),r=e._length,s=e._length=r+n.bitLength(t);if(s>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");const o=new Uint32Array(a);let l=0;for(let t=e.blockSize+r-(e.blockSize+r&e.blockSize-1);t<=s;t+=e.blockSize)e._block(o.subarray(16*l,16*(l+1))),l+=1;return a.splice(0,16*l),e},finalize:function(){const t=this;let e=t._buffer;const i=t._h;e=n.concat(e,[n.partial(1,1)]);for(let t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(t._length/4294967296)),e.push(0|t._length);e.length;)t._block(e.splice(0,16));return t.reset(),i},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,e,n,i){return t<=19?e&n|~e&i:t<=39?e^n^i:t<=59?e&n|e&i|n&i:t<=79?e^n^i:void 0},_S:function(t,e){return e<<t|e>>>32-t},_block:function(t){const e=this,n=e._h,i=Array(80);for(let e=0;e<16;e++)i[e]=t[e];let a=n[0],r=n[1],s=n[2],o=n[3],l=n[4];for(let t=0;t<=79;t++){t>=16&&(i[t]=e._S(1,i[t-3]^i[t-8]^i[t-14]^i[t-16]));const n=e._S(5,a)+e._f(t,r,s,o)+l+i[t]+e._key[Math.floor(t/20)]|0;l=o,o=s,s=e._S(30,r),r=a,a=n;}n[0]=n[0]+a|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+l|0;}};const r={aes:class{constructor(t){const e=this;e._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],e._tables[0][0][0]||e._precompute();const n=e._tables[0][4],i=e._tables[1],a=t.length;let r,s,o,l=1;if(4!==a&&6!==a&&8!==a)throw new Error("invalid aes key size");for(e._key=[s=t.slice(0),o=[]],r=a;r<4*a+28;r++){let t=s[r-1];(r%a==0||8===a&&r%a==4)&&(t=n[t>>>24]<<24^n[t>>16&255]<<16^n[t>>8&255]<<8^n[255&t],r%a==0&&(t=t<<8^t>>>24^l<<24,l=l<<1^283*(l>>7))),s[r]=s[r-a]^t;}for(let t=0;r;t++,r--){const e=s[3&t?r:r-4];o[t]=r<=4||t<4?e:i[0][n[e>>>24]]^i[1][n[e>>16&255]]^i[2][n[e>>8&255]]^i[3][n[255&e]];}}encrypt(t){return this._crypt(t,0)}decrypt(t){return this._crypt(t,1)}_precompute(){const t=this._tables[0],e=this._tables[1],n=t[4],i=e[4],a=[],r=[];let s,o,l,_;for(let t=0;t<256;t++)r[(a[t]=t<<1^283*(t>>7))^t]=t;for(let d=s=0;!n[d];d^=o||1,s=r[s]||1){let r=s^s<<1^s<<2^s<<3^s<<4;r=r>>8^255&r^99,n[d]=r,i[r]=d,_=a[l=a[o=a[d]]];let c=16843009*_^65537*l^257*o^16843008*d,f=257*a[r]^16843008*r;for(let n=0;n<4;n++)t[n][d]=f=f<<24^f>>>8,e[n][r]=c=c<<24^c>>>8;}for(let n=0;n<5;n++)t[n]=t[n].slice(0),e[n]=e[n].slice(0);}_crypt(t,e){if(4!==t.length)throw new Error("invalid aes block size");const n=this._key[e],i=n.length/4-2,a=[0,0,0,0],r=this._tables[e],s=r[0],o=r[1],l=r[2],_=r[3],d=r[4];let c,f,u,h=t[0]^n[0],b=t[e?3:1]^n[1],w=t[2]^n[2],p=t[e?1:3]^n[3],x=4;for(let t=0;t<i;t++)c=s[h>>>24]^o[b>>16&255]^l[w>>8&255]^_[255&p]^n[x],f=s[b>>>24]^o[w>>16&255]^l[p>>8&255]^_[255&h]^n[x+1],u=s[w>>>24]^o[p>>16&255]^l[h>>8&255]^_[255&b]^n[x+2],p=s[p>>>24]^o[h>>16&255]^l[b>>8&255]^_[255&w]^n[x+3],x+=4,h=c,b=f,w=u;for(let t=0;t<4;t++)a[e?3&-t:t]=d[h>>>24]<<24^d[b>>16&255]<<16^d[w>>8&255]<<8^d[255&p]^n[x++],c=h,h=b,b=w,w=p,p=c;return a}}},s={ctrGladman:class{constructor(t,e){this._prf=t,this._initIv=e,this._iv=e;}reset(){this._iv=this._initIv;}update(t){return this.calculate(this._prf,t,this._iv)}incWord(t){if(255==(t>>24&255)){let e=t>>16&255,n=t>>8&255,i=255&t;255===e?(e=0,255===n?(n=0,255===i?i=0:++i):++n):++e,t=0,t+=e<<16,t+=n<<8,t+=i;}else t+=1<<24;return t}incCounter(t){0===(t[0]=this.incWord(t[0]))&&(t[1]=this.incWord(t[1]));}calculate(t,e,i){let a;if(!(a=e.length))return [];const r=n.bitLength(e);for(let n=0;n<a;n+=4){this.incCounter(i);const a=t.encrypt(i);e[n]^=a[0],e[n+1]^=a[1],e[n+2]^=a[2],e[n+3]^=a[3];}return n.clamp(e,r)}}},o={hmacSha1:class{constructor(t){const e=this,n=e._hash=a.sha1,i=[[],[]],r=n.prototype.blockSize/32;e._baseHash=[new n,new n],t.length>r&&(t=n.hash(t));for(let e=0;e<r;e++)i[0][e]=909522486^t[e],i[1][e]=1549556828^t[e];e._baseHash[0].update(i[0]),e._baseHash[1].update(i[1]),e._resultHash=new n(e._baseHash[0]);}reset(){const t=this;t._resultHash=new t._hash(t._baseHash[0]),t._updated=!1;}update(t){this._updated=!0,this._resultHash.update(t);}digest(){const t=this,e=t._resultHash.finalize(),n=new t._hash(t._baseHash[1]).update(e).finalize();return t.reset(),n}}},l={name:"PBKDF2"},_=Object.assign({hash:{name:"HMAC"}},l),d=Object.assign({iterations:1e3,hash:{name:"SHA-1"}},l),c=["deriveBits"],f=[8,12,16],u=[16,24,32],h=[0,0,0,0],b=i.bytes,w=r.aes,p=s.ctrGladman,x=o.hmacSha1;class g{constructor(t,e,n){Object.assign(this,{password:t,signed:e,strength:n-1,pendingInput:new Uint8Array(0)});}async append(t){const e=this;if(e.password){const n=A(t,0,f[e.strength]+2);await async function(t,e,n){await k(t,n,A(e,0,f[t.strength]));const i=A(e,f[t.strength]),a=t.keys.passwordVerification;if(a[0]!=i[0]||a[1]!=i[1])throw new Error("Invalid pasword")}(e,n,e.password),e.password=null,e.aesCtrGladman=new p(new w(e.keys.key),Array.from(h)),e.hmac=new x(e.keys.authentication),t=A(t,f[e.strength]+2);}return m(e,t,new Uint8Array(t.length-10-(t.length-10)%16),0,10,!0)}flush(){const t=this,e=t.pendingInput,n=A(e,0,e.length-10),i=A(e,e.length-10);let a=new Uint8Array(0);if(n.length){const e=b.toBits(n);t.hmac.update(e);const i=t.aesCtrGladman.update(e);a=b.fromBits(i);}let r=!0;if(t.signed){const e=A(b.fromBits(t.hmac.digest()),0,10);for(let t=0;t<10;t++)e[t]!=i[t]&&(r=!1);}return {valid:r,data:a}}}class y{constructor(t,e){Object.assign(this,{password:t,strength:e-1,pendingInput:new Uint8Array(0)});}async append(t){const e=this;let n=new Uint8Array(0);e.password&&(n=await async function(t,e){const n=crypto.getRandomValues(new Uint8Array(f[t.strength]));return await k(t,e,n),v(n,t.keys.passwordVerification)}(e,e.password),e.password=null,e.aesCtrGladman=new p(new w(e.keys.key),Array.from(h)),e.hmac=new x(e.keys.authentication));const i=new Uint8Array(n.length+t.length-t.length%16);return i.set(n,0),m(e,t,i,n.length,0)}flush(){const t=this;let e=new Uint8Array(0);if(t.pendingInput.length){const n=t.aesCtrGladman.update(b.toBits(t.pendingInput));t.hmac.update(n),e=b.fromBits(n);}const n=A(b.fromBits(t.hmac.digest()),0,10);return {data:v(e,n),signature:n}}}function m(t,e,n,i,a,r){const s=e.length-a;let o;for(t.pendingInput.length&&(e=v(t.pendingInput,e),n=function(t,e){if(e&&e>t.length){const n=t;(t=new Uint8Array(e)).set(n,0);}return t}(n,s-s%16)),o=0;o<=s-16;o+=16){const a=b.toBits(A(e,o,o+16));r&&t.hmac.update(a);const s=t.aesCtrGladman.update(a);r||t.hmac.update(s),n.set(b.fromBits(s),o+i);}return t.pendingInput=A(e,o),n}async function k(t,e,n){const i=(new TextEncoder).encode(e),a=await crypto.subtle.importKey("raw",i,_,!1,c),r=await crypto.subtle.deriveBits(Object.assign({salt:n},d),a,8*(2*u[t.strength]+2)),s=new Uint8Array(r);t.keys={key:b.toBits(A(s,0,u[t.strength])),authentication:b.toBits(A(s,u[t.strength],2*u[t.strength])),passwordVerification:A(s,2*u[t.strength])};}function v(t,e){let n=t;return t.length+e.length&&(n=new Uint8Array(t.length+e.length),n.set(t,0),n.set(e,t.length)),n}function A(t,e,n){return t.subarray(e,n)}class U{constructor(t,e){Object.assign(this,{password:t,passwordVerification:e}),E(this,t);}append(t){const e=this;if(e.password){const n=z(e,t.subarray(0,12));if(e.password=null,n[11]!=e.passwordVerification)throw new Error("Invalid pasword");t=t.subarray(12);}return z(e,t)}flush(){return {valid:!0,data:new Uint8Array(0)}}}class S{constructor(t,e){Object.assign(this,{password:t,passwordVerification:e}),E(this,t);}append(t){const e=this;let n,i;if(e.password){e.password=null;const a=crypto.getRandomValues(new Uint8Array(12));a[11]=e.passwordVerification,n=new Uint8Array(t.length+a.length),n.set(I(e,a),0),i=12;}else n=new Uint8Array(t.length),i=0;return n.set(I(e,t),i),n}flush(){return {data:new Uint8Array(0)}}}function z(t,e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=M(t)^e[i],C(t,n[i]);return n}function I(t,e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=M(t)^e[i],C(t,e[i]);return n}function E(t,n){t.keys=[305419896,591751049,878082192],t.crcKey0=new e(t.keys[0]),t.crcKey2=new e(t.keys[2]);for(let e=0;e<n.length;e++)C(t,n.charCodeAt(e));}function C(t,e){t.crcKey0.append([e]),t.keys[0]=~t.crcKey0.get(),t.keys[1]=H(t.keys[1]+B(t.keys[0])),t.keys[1]=H(Math.imul(t.keys[1],134775813)+1),t.crcKey2.append([t.keys[1]>>>24]),t.keys[2]=~t.crcKey2.get();}function M(t){const e=2|t.keys[2];return B(Math.imul(e,1^e)>>>8)}function B(t){return 255&t}function H(t){return 4294967295&t}class V{constructor(t,{signature:n,password:i,signed:a,compressed:r,zipCrypto:s,passwordVerification:o,encryptionStrength:l},{chunkSize:_}){const d=Boolean(i);Object.assign(this,{signature:n,encrypted:d,signed:a,compressed:r,inflate:r&&new t({chunkSize:_}),crc32:a&&new e,zipCrypto:s,decrypt:d&&s?new U(i,o):new g(i,a,l)});}async append(t){const e=this;return e.encrypted&&t.length&&(t=await e.decrypt.append(t)),e.compressed&&t.length&&(t=await e.inflate.append(t)),(!e.encrypted||e.zipCrypto)&&e.signed&&t.length&&e.crc32.append(t),t}async flush(){const t=this;let e,n=new Uint8Array(0);if(t.encrypted){const e=t.decrypt.flush();if(!e.valid)throw new Error("Invalid signature");n=e.data;}if((!t.encrypted||t.zipCrypto)&&t.signed){const n=new DataView(new Uint8Array(4).buffer);if(e=t.crc32.get(),n.setUint32(0,e),t.signature!=n.getUint32(0,!1))throw new Error("Invalid signature")}return t.compressed&&(n=await t.inflate.append(n)||new Uint8Array(0),await t.inflate.flush()),{data:n,signature:e}}}class D{constructor(t,{encrypted:n,signed:i,compressed:a,level:r,zipCrypto:s,password:o,passwordVerification:l,encryptionStrength:_},{chunkSize:d}){Object.assign(this,{encrypted:n,signed:i,compressed:a,deflate:a&&new t({level:r||5,chunkSize:d}),crc32:i&&new e,zipCrypto:s,encrypt:n&&s?new S(o,l):new y(o,_)});}async append(t){const e=this;let n=t;return e.compressed&&t.length&&(n=await e.deflate.append(t)),e.encrypted&&n.length&&(n=await e.encrypt.append(n)),(!e.encrypted||e.zipCrypto)&&e.signed&&t.length&&e.crc32.append(t),n}async flush(){const t=this;let e,n=new Uint8Array(0);if(t.compressed&&(n=await t.deflate.flush()||new Uint8Array(0)),t.encrypted){n=await t.encrypt.append(n);const i=t.encrypt.flush();e=i.signature;const a=new Uint8Array(n.length+i.data.length);a.set(n,0),a.set(i.data,n.length),n=a;}return t.encrypted&&!t.zipCrypto||!t.signed||(e=t.crc32.get()),{data:n,signature:e}}}const j={init(t){t.scripts&&t.scripts.length&&importScripts.apply(void 0,t.scripts);const e=t.options;let n;self.initCodec&&self.initCodec(),e.codecType.startsWith("deflate")?n=self.Deflate:e.codecType.startsWith("inflate")&&(n=self.Inflate),O=function(t,e,n){return e.codecType.startsWith("deflate")?new D(t,e,n):e.codecType.startsWith("inflate")?new V(t,e,n):void 0}(n,e,t.config);},append:async t=>({data:await O.append(t.data)}),flush:()=>O.flush()};let O;addEventListener("message",(async t=>{const e=t.data,n=e.type,i=j[n];if(i)try{e.data&&(e.data=new Uint8Array(e.data));const t=await i(e)||{};if(t.type=n,t.data)try{t.data=t.data.buffer,postMessage(t,[t.data]);}catch(e){postMessage(t);}else postMessage(t);}catch(t){postMessage({type:n,error:{message:t.message,stack:t.stack}});}}));function P(t){return K(t.map((([t,e])=>new Array(t).fill(e,0,t))))}function K(t){return t.reduce(((t,e)=>t.concat(Array.isArray(e)?K(e):e)),[])}const G=[0,1,2,3].concat(...P([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function W(){const t=this;function e(t,e){let n=0;do{n|=1&t,t>>>=1,n<<=1;}while(--e>0);return n>>>1}t.build_tree=function(n){const i=t.dyn_tree,a=t.stat_desc.static_tree,r=t.stat_desc.elems;let s,o,l,_=-1;for(n.heap_len=0,n.heap_max=573,s=0;s<r;s++)0!==i[2*s]?(n.heap[++n.heap_len]=_=s,n.depth[s]=0):i[2*s+1]=0;for(;n.heap_len<2;)l=n.heap[++n.heap_len]=_<2?++_:0,i[2*l]=1,n.depth[l]=0,n.opt_len--,a&&(n.static_len-=a[2*l+1]);for(t.max_code=_,s=Math.floor(n.heap_len/2);s>=1;s--)n.pqdownheap(i,s);l=r;do{s=n.heap[1],n.heap[1]=n.heap[n.heap_len--],n.pqdownheap(i,1),o=n.heap[1],n.heap[--n.heap_max]=s,n.heap[--n.heap_max]=o,i[2*l]=i[2*s]+i[2*o],n.depth[l]=Math.max(n.depth[s],n.depth[o])+1,i[2*s+1]=i[2*o+1]=l,n.heap[1]=l++,n.pqdownheap(i,1);}while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],function(e){const n=t.dyn_tree,i=t.stat_desc.static_tree,a=t.stat_desc.extra_bits,r=t.stat_desc.extra_base,s=t.stat_desc.max_length;let o,l,_,d,c,f,u=0;for(d=0;d<=15;d++)e.bl_count[d]=0;for(n[2*e.heap[e.heap_max]+1]=0,o=e.heap_max+1;o<573;o++)l=e.heap[o],d=n[2*n[2*l+1]+1]+1,d>s&&(d=s,u++),n[2*l+1]=d,l>t.max_code||(e.bl_count[d]++,c=0,l>=r&&(c=a[l-r]),f=n[2*l],e.opt_len+=f*(d+c),i&&(e.static_len+=f*(i[2*l+1]+c)));if(0!==u){do{for(d=s-1;0===e.bl_count[d];)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[s]--,u-=2;}while(u>0);for(d=s;0!==d;d--)for(l=e.bl_count[d];0!==l;)_=e.heap[--o],_>t.max_code||(n[2*_+1]!=d&&(e.opt_len+=(d-n[2*_+1])*n[2*_],n[2*_+1]=d),l--);}}(n),function(t,n,i){const a=[];let r,s,o,l=0;for(r=1;r<=15;r++)a[r]=l=l+i[r-1]<<1;for(s=0;s<=n;s++)o=t[2*s+1],0!==o&&(t[2*s]=e(a[o]++,o));}(i,t.max_code,n.bl_count);};}function L(t,e,n,i,a){const r=this;r.static_tree=t,r.extra_bits=e,r.extra_base=n,r.elems=i,r.max_length=a;}W._length_code=[0,1,2,3,4,5,6,7].concat(...P([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),W.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],W.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],W.d_code=function(t){return t<256?G[t]:G[256+(t>>>7)]},W.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],W.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],W.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],W.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,8,99,8,227,8],L.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5],L.static_l_desc=new L(L.static_ltree,W.extra_lbits,257,286,15),L.static_d_desc=new L(L.static_dtree,W.extra_dbits,0,30,15),L.static_bl_desc=new L(null,W.extra_blbits,0,19,7);function T(t,e,n,i,a){const r=this;r.good_length=t,r.max_lazy=e,r.nice_length=n,r.max_chain=i,r.func=a;}const q=[new T(0,0,0,0,0),new T(4,4,8,4,1),new T(4,5,16,8,1),new T(4,6,32,32,1),new T(4,4,16,16,2),new T(8,16,32,32,2),new T(8,16,128,128,2),new T(8,32,128,256,2),new T(32,128,258,1024,2),new T(32,258,258,4096,2)],R=["need dictionary","stream end","","","stream error","data error","","buffer error","",""];function F(t,e,n,i){const a=t[2*e],r=t[2*n];return a<r||a==r&&i[e]<=i[n]}function J(){const t=this;let e,n,i,a,r,s,o,l,_,d,c,f,u,h,b,w,p,x,g,y,m,k,v,A,U,S,z,I,E,C,M,B,H;const V=new W,D=new W,j=new W;let O,P,K,G,T,J,N,Q;function X(){let e;for(e=0;e<286;e++)M[2*e]=0;for(e=0;e<30;e++)B[2*e]=0;for(e=0;e<19;e++)H[2*e]=0;M[512]=1,t.opt_len=t.static_len=0,K=T=0;}function Y(t,e){let n,i=-1,a=t[1],r=0,s=7,o=4;0===a&&(s=138,o=3),t[2*(e+1)+1]=65535;for(let l=0;l<=e;l++)n=a,a=t[2*(l+1)+1],++r<s&&n==a||(r<o?H[2*n]+=r:0!==n?(n!=i&&H[2*n]++,H[32]++):r<=10?H[34]++:H[36]++,r=0,i=n,0===a?(s=138,o=3):n==a?(s=6,o=3):(s=7,o=4));}function Z(e){t.pending_buf[t.pending++]=e;}function $(t){Z(255&t),Z(t>>>8&255);}function tt(t,e){let n;const i=e;Q>16-i?(n=t,N|=n<<Q&65535,$(N),N=n>>>16-Q,Q+=i-16):(N|=t<<Q&65535,Q+=i);}function et(t,e){const n=2*t;tt(65535&e[n],65535&e[n+1]);}function nt(t,e){let n,i,a=-1,r=t[1],s=0,o=7,l=4;for(0===r&&(o=138,l=3),n=0;n<=e;n++)if(i=r,r=t[2*(n+1)+1],!(++s<o&&i==r)){if(s<l)do{et(i,H);}while(0!=--s);else 0!==i?(i!=a&&(et(i,H),s--),et(16,H),tt(s-3,2)):s<=10?(et(17,H),tt(s-3,3)):(et(18,H),tt(s-11,7));s=0,a=i,0===r?(o=138,l=3):i==r?(o=6,l=3):(o=7,l=4);}}function it(){16==Q?($(N),N=0,Q=0):Q>=8&&(Z(255&N),N>>>=8,Q-=8);}function at(e,n){let i,a,r;if(t.pending_buf[G+2*K]=e>>>8&255,t.pending_buf[G+2*K+1]=255&e,t.pending_buf[O+K]=255&n,K++,0===e?M[2*n]++:(T++,e--,M[2*(W._length_code[n]+256+1)]++,B[2*W.d_code(e)]++),0==(8191&K)&&z>2){for(i=8*K,a=m-p,r=0;r<30;r++)i+=B[2*r]*(5+W.extra_dbits[r]);if(i>>>=3,T<Math.floor(K/2)&&i<Math.floor(a/2))return !0}return K==P-1}function rt(e,n){let i,a,r,s,o=0;if(0!==K)do{i=t.pending_buf[G+2*o]<<8&65280|255&t.pending_buf[G+2*o+1],a=255&t.pending_buf[O+o],o++,0===i?et(a,e):(r=W._length_code[a],et(r+256+1,e),s=W.extra_lbits[r],0!==s&&(a-=W.base_length[r],tt(a,s)),i--,r=W.d_code(i),et(r,n),s=W.extra_dbits[r],0!==s&&(i-=W.base_dist[r],tt(i,s)));}while(o<K);et(256,e),J=e[513];}function st(){Q>8?$(N):Q>0&&Z(255&N),N=0,Q=0;}function ot(e,n,i){tt(0+(i?1:0),3),function(e,n,i){st(),J=8,i&&($(n),$(~n)),t.pending_buf.set(l.subarray(e,e+n),t.pending),t.pending+=n;}(e,n,!0);}function lt(e,n,i){let a,r,s=0;z>0?(V.build_tree(t),D.build_tree(t),s=function(){let e;for(Y(M,V.max_code),Y(B,D.max_code),j.build_tree(t),e=18;e>=3&&0===H[2*W.bl_order[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(),a=t.opt_len+3+7>>>3,r=t.static_len+3+7>>>3,r<=a&&(a=r)):a=r=n+5,n+4<=a&&-1!=e?ot(e,n,i):r==a?(tt(2+(i?1:0),3),rt(L.static_ltree,L.static_dtree)):(tt(4+(i?1:0),3),function(t,e,n){let i;for(tt(t-257,5),tt(e-1,5),tt(n-4,4),i=0;i<n;i++)tt(H[2*W.bl_order[i]+1],3);nt(M,t-1),nt(B,e-1);}(V.max_code+1,D.max_code+1,s+1),rt(M,B)),X(),i&&st();}function _t(t){lt(p>=0?p:-1,m-p,t),p=m,e.flush_pending();}function dt(){let t,n,i,a;do{if(a=_-v-m,0===a&&0===m&&0===v)a=r;else if(-1==a)a--;else if(m>=r+r-262){l.set(l.subarray(r,r+r),0),k-=r,m-=r,p-=r,t=u,i=t;do{n=65535&c[--i],c[i]=n>=r?n-r:0;}while(0!=--t);t=r,i=t;do{n=65535&d[--i],d[i]=n>=r?n-r:0;}while(0!=--t);a+=r;}if(0===e.avail_in)return;t=e.read_buf(l,m+v,a),v+=t,v>=3&&(f=255&l[m],f=(f<<w^255&l[m+1])&b);}while(v<262&&0!==e.avail_in)}function ct(t){let e,n,i=U,a=m,s=A;const _=m>r-262?m-(r-262):0;let c=C;const f=o,u=m+258;let h=l[a+s-1],b=l[a+s];A>=E&&(i>>=2),c>v&&(c=v);do{if(e=t,l[e+s]==b&&l[e+s-1]==h&&l[e]==l[a]&&l[++e]==l[a+1]){a+=2,e++;do{}while(l[++a]==l[++e]&&l[++a]==l[++e]&&l[++a]==l[++e]&&l[++a]==l[++e]&&l[++a]==l[++e]&&l[++a]==l[++e]&&l[++a]==l[++e]&&l[++a]==l[++e]&&a<u);if(n=258-(u-a),a=u-258,n>s){if(k=t,s=n,n>=c)break;h=l[a+s-1],b=l[a+s];}}}while((t=65535&d[t&f])>_&&0!=--i);return s<=v?s:v}function ft(e){return e.total_in=e.total_out=0,e.msg=null,t.pending=0,t.pending_out=0,n=113,a=0,V.dyn_tree=M,V.stat_desc=L.static_l_desc,D.dyn_tree=B,D.stat_desc=L.static_d_desc,j.dyn_tree=H,j.stat_desc=L.static_bl_desc,N=0,Q=0,J=8,X(),function(){_=2*r,c[u-1]=0;for(let t=0;t<u-1;t++)c[t]=0;S=q[z].max_lazy,E=q[z].good_length,C=q[z].nice_length,U=q[z].max_chain,m=0,p=0,v=0,x=A=2,y=0,f=0;}(),0}t.depth=[],t.bl_count=[],t.heap=[],M=[],B=[],H=[],t.pqdownheap=function(e,n){const i=t.heap,a=i[n];let r=n<<1;for(;r<=t.heap_len&&(r<t.heap_len&&F(e,i[r+1],i[r],t.depth)&&r++,!F(e,a,i[r],t.depth));)i[n]=i[r],n=r,r<<=1;i[n]=a;},t.deflateInit=function(e,n,a,_,f,p){return _||(_=8),f||(f=8),p||(p=0),e.msg=null,-1==n&&(n=6),f<1||f>9||8!=_||a<9||a>15||n<0||n>9||p<0||p>2?-2:(e.dstate=t,s=a,r=1<<s,o=r-1,h=f+7,u=1<<h,b=u-1,w=Math.floor((h+3-1)/3),l=new Uint8Array(2*r),d=[],c=[],P=1<<f+6,t.pending_buf=new Uint8Array(4*P),i=4*P,G=Math.floor(P/2),O=3*P,z=n,I=p,ft(e))},t.deflateEnd=function(){return 42!=n&&113!=n&&666!=n?-2:(t.pending_buf=null,c=null,d=null,l=null,t.dstate=null,113==n?-3:0)},t.deflateParams=function(t,e,n){let i=0;return -1==e&&(e=6),e<0||e>9||n<0||n>2?-2:(q[z].func!=q[e].func&&0!==t.total_in&&(i=t.deflate(1)),z!=e&&(z=e,S=q[z].max_lazy,E=q[z].good_length,C=q[z].nice_length,U=q[z].max_chain),I=n,i)},t.deflateSetDictionary=function(t,e,i){let a,s=i,_=0;if(!e||42!=n)return -2;if(s<3)return 0;for(s>r-262&&(s=r-262,_=i-s),l.set(e.subarray(_,_+s),0),m=s,p=s,f=255&l[0],f=(f<<w^255&l[1])&b,a=0;a<=s-3;a++)f=(f<<w^255&l[a+2])&b,d[a&o]=c[f],c[f]=a;return 0},t.deflate=function(_,h){let U,E,C,M,B;if(h>4||h<0)return -2;if(!_.next_out||!_.next_in&&0!==_.avail_in||666==n&&4!=h)return _.msg=R[4],-2;if(0===_.avail_out)return _.msg=R[7],-5;var H;if(e=_,M=a,a=h,42==n&&(E=8+(s-8<<4)<<8,C=(z-1&255)>>1,C>3&&(C=3),E|=C<<6,0!==m&&(E|=32),E+=31-E%31,n=113,Z((H=E)>>8&255),Z(255&H)),0!==t.pending){if(e.flush_pending(),0===e.avail_out)return a=-1,0}else if(0===e.avail_in&&h<=M&&4!=h)return e.msg=R[7],-5;if(666==n&&0!==e.avail_in)return _.msg=R[7],-5;if(0!==e.avail_in||0!==v||0!=h&&666!=n){switch(B=-1,q[z].func){case 0:B=function(t){let n,a=65535;for(a>i-5&&(a=i-5);;){if(v<=1){if(dt(),0===v&&0==t)return 0;if(0===v)break}if(m+=v,v=0,n=p+a,(0===m||m>=n)&&(v=m-n,m=n,_t(!1),0===e.avail_out))return 0;if(m-p>=r-262&&(_t(!1),0===e.avail_out))return 0}return _t(4==t),0===e.avail_out?4==t?2:0:4==t?3:1}(h);break;case 1:B=function(t){let n,i=0;for(;;){if(v<262){if(dt(),v<262&&0==t)return 0;if(0===v)break}if(v>=3&&(f=(f<<w^255&l[m+2])&b,i=65535&c[f],d[m&o]=c[f],c[f]=m),0!==i&&(m-i&65535)<=r-262&&2!=I&&(x=ct(i)),x>=3)if(n=at(m-k,x-3),v-=x,x<=S&&v>=3){x--;do{m++,f=(f<<w^255&l[m+2])&b,i=65535&c[f],d[m&o]=c[f],c[f]=m;}while(0!=--x);m++;}else m+=x,x=0,f=255&l[m],f=(f<<w^255&l[m+1])&b;else n=at(0,255&l[m]),v--,m++;if(n&&(_t(!1),0===e.avail_out))return 0}return _t(4==t),0===e.avail_out?4==t?2:0:4==t?3:1}(h);break;case 2:B=function(t){let n,i,a=0;for(;;){if(v<262){if(dt(),v<262&&0==t)return 0;if(0===v)break}if(v>=3&&(f=(f<<w^255&l[m+2])&b,a=65535&c[f],d[m&o]=c[f],c[f]=m),A=x,g=k,x=2,0!==a&&A<S&&(m-a&65535)<=r-262&&(2!=I&&(x=ct(a)),x<=5&&(1==I||3==x&&m-k>4096)&&(x=2)),A>=3&&x<=A){i=m+v-3,n=at(m-1-g,A-3),v-=A-1,A-=2;do{++m<=i&&(f=(f<<w^255&l[m+2])&b,a=65535&c[f],d[m&o]=c[f],c[f]=m);}while(0!=--A);if(y=0,x=2,m++,n&&(_t(!1),0===e.avail_out))return 0}else if(0!==y){if(n=at(0,255&l[m-1]),n&&_t(!1),m++,v--,0===e.avail_out)return 0}else y=1,m++,v--;}return 0!==y&&(n=at(0,255&l[m-1]),y=0),_t(4==t),0===e.avail_out?4==t?2:0:4==t?3:1}(h);}if(2!=B&&3!=B||(n=666),0==B||2==B)return 0===e.avail_out&&(a=-1),0;if(1==B){if(1==h)tt(2,3),et(256,L.static_ltree),it(),1+J+10-Q<9&&(tt(2,3),et(256,L.static_ltree),it()),J=7;else if(ot(0,0,!1),3==h)for(U=0;U<u;U++)c[U]=0;if(e.flush_pending(),0===e.avail_out)return a=-1,0}}return 4!=h?0:1};}function N(){const t=this;t.next_in_index=0,t.next_out_index=0,t.avail_in=0,t.total_in=0,t.avail_out=0,t.total_out=0;}function Q(t){const e=new N,n=(i=t&&t.chunkSize?t.chunkSize:65536)+5*(Math.floor(i/16383)+1);var i;const a=new Uint8Array(n);let r=t?t.level:-1;void 0===r&&(r=-1),e.deflateInit(r),e.next_out=a,this.append=function(t,i){let r,s,o=0,l=0,_=0;const d=[];if(t.length){e.next_in_index=0,e.next_in=t,e.avail_in=t.length;do{if(e.next_out_index=0,e.avail_out=n,r=e.deflate(0),0!=r)throw new Error("deflating: "+e.msg);e.next_out_index&&(e.next_out_index==n?d.push(new Uint8Array(a)):d.push(a.slice(0,e.next_out_index))),_+=e.next_out_index,i&&e.next_in_index>0&&e.next_in_index!=o&&(i(e.next_in_index),o=e.next_in_index);}while(e.avail_in>0||0===e.avail_out);return d.length>1?(s=new Uint8Array(_),d.forEach((function(t){s.set(t,l),l+=t.length;}))):s=d[0]||new Uint8Array(0),s}},this.flush=function(){let t,i,r=0,s=0;const o=[];do{if(e.next_out_index=0,e.avail_out=n,t=e.deflate(4),1!=t&&0!=t)throw new Error("deflating: "+e.msg);n-e.avail_out>0&&o.push(a.slice(0,e.next_out_index)),s+=e.next_out_index;}while(e.avail_in>0||0===e.avail_out);return e.deflateEnd(),i=new Uint8Array(s),o.forEach((function(t){i.set(t,r),r+=t.length;})),i};}N.prototype={deflateInit:function(t,e){const n=this;return n.dstate=new J,e||(e=15),n.dstate.deflateInit(n,t,e)},deflate:function(t){const e=this;return e.dstate?e.dstate.deflate(e,t):-2},deflateEnd:function(){const t=this;if(!t.dstate)return -2;const e=t.dstate.deflateEnd();return t.dstate=null,e},deflateParams:function(t,e){const n=this;return n.dstate?n.dstate.deflateParams(n,t,e):-2},deflateSetDictionary:function(t,e){const n=this;return n.dstate?n.dstate.deflateSetDictionary(n,t,e):-2},read_buf:function(t,e,n){const i=this;let a=i.avail_in;return a>n&&(a=n),0===a?0:(i.avail_in-=a,t.set(i.next_in.subarray(i.next_in_index,i.next_in_index+a),e),i.next_in_index+=a,i.total_in+=a,a)},flush_pending:function(){const t=this;let e=t.dstate.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.next_out.set(t.dstate.pending_buf.subarray(t.dstate.pending_out,t.dstate.pending_out+e),t.next_out_index),t.next_out_index+=e,t.dstate.pending_out+=e,t.total_out+=e,t.avail_out-=e,t.dstate.pending-=e,0===t.dstate.pending&&(t.dstate.pending_out=0));}};const X=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],Y=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],Z=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],$=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],tt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],et=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],nt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function it(){let t,e,n,i,a,r;function s(t,e,s,o,l,_,d,c,f,u,h){let b,w,p,x,g,y,m,k,v,A,U,S,z,I,E;A=0,g=s;do{n[t[e+A]]++,A++,g--;}while(0!==g);if(n[0]==s)return d[0]=-1,c[0]=0,0;for(k=c[0],y=1;y<=15&&0===n[y];y++);for(m=y,k<y&&(k=y),g=15;0!==g&&0===n[g];g--);for(p=g,k>g&&(k=g),c[0]=k,I=1<<y;y<g;y++,I<<=1)if((I-=n[y])<0)return -3;if((I-=n[g])<0)return -3;for(n[g]+=I,r[1]=y=0,A=1,z=2;0!=--g;)r[z]=y+=n[A],z++,A++;g=0,A=0;do{0!==(y=t[e+A])&&(h[r[y]++]=g),A++;}while(++g<s);for(s=r[p],r[0]=g=0,A=0,x=-1,S=-k,a[0]=0,U=0,E=0;m<=p;m++)for(b=n[m];0!=b--;){for(;m>S+k;){if(x++,S+=k,E=p-S,E=E>k?k:E,(w=1<<(y=m-S))>b+1&&(w-=b+1,z=m,y<E))for(;++y<E&&!((w<<=1)<=n[++z]);)w-=n[z];if(E=1<<y,u[0]+E>1440)return -3;a[x]=U=u[0],u[0]+=E,0!==x?(r[x]=g,i[0]=y,i[1]=k,y=g>>>S-k,i[2]=U-a[x-1]-y,f.set(i,3*(a[x-1]+y))):d[0]=U;}for(i[1]=m-S,A>=s?i[0]=192:h[A]<o?(i[0]=h[A]<256?0:96,i[2]=h[A++]):(i[0]=_[h[A]-o]+16+64,i[2]=l[h[A++]-o]),w=1<<m-S,y=g>>>S;y<E;y+=w)f.set(i,3*(U+y));for(y=1<<m-1;0!=(g&y);y>>>=1)g^=y;for(g^=y,v=(1<<S)-1;(g&v)!=r[x];)x--,S-=k,v=(1<<S)-1;}return 0!==I&&1!=p?-5:0}function o(s){let o;for(t||(t=[],e=[],n=new Int32Array(16),i=[],a=new Int32Array(15),r=new Int32Array(16)),e.length<s&&(e=[]),o=0;o<s;o++)e[o]=0;for(o=0;o<16;o++)n[o]=0;for(o=0;o<3;o++)i[o]=0;a.set(n.subarray(0,15),0),r.set(n.subarray(0,16),0);}this.inflate_trees_bits=function(n,i,a,r,l){let _;return o(19),t[0]=0,_=s(n,0,19,19,null,null,a,i,r,t,e),-3==_?l.msg="oversubscribed dynamic bit lengths tree":-5!=_&&0!==i[0]||(l.msg="incomplete dynamic bit lengths tree",_=-3),_},this.inflate_trees_dynamic=function(n,i,a,r,l,_,d,c,f){let u;return o(288),t[0]=0,u=s(a,0,n,257,$,tt,_,r,c,t,e),0!=u||0===r[0]?(-3==u?f.msg="oversubscribed literal/length tree":-4!=u&&(f.msg="incomplete literal/length tree",u=-3),u):(o(288),u=s(a,n,i,0,et,nt,d,l,c,t,e),0!=u||0===l[0]&&n>257?(-3==u?f.msg="oversubscribed distance tree":-5==u?(f.msg="incomplete distance tree",u=-3):-4!=u&&(f.msg="empty distance tree with lengths",u=-3),u):0)};}it.inflate_trees_fixed=function(t,e,n,i){return t[0]=9,e[0]=5,n[0]=Y,i[0]=Z,0};function at(){const t=this;let e,n,i,a,r=0,s=0,o=0,l=0,_=0,d=0,c=0,f=0,u=0,h=0;function b(t,e,n,i,a,r,s,o){let l,_,d,c,f,u,h,b,w,p,x,g,y,m,k,v;h=o.next_in_index,b=o.avail_in,f=s.bitb,u=s.bitk,w=s.write,p=w<s.read?s.read-w-1:s.end-w,x=X[t],g=X[e];do{for(;u<20;)b--,f|=(255&o.read_byte(h++))<<u,u+=8;if(l=f&x,_=n,d=i,v=3*(d+l),0!==(c=_[v]))for(;;){if(f>>=_[v+1],u-=_[v+1],0!=(16&c)){for(c&=15,y=_[v+2]+(f&X[c]),f>>=c,u-=c;u<15;)b--,f|=(255&o.read_byte(h++))<<u,u+=8;for(l=f&g,_=a,d=r,v=3*(d+l),c=_[v];;){if(f>>=_[v+1],u-=_[v+1],0!=(16&c)){for(c&=15;u<c;)b--,f|=(255&o.read_byte(h++))<<u,u+=8;if(m=_[v+2]+(f&X[c]),f>>=c,u-=c,p-=y,w>=m)k=w-m,w-k>0&&2>w-k?(s.window[w++]=s.window[k++],s.window[w++]=s.window[k++],y-=2):(s.window.set(s.window.subarray(k,k+2),w),w+=2,k+=2,y-=2);else {k=w-m;do{k+=s.end;}while(k<0);if(c=s.end-k,y>c){if(y-=c,w-k>0&&c>w-k)do{s.window[w++]=s.window[k++];}while(0!=--c);else s.window.set(s.window.subarray(k,k+c),w),w+=c,k+=c,c=0;k=0;}}if(w-k>0&&y>w-k)do{s.window[w++]=s.window[k++];}while(0!=--y);else s.window.set(s.window.subarray(k,k+y),w),w+=y,k+=y,y=0;break}if(0!=(64&c))return o.msg="invalid distance code",y=o.avail_in-b,y=u>>3<y?u>>3:y,b+=y,h-=y,u-=y<<3,s.bitb=f,s.bitk=u,o.avail_in=b,o.total_in+=h-o.next_in_index,o.next_in_index=h,s.write=w,-3;l+=_[v+2],l+=f&X[c],v=3*(d+l),c=_[v];}break}if(0!=(64&c))return 0!=(32&c)?(y=o.avail_in-b,y=u>>3<y?u>>3:y,b+=y,h-=y,u-=y<<3,s.bitb=f,s.bitk=u,o.avail_in=b,o.total_in+=h-o.next_in_index,o.next_in_index=h,s.write=w,1):(o.msg="invalid literal/length code",y=o.avail_in-b,y=u>>3<y?u>>3:y,b+=y,h-=y,u-=y<<3,s.bitb=f,s.bitk=u,o.avail_in=b,o.total_in+=h-o.next_in_index,o.next_in_index=h,s.write=w,-3);if(l+=_[v+2],l+=f&X[c],v=3*(d+l),0===(c=_[v])){f>>=_[v+1],u-=_[v+1],s.window[w++]=_[v+2],p--;break}}else f>>=_[v+1],u-=_[v+1],s.window[w++]=_[v+2],p--;}while(p>=258&&b>=10);return y=o.avail_in-b,y=u>>3<y?u>>3:y,b+=y,h-=y,u-=y<<3,s.bitb=f,s.bitk=u,o.avail_in=b,o.total_in+=h-o.next_in_index,o.next_in_index=h,s.write=w,0}t.init=function(t,r,s,o,l,_){e=0,c=t,f=r,i=s,u=o,a=l,h=_,n=null;},t.proc=function(t,w,p){let x,g,y,m,k,v,A,U=0,S=0,z=0;for(z=w.next_in_index,m=w.avail_in,U=t.bitb,S=t.bitk,k=t.write,v=k<t.read?t.read-k-1:t.end-k;;)switch(e){case 0:if(v>=258&&m>=10&&(t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,p=b(c,f,i,u,a,h,t,w),z=w.next_in_index,m=w.avail_in,U=t.bitb,S=t.bitk,k=t.write,v=k<t.read?t.read-k-1:t.end-k,0!=p)){e=1==p?7:9;break}o=c,n=i,s=u,e=1;case 1:for(x=o;S<x;){if(0===m)return t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);p=0,m--,U|=(255&w.read_byte(z++))<<S,S+=8;}if(g=3*(s+(U&X[x])),U>>>=n[g+1],S-=n[g+1],y=n[g],0===y){l=n[g+2],e=6;break}if(0!=(16&y)){_=15&y,r=n[g+2],e=2;break}if(0==(64&y)){o=y,s=g/3+n[g+2];break}if(0!=(32&y)){e=7;break}return e=9,w.msg="invalid literal/length code",p=-3,t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);case 2:for(x=_;S<x;){if(0===m)return t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);p=0,m--,U|=(255&w.read_byte(z++))<<S,S+=8;}r+=U&X[x],U>>=x,S-=x,o=f,n=a,s=h,e=3;case 3:for(x=o;S<x;){if(0===m)return t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);p=0,m--,U|=(255&w.read_byte(z++))<<S,S+=8;}if(g=3*(s+(U&X[x])),U>>=n[g+1],S-=n[g+1],y=n[g],0!=(16&y)){_=15&y,d=n[g+2],e=4;break}if(0==(64&y)){o=y,s=g/3+n[g+2];break}return e=9,w.msg="invalid distance code",p=-3,t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);case 4:for(x=_;S<x;){if(0===m)return t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);p=0,m--,U|=(255&w.read_byte(z++))<<S,S+=8;}d+=U&X[x],U>>=x,S-=x,e=5;case 5:for(A=k-d;A<0;)A+=t.end;for(;0!==r;){if(0===v&&(k==t.end&&0!==t.read&&(k=0,v=k<t.read?t.read-k-1:t.end-k),0===v&&(t.write=k,p=t.inflate_flush(w,p),k=t.write,v=k<t.read?t.read-k-1:t.end-k,k==t.end&&0!==t.read&&(k=0,v=k<t.read?t.read-k-1:t.end-k),0===v)))return t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);t.window[k++]=t.window[A++],v--,A==t.end&&(A=0),r--;}e=0;break;case 6:if(0===v&&(k==t.end&&0!==t.read&&(k=0,v=k<t.read?t.read-k-1:t.end-k),0===v&&(t.write=k,p=t.inflate_flush(w,p),k=t.write,v=k<t.read?t.read-k-1:t.end-k,k==t.end&&0!==t.read&&(k=0,v=k<t.read?t.read-k-1:t.end-k),0===v)))return t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);p=0,t.window[k++]=l,v--,e=0;break;case 7:if(S>7&&(S-=8,m++,z--),t.write=k,p=t.inflate_flush(w,p),k=t.write,v=k<t.read?t.read-k-1:t.end-k,t.read!=t.write)return t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);e=8;case 8:return p=1,t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);case 9:return p=-3,t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p);default:return p=-2,t.bitb=U,t.bitk=S,w.avail_in=m,w.total_in+=z-w.next_in_index,w.next_in_index=z,t.write=k,t.inflate_flush(w,p)}},t.free=function(){};}const rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function st(t,e){const n=this;let i,a=0,r=0,s=0,o=0;const l=[0],_=[0],d=new at;let c=0,f=new Int32Array(4320);const u=new it;n.bitk=0,n.bitb=0,n.window=new Uint8Array(e),n.end=e,n.read=0,n.write=0,n.reset=function(t,e){e&&(e[0]=0),6==a&&d.free(t),a=0,n.bitk=0,n.bitb=0,n.read=n.write=0;},n.reset(t,null),n.inflate_flush=function(t,e){let i,a,r;return a=t.next_out_index,r=n.read,i=(r<=n.write?n.write:n.end)-r,i>t.avail_out&&(i=t.avail_out),0!==i&&-5==e&&(e=0),t.avail_out-=i,t.total_out+=i,t.next_out.set(n.window.subarray(r,r+i),a),a+=i,r+=i,r==n.end&&(r=0,n.write==n.end&&(n.write=0),i=n.write-r,i>t.avail_out&&(i=t.avail_out),0!==i&&-5==e&&(e=0),t.avail_out-=i,t.total_out+=i,t.next_out.set(n.window.subarray(r,r+i),a),a+=i,r+=i),t.next_out_index=a,n.read=r,e},n.proc=function(t,e){let h,b,w,p,x,g,y,m;for(p=t.next_in_index,x=t.avail_in,b=n.bitb,w=n.bitk,g=n.write,y=g<n.read?n.read-g-1:n.end-g;;){let k,v,A,U,S,z,I,E;switch(a){case 0:for(;w<3;){if(0===x)return n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);e=0,x--,b|=(255&t.read_byte(p++))<<w,w+=8;}switch(h=7&b,c=1&h,h>>>1){case 0:b>>>=3,w-=3,h=7&w,b>>>=h,w-=h,a=1;break;case 1:k=[],v=[],A=[[]],U=[[]],it.inflate_trees_fixed(k,v,A,U),d.init(k[0],v[0],A[0],0,U[0],0),b>>>=3,w-=3,a=6;break;case 2:b>>>=3,w-=3,a=3;break;case 3:return b>>>=3,w-=3,a=9,t.msg="invalid block type",e=-3,n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e)}break;case 1:for(;w<32;){if(0===x)return n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);e=0,x--,b|=(255&t.read_byte(p++))<<w,w+=8;}if((~b>>>16&65535)!=(65535&b))return a=9,t.msg="invalid stored block lengths",e=-3,n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);r=65535&b,b=w=0,a=0!==r?2:0!==c?7:0;break;case 2:if(0===x)return n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);if(0===y&&(g==n.end&&0!==n.read&&(g=0,y=g<n.read?n.read-g-1:n.end-g),0===y&&(n.write=g,e=n.inflate_flush(t,e),g=n.write,y=g<n.read?n.read-g-1:n.end-g,g==n.end&&0!==n.read&&(g=0,y=g<n.read?n.read-g-1:n.end-g),0===y)))return n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);if(e=0,h=r,h>x&&(h=x),h>y&&(h=y),n.window.set(t.read_buf(p,h),g),p+=h,x-=h,g+=h,y-=h,0!=(r-=h))break;a=0!==c?7:0;break;case 3:for(;w<14;){if(0===x)return n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);e=0,x--,b|=(255&t.read_byte(p++))<<w,w+=8;}if(s=h=16383&b,(31&h)>29||(h>>5&31)>29)return a=9,t.msg="too many length or distance symbols",e=-3,n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);if(h=258+(31&h)+(h>>5&31),!i||i.length<h)i=[];else for(m=0;m<h;m++)i[m]=0;b>>>=14,w-=14,o=0,a=4;case 4:for(;o<4+(s>>>10);){for(;w<3;){if(0===x)return n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);e=0,x--,b|=(255&t.read_byte(p++))<<w,w+=8;}i[rt[o++]]=7&b,b>>>=3,w-=3;}for(;o<19;)i[rt[o++]]=0;if(l[0]=7,h=u.inflate_trees_bits(i,l,_,f,t),0!=h)return -3==(e=h)&&(i=null,a=9),n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);o=0,a=5;case 5:for(;h=s,!(o>=258+(31&h)+(h>>5&31));){let r,d;for(h=l[0];w<h;){if(0===x)return n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);e=0,x--,b|=(255&t.read_byte(p++))<<w,w+=8;}if(h=f[3*(_[0]+(b&X[h]))+1],d=f[3*(_[0]+(b&X[h]))+2],d<16)b>>>=h,w-=h,i[o++]=d;else {for(m=18==d?7:d-14,r=18==d?11:3;w<h+m;){if(0===x)return n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);e=0,x--,b|=(255&t.read_byte(p++))<<w,w+=8;}if(b>>>=h,w-=h,r+=b&X[m],b>>>=m,w-=m,m=o,h=s,m+r>258+(31&h)+(h>>5&31)||16==d&&m<1)return i=null,a=9,t.msg="invalid bit length repeat",e=-3,n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);d=16==d?i[m-1]:0;do{i[m++]=d;}while(0!=--r);o=m;}}if(_[0]=-1,S=[],z=[],I=[],E=[],S[0]=9,z[0]=6,h=s,h=u.inflate_trees_dynamic(257+(31&h),1+(h>>5&31),i,S,z,I,E,f,t),0!=h)return -3==h&&(i=null,a=9),e=h,n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);d.init(S[0],z[0],f,I[0],f,E[0]),a=6;case 6:if(n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,1!=(e=d.proc(n,t,e)))return n.inflate_flush(t,e);if(e=0,d.free(t),p=t.next_in_index,x=t.avail_in,b=n.bitb,w=n.bitk,g=n.write,y=g<n.read?n.read-g-1:n.end-g,0===c){a=0;break}a=7;case 7:if(n.write=g,e=n.inflate_flush(t,e),g=n.write,y=g<n.read?n.read-g-1:n.end-g,n.read!=n.write)return n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);a=8;case 8:return e=1,n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);case 9:return e=-3,n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e);default:return e=-2,n.bitb=b,n.bitk=w,t.avail_in=x,t.total_in+=p-t.next_in_index,t.next_in_index=p,n.write=g,n.inflate_flush(t,e)}}},n.free=function(t){n.reset(t,null),n.window=null,f=null;},n.set_dictionary=function(t,e,i){n.window.set(t.subarray(e,e+i),0),n.read=n.write=i;},n.sync_point=function(){return 1==a?1:0};}const ot=[0,0,255,255];function lt(){const t=this;function e(t){return t&&t.istate?(t.total_in=t.total_out=0,t.msg=null,t.istate.mode=7,t.istate.blocks.reset(t,null),0):-2}t.mode=0,t.method=0,t.was=[0],t.need=0,t.marker=0,t.wbits=0,t.inflateEnd=function(e){return t.blocks&&t.blocks.free(e),t.blocks=null,0},t.inflateInit=function(n,i){return n.msg=null,t.blocks=null,i<8||i>15?(t.inflateEnd(n),-2):(t.wbits=i,n.istate.blocks=new st(n,1<<i),e(n),0)},t.inflate=function(t,e){let n,i;if(!t||!t.istate||!t.next_in)return -2;const a=t.istate;for(e=4==e?-5:0,n=-5;;)switch(a.mode){case 0:if(0===t.avail_in)return n;if(n=e,t.avail_in--,t.total_in++,8!=(15&(a.method=t.read_byte(t.next_in_index++)))){a.mode=13,t.msg="unknown compression method",a.marker=5;break}if(8+(a.method>>4)>a.wbits){a.mode=13,t.msg="invalid window size",a.marker=5;break}a.mode=1;case 1:if(0===t.avail_in)return n;if(n=e,t.avail_in--,t.total_in++,i=255&t.read_byte(t.next_in_index++),((a.method<<8)+i)%31!=0){a.mode=13,t.msg="incorrect header check",a.marker=5;break}if(0==(32&i)){a.mode=7;break}a.mode=2;case 2:if(0===t.avail_in)return n;n=e,t.avail_in--,t.total_in++,a.need=(255&t.read_byte(t.next_in_index++))<<24&4278190080,a.mode=3;case 3:if(0===t.avail_in)return n;n=e,t.avail_in--,t.total_in++,a.need+=(255&t.read_byte(t.next_in_index++))<<16&16711680,a.mode=4;case 4:if(0===t.avail_in)return n;n=e,t.avail_in--,t.total_in++,a.need+=(255&t.read_byte(t.next_in_index++))<<8&65280,a.mode=5;case 5:return 0===t.avail_in?n:(n=e,t.avail_in--,t.total_in++,a.need+=255&t.read_byte(t.next_in_index++),a.mode=6,2);case 6:return a.mode=13,t.msg="need dictionary",a.marker=0,-2;case 7:if(n=a.blocks.proc(t,n),-3==n){a.mode=13,a.marker=0;break}if(0==n&&(n=e),1!=n)return n;n=e,a.blocks.reset(t,a.was),a.mode=12;case 12:return 1;case 13:return -3;default:return -2}},t.inflateSetDictionary=function(t,e,n){let i=0,a=n;if(!t||!t.istate||6!=t.istate.mode)return -2;const r=t.istate;return a>=1<<r.wbits&&(a=(1<<r.wbits)-1,i=n-a),r.blocks.set_dictionary(e,i,a),r.mode=7,0},t.inflateSync=function(t){let n,i,a,r,s;if(!t||!t.istate)return -2;const o=t.istate;if(13!=o.mode&&(o.mode=13,o.marker=0),0===(n=t.avail_in))return -5;for(i=t.next_in_index,a=o.marker;0!==n&&a<4;)t.read_byte(i)==ot[a]?a++:a=0!==t.read_byte(i)?0:4-a,i++,n--;return t.total_in+=i-t.next_in_index,t.next_in_index=i,t.avail_in=n,o.marker=a,4!=a?-3:(r=t.total_in,s=t.total_out,e(t),t.total_in=r,t.total_out=s,o.mode=7,0)},t.inflateSyncPoint=function(t){return t&&t.istate&&t.istate.blocks?t.istate.blocks.sync_point():-2};}function _t(){}function dt(t){const e=new _t,n=t&&t.chunkSize?Math.floor(2*t.chunkSize):131072,i=new Uint8Array(n);let a=!1;e.inflateInit(),e.next_out=i,this.append=function(t,r){const s=[];let o,l,_=0,d=0,c=0;if(0!==t.length){e.next_in_index=0,e.next_in=t,e.avail_in=t.length;do{if(e.next_out_index=0,e.avail_out=n,0!==e.avail_in||a||(e.next_in_index=0,a=!0),o=e.inflate(0),a&&-5===o){if(0!==e.avail_in)throw new Error("inflating: bad input")}else if(0!==o&&1!==o)throw new Error("inflating: "+e.msg);if((a||1===o)&&e.avail_in===t.length)throw new Error("inflating: bad input");e.next_out_index&&(e.next_out_index===n?s.push(new Uint8Array(i)):s.push(i.slice(0,e.next_out_index))),c+=e.next_out_index,r&&e.next_in_index>0&&e.next_in_index!=_&&(r(e.next_in_index),_=e.next_in_index);}while(e.avail_in>0||0===e.avail_out);return s.length>1?(l=new Uint8Array(c),s.forEach((function(t){l.set(t,d),d+=t.length;}))):l=s[0]||new Uint8Array(0),l}},this.flush=function(){e.inflateEnd();};}_t.prototype={inflateInit:function(t){const e=this;return e.istate=new lt,t||(t=15),e.istate.inflateInit(e,t)},inflate:function(t){const e=this;return e.istate?e.istate.inflate(e,t):-2},inflateEnd:function(){const t=this;if(!t.istate)return -2;const e=t.istate.inflateEnd(t);return t.istate=null,e},inflateSync:function(){const t=this;return t.istate?t.istate.inflateSync(t):-2},inflateSetDictionary:function(t,e){const n=this;return n.istate?n.istate.inflateSetDictionary(n,t,e):-2},read_byte:function(t){return this.next_in[t]},read_buf:function(t,e){return this.next_in.subarray(t,t+e)}},self.initCodec=()=>{self.Deflate=Q,self.Inflate=dt;};\n\n\t\t',e=URL.createObjectURL(new Blob([t],{type:"text/javascript"}));te({workerScripts:{inflate:[e],deflate:[e]}})}})(),te({Deflate:function(t){const e=new Lt,n=(i=t&&t.chunkSize?t.chunkSize:65536)+5*(Math.floor(i/16383)+1);var i;const s=new Uint8Array(n);let r=t?t.level:-1;void 0===r&&(r=-1),e.deflateInit(r),e.next_out=s,this.append=function(t,i){let r,a,o=0,l=0,d=0;const c=[];if(t.length){e.next_in_index=0,e.next_in=t,e.avail_in=t.length;do{if(e.next_out_index=0,e.avail_out=n,r=e.deflate(0),0!=r)throw new Error("deflating: "+e.msg);e.next_out_index&&(e.next_out_index==n?c.push(new Uint8Array(s)):c.push(s.slice(0,e.next_out_index))),d+=e.next_out_index,i&&e.next_in_index>0&&e.next_in_index!=o&&(i(e.next_in_index),o=e.next_in_index)}while(e.avail_in>0||0===e.avail_out);return c.length>1?(a=new Uint8Array(d),c.forEach((function(t){a.set(t,l),l+=t.length}))):a=c[0]||new Uint8Array(0),a}},this.flush=function(){let t,i,r=0,a=0;const o=[];do{if(e.next_out_index=0,e.avail_out=n,t=e.deflate(4),1!=t&&0!=t)throw new Error("deflating: "+e.msg);n-e.avail_out>0&&o.push(s.slice(0,e.next_out_index)),a+=e.next_out_index}while(e.avail_in>0||0===e.avail_out);return e.deflateEnd(),i=new Uint8Array(a),o.forEach((function(t){i.set(t,r),r+=t.length})),i}},Inflate:function(t){const e=new Xt,n=t&&t.chunkSize?Math.floor(2*t.chunkSize):131072,i=new Uint8Array(n);let s=!1;e.inflateInit(),e.next_out=i,this.append=function(t,r){const a=[];let o,l,d=0,c=0,h=0;if(0!==t.length){e.next_in_index=0,e.next_in=t,e.avail_in=t.length;do{if(e.next_out_index=0,e.avail_out=n,0!==e.avail_in||s||(e.next_in_index=0,s=!0),o=e.inflate(0),s&&o===Mt){if(0!==e.avail_in)throw new Error("inflating: bad input")}else if(0!==o&&1!==o)throw new Error("inflating: "+e.msg);if((s||1===o)&&e.avail_in===t.length)throw new Error("inflating: bad input");e.next_out_index&&(e.next_out_index===n?a.push(new Uint8Array(i)):a.push(i.slice(0,e.next_out_index))),h+=e.next_out_index,r&&e.next_in_index>0&&e.next_in_index!=d&&(r(e.next_in_index),d=e.next_in_index)}while(e.avail_in>0||0===e.avail_out);return a.length>1?(l=new Uint8Array(h),a.forEach((function(t){l.set(t,c),c+=t.length}))):l=a[0]||new Uint8Array(0),l}},this.flush=function(){e.inflateEnd()}}});class li{constructor(t,e){this.banks=["."],this.beatString=".",this.sound=e,t&&(this.filename=t)}set filename(t){if(!t)return void(this.fname=t);const e=t.split("/");this.fname=e.pop()||t}get filename(){return this.fname}get basename(){if(this.filename)return this.filename.replace(ci,"")}get mapLen(){return this.banks[0].length}effectsToBits(t){let e=0;for(const n of t)e|=1<<n;return e}bitCount(t){for(var e=0;0!==t;)e+=this.bitCount32(0|t),t/=4294967296;return e}bitCount32(t){return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>24}recalcBeatString(){var t;let e={};for(const[t,n]of Object.entries(qr))e[this.effectsToBits(n)]=t;let n="";for(let i=0;i<this.mapLen;i++){let s=0;for(const e of this.banks){const n=e[i],r=null!==(t=qr[n])&&void 0!==t?t:jr;s|=this.effectsToBits(r)}const r=e[s];if(void 0!==r){n+=r;continue}let a=".",o=null;for(const[t,n]of Object.entries(e)){const e=this.bitCount(+t^s);(null===o||e<o)&&(o=e,a=n)}n+=a}this.beatString=n}checkConsistency(){if(this.mapLen<=0)throw"SongSection has no bank data!";for(const t of this.banks)if(t.length!=this.mapLen)throw"SongSection bank length consistency check failure!"}beatsAt(t){let e=[];for(const n of this.banks)e.push(n[t]);return e}removeBank(t){this.banks.length>1&&this.banks.splice(t,1)}addBank(){this.banks.push(".".repeat(this.mapLen))}}class di{constructor(t,e){this.title=t||"",this.loop=new li(e),this.source="",this.charsPerBeat=null,this.independentBuild=!1,this.enabled=!0,this.buildupPlayed=!1,this.hiddenBanks=[]}get bankCount(){return this.loop.banks.length}removeBank(t){var e;this.loop.removeBank(t),null===(e=this.build)||void 0===e||e.removeBank(t),this.hiddenBanks.splice(t,1),this.checkConsistency()}addBank(){var t;this.loop.addBank(),null===(t=this.build)||void 0===t||t.addBank(),this.hiddenBanks[this.bankCount]=!1,this.checkConsistency()}recalcBeatStrings(){var t;this.loop.recalcBeatString(),null===(t=this.build)||void 0===t||t.recalcBeatString()}checkConsistency(){var t;if(this.build&&this.build.banks.length!=this.loop.banks.length)throw"Song bank lengths are mismatched!";this.loop.checkConsistency(),null===(t=this.build)||void 0===t||t.checkConsistency()}}const ci=new RegExp("\\.(mp3|ogg|wav)$","i"),hi=new RegExp("\\.(png|gif|jpg|jpeg)$","i");function ui(t){const e=t.filename;return e.split("/").pop()||e}class pi{constructor(){this.songs=[],this.songQueue=[],this.images=[],this.imageQueue=[],this.name="<no name>",this.author="<unknown>",this.description="<no description>",this.link="",this.size=-1,this.downloaded=-1,this.enabled=!0,this._xmlQueue=[],this.totalFiles=-1,this.progressCallback=null,this.filesToLoad=0,this.filesLoaded=0,this.loadedFromURL=!1}updateProgress(t){if(this.progressCallback){let e=this.filesLoaded/this.filesToLoad;this.loadedFromURL&&(e=e/2+.5),this.progressCallback(void 0===t?e:t,this)}}loadFromURL(t,e){return this.loadedFromURL=!0,e&&(this.progressCallback=e),this.getBlob(t).then((t=>this.loadFromBlob(t)))}getBlob(t,e){return void 0!==e&&(this.progressCallback=e),new Promise(((e,n)=>{let i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="blob",i.onload=()=>{200==i.status?e(i.response):n(Error(i.status+": Could not fetch respack at "+t))},i.onerror=function(){n(Error(i.status+": Could not fetch respack at "+t))},i.onprogress=t=>{if(t.lengthComputable){this.size=t.total,this.downloaded=t.loaded;let e=t.loaded/t.total;this.progressCallback&&this.progressCallback(e/2,this)}},i.send()})).catch((e=>{throw 1012==e.code?Error("Respack at URL "+t+" is restricted. Check CORS."):e}))}async loadFromBlob(t,e){void 0!==e&&(this.progressCallback=e),this.updateProgress(this.loadedFromURL?.5:0),this.size=t.size;const n=new Bn(new on(t));try{const t=await n.getEntries();return await this.parseZip(t),this}catch(t){throw console.error(t),Error("Respack error:"+t)}}parseZip(t){this.totalFiles=0,this.filesToLoad=0,this.filesLoaded=0;for(const e of t)!e.directory&&e.filename&&(this.totalFiles++,this.parseFile(e));return this.parseSongQueue().then((()=>this.parseImageQueue())).then((()=>this.parseXML())).then((()=>{this._xmlQueue=[],console.log("Loaded",this.name,"successfully with",this.songs.length,"songs and",this.images.length,"images.")}))}parseFile(t){let e=ui(t);if(e.match(ci))this.songQueue.push(this.parseSong(t)),this.filesToLoad++;else if(e.match(hi)){let e=this.parseImage(t);e&&(this.imageQueue.push(e),this.filesToLoad++)}else e.toLowerCase().endsWith(".xml")&&this._xmlQueue.push(this.loadXML(t))}async parseSong(t){let e=new di("",t.filename);e.loop.filename;const n=this.getSong(e.loop.basename);if(n)console.warn("Song",e.loop.filename,"already exists! Conflict with "+n);else{this.songs.push(e);let n=await t.getData(new cn);e.loop.sound=n.buffer,this.filesLoaded++,this.updateProgress()}}parseSongQueue(){return this.songQueue.reduce(((t,e)=>t.then((()=>e))),Promise.resolve())}parseImage(t){let e,n,i=ui(t).replace(hi,"");if(e=i.match(new RegExp("^(.*)_(\\d+)$")))n=this.getImage(e[1]),n||(n={name:e[1],fullname:e[1],align:"center",bitmaps:[],frameDurations:[33],source:"",enabled:!0,animated:!0,beatsPerAnim:0},this.images.push(n));else{if(this.containsImage(i)){let e=this.getImage(i);return void console.log("WARNING: Image",i,"already exists! Conflict with",ui(t),"and",null==e?void 0:e.name)}n={name:i,fullname:i,align:"center",bitmaps:[],frameDurations:[33],source:"",enabled:!0,animated:!1,beatsPerAnim:0},this.images.push(n)}return this.loadImage(t,n)}async loadImage(t,e){let n="";switch(t.filename.split(".").pop().toLowerCase()){case"png":n="image/png";break;case"gif":n="image/gif";break;case"jpg":case"jpeg":n="image/jpeg";break;default:n="application/octet-stream"}let i=await t.getData(new an(n));return this.filesLoaded++,this.updateProgress(),{bitmap:i,img:e}}parseImageQueue(){return this.imageQueue.reduce(((t,e)=>t.then((()=>e)).then((t=>{if(!t)return;let e=new Image;e.src=t.bitmap,t.img.bitmaps.push(e)}))),Promise.resolve())}async loadXML(t){let e=await t.getData(new rn),n=new DOMParser,i=n.parseFromString(e,"text/xml");return i.querySelector("parsererror")&&(console.log("Respack parse failed, attempting ampersand sanitisation"),e=e.replace(/&amp;/g,"&"),e=e.replace(/&/g,"&amp;"),console.log(e),i=n.parseFromString(e,"text/xml")),i}async parseXML(){let t=!1,e=[];for(let n=0;n<this._xmlQueue.length;n++)e.push(this._xmlQueue[n].then((e=>{switch(e.documentElement.nodeName){case"songs":this.songs.length>0&&(t=!0,this.parseSongFile(e));break;case"images":this.images.length>0&&this.parseImageFile(e);break;case"info":this.parseInfoFile(e);break;default:console.warn("XML found with no <songs>, <images> or <info> tag")}})));await Promise.all(e),this.songs.length>0&&!t&&(this.songs=[],console.warn('Songs present in respack "'+this.name+'" but no XML to describe them'))}loadExtraCharts(t,e,n,i){for(let i=2;;i++){let s=t.getTag(n+i);if(null===s)break;s.length<e.mapLen?(console.warn(n+i+" is shorter than primary "+n+", padding with '.'"),s+=".".repeat(e.mapLen-s.length)):s.length>e.mapLen&&(console.warn(n+i+" is longer than primary "+n+", truncating"),s=s.slice(0,e.mapLen)),e.banks.push(s)}if(i&&e.banks.length!=i)if(console.warn("Should have seen",i,n,"sections, but found",e.banks.length),e.banks.length<i){console.warn("Adding empty banks to fit");for(let t=e.banks.length;t<i;t++)e.banks.push(".".repeat(e.mapLen))}else console.warn("Deleting excess banks"),e.banks=e.banks.slice(0,i)}parseSongFile(t){let e=[];for(const n of t.documentElement.children){let t=this.getSong(n.getAttribute("name"));if(t){t.title=n.getTag("title")||"",t.title||(t.title="<no name>",console.warn(t.loop.basename,"has no title!"));let i=n.getTag("rhythm");null===i&&(i="..no..rhythm..",console.warn(t.loop.basename,"has no rhythm!!")),t.loop.banks=[i],this.loadExtraCharts(n,t.loop,"rhythm");const s=n.getTag("buildup")||void 0;if(s){t.loop.basename;let e=this.getSong(s);if(e){t.build=e.loop,this.songs.splice(this.songs.indexOf(e),1);let i=n.getTag("buildupRhythm");null===i&&(i=".",console.warn(t.loop.basename,"has no buildup, despite having a buildup sound!!")),t.build.banks=[i],this.loadExtraCharts(n,t.build,"buildupRhythm",t.loop.banks.length)}else console.warn("Didn't find a buildup '"+s+"'!")}t.independentBuild=!!n.getTag("independentBuild"),t.source=n.getTag("source")||"",t.charsPerBeat=parseFloat(n.getTag("charsPerBeat")||"0"),t.recalcBeatStrings(),t.checkConsistency(),e.push(t),t.loop.basename,t.title}else console.warn("songs.xml: <song> element"+n.getAttribute("name")+"- no song found")}for(let t=0;t<this.songs.length;t++)-1==e.indexOf(this.songs[t])&&console.warn("We have a file for",this.songs[t].loop.basename,"but no information for it");this.songs=e}parseInfoFile(t){let e=t.documentElement;this.name=e.getTag("name",this.name),this.author=e.getTag("author",this.author),this.description=e.getTag("description",this.description),this.link=e.getTag("link",this.link)}parseImageFile(t){let e=[];for(const n of t.documentElement.children){let t=this.getImage(n.getAttribute("name"));if(t){t.fullname=n.getTag("fullname")||"",t.fullname||console.warn(t.name,"has no full name!"),t.source=n.getTag("source")||"",t.align=n.getTag("align",t.align),t.beatsPerAnim=parseFloat(n.getTag("beatsPerAnim")||"0"),t.syncOffset=parseFloat(n.getTag("syncOffset")||"0");let i=n.getTag("frameDuration");if(i){t.frameDurations=[];let e=i.split(",");for(let n=0;n<e.length;n++)t.frameDurations.push(parseInt(e[n]));for(;t.frameDurations.length<t.bitmaps.length;)t.frameDurations.push(t.frameDurations[t.frameDurations.length-1]);t.frameDurations}t.name,t.fullname,t.bitmaps.length?e.push(t):console.warn("Image",t.name,"has no bitmap nor animation frames!")}else console.warn("images.xml: no image '"+n.getAttribute("name")+"' found")}for(let t=0;t<this.images.length;t++){let n=this.images[t];-1==e.indexOf(n)&&e.push(n)}e.sort((function(t,e){return t.name.localeCompare(e.name)})),this.images=e}containsSong(t){return null!==this.getSong(t)}containsImage(t){return null!==this.getImage(t)}getSong(t){for(let e of this.songs)if(t==e.loop.basename)return e;return null}getImage(t){for(let e of this.images)if(t==e.name)return e;return null}}function mi(t){b(t,"svelte-20k9a3","button.svelte-20k9a3{font-size:10px;font-family:inherit;margin:3px 2px;padding:3px;background-color:rgba(127,127,127, 0.5);border-color:rgb(0,0,0);border-width:1px;border-style:solid;cursor:pointer;text-transform:uppercase;user-select:none}button.nouppercase.svelte-20k9a3{text-transform:none}button.nopad.svelte-20k9a3{margin:0}button.noborder.svelte-20k9a3{border:none}button.svelte-20k9a3:hover{background:rgba(255,255,255, 0.5)}button.opaque.svelte-20k9a3{background-color:rgb(171,171,171)}button.opaque.svelte-20k9a3:hover{background-color:rgb(236,236,236) !important}.loaded.svelte-20k9a3{background-color:rgba(0,127,0,0.5);cursor:default}button.svelte-20k9a3:disabled{color:#777;cursor:default}.loaded.svelte-20k9a3:hover{background-color:rgba(0,127,0,0.5);cursor:default}button.svelte-20k9a3:disabled:hover{background-color:rgba(127,127,127, 0.5)}.glow.svelte-20k9a3{animation-name:svelte-20k9a3-glow;animation-duration:2s;animation-iteration-count:infinite}@keyframes svelte-20k9a3-glow{from{background-color:rgba(127,127,127, 0.5)}50%{background-color:rgba(0,127,0,0.5)}to{background-color:rgba(127,127,127, 0.5)}}")}function fi(t){let e,n,i,s;const r=t[10].default,a=d(r,t,t[9],null);return{c(){e=y("button"),a&&a.c(),e.disabled=t[1],S(e,"title",t[5]),S(e,"class","svelte-20k9a3"),T(e,"loaded",t[2]),T(e,"glow",t[3]),T(e,"opaque",t[4]),T(e,"nouppercase",t[6]),T(e,"nopad",t[7]),T(e,"noborder",t[8]),T(e,"hues-icon",t[0])},m(r,o){w(r,e,o),a&&a.m(e,null),n=!0,i||(s=C(e,"click",t[11]),i=!0)},p(t,[i]){a&&a.p&&(!n||512&i)&&u(a,r,t,t[9],n?h(r,t[9],i,null):p(t[9]),null),(!n||2&i)&&(e.disabled=t[1]),(!n||32&i)&&S(e,"title",t[5]),4&i&&T(e,"loaded",t[2]),8&i&&T(e,"glow",t[3]),16&i&&T(e,"opaque",t[4]),64&i&&T(e,"nouppercase",t[6]),128&i&&T(e,"nopad",t[7]),256&i&&T(e,"noborder",t[8]),1&i&&T(e,"hues-icon",t[0])},i(t){n||(it(a,t),n=!0)},o(t){st(a,t),n=!1},d(t){t&&x(e),a&&a.d(t),i=!1,s()}}}function gi(t,e,n){let{$$slots:i={},$$scope:s}=e,{icon:r=!1}=e,{disabled:a=!1}=e,{loaded:o=!1}=e,{glow:l=!1}=e,{opaque:d=!1}=e,{title:c=""}=e,{nouppercase:h=!1}=e,{nopad:u=!1}=e,{noborder:p=!1}=e;return t.$$set=t=>{"icon"in t&&n(0,r=t.icon),"disabled"in t&&n(1,a=t.disabled),"loaded"in t&&n(2,o=t.loaded),"glow"in t&&n(3,l=t.glow),"opaque"in t&&n(4,d=t.opaque),"title"in t&&n(5,c=t.title),"nouppercase"in t&&n(6,h=t.nouppercase),"nopad"in t&&n(7,u=t.nopad),"noborder"in t&&n(8,p=t.noborder),"$$scope"in t&&n(9,s=t.$$scope)},[r,a,o,l,d,c,h,u,p,s,i,function(e){O.call(this,t,e)}]}Element.prototype.getTag=function(t,e){let n=this.getElementsByTagName(t)[0];return n?n.textContent:e||null};const bi=class extends ut{constructor(t){super(),ht(this,t,gi,fi,o,{icon:0,disabled:1,loaded:2,glow:3,opaque:4,title:5,nouppercase:6,nopad:7,noborder:8},mi)}};var wi;function xi(t){b(t,"svelte-seoydw",".header.svelte-seoydw.svelte-seoydw{grid-column:editors;display:grid;grid-template-columns:repeat(5, max-content) 1fr repeat(4, max-content);align-items:center;padding-bottom:5px}.beat-count.svelte-seoydw.svelte-seoydw{font-size:10px;margin-left:4px}.edit-box.svelte-seoydw.svelte-seoydw{grid-column:editors;position:relative;overflow:auto;background-color:white;margin:auto 5px;height:100%}.edit-box.svelte-seoydw>div.svelte-seoydw{white-space:break-spaces;word-break:break-all;line-break:anywhere}.beatmap.svelte-seoydw.svelte-seoydw{position:absolute;pointer-events:none}.beatmap.svelte-seoydw.svelte-seoydw:focus{outline-width:0;outline:none}.beatmap.hover.svelte-seoydw.svelte-seoydw{pointer-events:inherit}.beat-focus.svelte-seoydw.svelte-seoydw{position:absolute;color:rgba(127,127,127,0.2)}.beat-hilight.svelte-seoydw.svelte-seoydw{overflow-anchor:none;position:absolute;color:rgba(127,127,127,0.8)}.underline.svelte-seoydw.svelte-seoydw{text-decoration:underline}")}function vi(t,e,n){const i=t.slice();return i[50]=e[n][0],i[51]=e[n][1],i[52]=e,i[53]=n,i}function yi(t,e,n){const i=t.slice();return i[50]=e[n],i[53]=n,i}function ki(e){let n,i,s=wi.REWIND+"";return{c(){n=new L(!1),i=A(),n.a=i},m(t,e){n.m(s,t,e),w(t,i,e)},p:t,d(t){t&&x(i),t&&n.d()}}}function _i(t){let e,n,i=(t[3]?wi.LOCKED:wi.UNLOCKED)+"";return{c(){e=new L(!1),n=A(),e.a=n},m(t,s){e.m(i,t,s),w(t,n,s)},p(t,n){8&n[0]&&i!==(i=(t[3]?wi.LOCKED:wi.UNLOCKED)+"")&&e.p(i)},d(t){t&&x(n),t&&e.d()}}}function Ai(e){let n,i,s=wi.COPY+"";return{c(){n=new L(!1),i=A(),n.a=i},m(t,e){n.m(s,t,e),w(t,i,e)},p:t,d(t){t&&x(i),t&&n.d()}}}function Ci(t){let e;return{c(){e=k("Halve")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function Si(t){let e;return{c(){e=k("Double")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function Ii(t){let e,n,i;return{c(){e=y("div"),n=k("Load "),i=k(t[4]),$(e,"min-width","12ch")},m(t,s){w(t,e,s),g(e,n),g(e,i)},p(t,e){16&e[0]&&V(i,t[4])},d(t){t&&x(e)}}}function Vi(t){let e;return{c(){e=k("Remove")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function Ei(t){let e,n=t[8],i=[];for(let e=0;e<n.length;e+=1)i[e]=Li(yi(t,n,e));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=A()},m(t,n){for(let e=0;e<i.length;e+=1)i[e].m(t,n);w(t,e,n)},p(t,s){if(4416&s[0]){let r;for(n=t[8],r=0;r<n.length;r+=1){const a=yi(t,n,r);i[r]?i[r].p(a,s):(i[r]=Li(a),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(t){v(i,t),t&&x(e)}}}function $i(e){let n;return{c(){n=y("div"),n.textContent="[none]",S(n,"class","beat-hilight svelte-seoydw")},m(t,e){w(t,n,e)},p:t,d(t){t&&x(n)}}}function Ti(e){let n;return{c(){n=y("div"),n.textContent="Click [LOAD RHYTHM] to load a loop!\r\nOGG,or LAME encoded MP3s work best.\r\n\r\nYou can also add a buildup with\r\n[LOAD BUILDUP], or remove it with [REMOVE].\r\n\r\n[NEW SONG] adds a totally empty song to edit.\r\n\r\n[COPY/SAVE XML] allow for storing the rhythms\r\nand easy inclusion into a Resource Pack!\r\n\r\nClick [HELP] for advanced techniques and more\r\ninformation.",S(n,"class","beat-hilight svelte-seoydw")},m(t,e){w(t,n,e)},p:t,d(t){t&&x(n)}}}function Li(t){let e,n,i,s,r=" ".repeat(t[6])+"&block;";return{c(){e=y("div"),n=new L(!1),i=_(),n.a=i,S(e,"class","beat-hilight svelte-seoydw"),S(e,"style",s=t[12](t[53]))},m(t,s){w(t,e,s),n.m(r,e),g(e,i)},p(t,i){64&i[0]&&r!==(r=" ".repeat(t[6])+"&block;")&&n.p(r),4096&i[0]&&s!==(s=t[12](t[53]))&&S(e,"style",s)},d(t){t&&x(e)}}}function Bi(t){let e,n,i=t[8].length>1&&Di(t),s=t[8],r=[];for(let e=0;e<s.length;e+=1)r[e]=Mi(vi(t,s,e));return{c(){i&&i.c(),e=_();for(let t=0;t<r.length;t+=1)r[t].c();n=A()},m(t,s){i&&i.m(t,s),w(t,e,s);for(let e=0;e<r.length;e+=1)r[e].m(t,s);w(t,n,s)},p(t,a){if(t[8].length>1?i?i.p(t,a):(i=Di(t),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),7846273&a[0]){let e;for(s=t[8],e=0;e<s.length;e+=1){const i=vi(t,s,e);r[e]?r[e].p(i,a):(r[e]=Mi(i),r[e].c(),r[e].m(n.parentNode,n))}for(;e<r.length;e+=1)r[e].d(1);r.length=s.length}},d(t){i&&i.d(t),t&&x(e),v(r,t),t&&x(n)}}}function Di(t){let e,n,i="&block;".repeat(t[0].mapLen)+"";return{c(){e=y("div"),S(e,"class","beat-focus svelte-seoydw"),S(e,"style",n=t[12](t[10]))},m(t,n){w(t,e,n),e.innerHTML=i},p(t,s){1&s[0]&&i!==(i="&block;".repeat(t[0].mapLen)+"")&&(e.innerHTML=i),5120&s[0]&&n!==(n=t[12](t[10]))&&S(e,"style",n)},d(t){t&&x(e)}}}function Mi(t){let e,n,i,s,a=t[51];const o=()=>t[39](e,a),l=()=>t[39](null,a);function d(){t[40].call(e,t[51])}return{c(){e=y("div"),S(e,"contenteditable",""),S(e,"spellcheck","false"),S(e,"class","beatmap svelte-seoydw"),S(e,"style",n=t[12](t[53])),void 0===t[0].banks[t[51]]&&H(d),T(e,"underline",t[8].length>1&&t[53]==t[8].length-1),T(e,"hover",t[51]==t[11])},m(n,r){w(n,e,r),o(),void 0!==t[0].banks[t[51]]&&(e.textContent=t[0].banks[t[51]]),i||(s=[C(e,"keydown",t[20]),C(e,"keyup",t[21]),C(e,"paste",t[22]),C(e,"input",t[15]),C(e,"input",d),C(e,"input",t[16]),C(e,"contextmenu",t[17]),C(e,"mousedown",t[18]),C(e,"click",t[18]),C(e,"focus",t[41])],i=!0)},p(i,s){t=i,4096&s[0]&&n!==(n=t[12](t[53]))&&S(e,"style",n),a!==t[51]&&(l(),a=t[51],o()),257&s[0]&&t[0].banks[t[51]]!==e.textContent&&(e.textContent=t[0].banks[t[51]]),256&s[0]&&T(e,"underline",t[8].length>1&&t[53]==t[8].length-1),2304&s[0]&&T(e,"hover",t[51]==t[11])},d(t){t&&x(e),l(),i=!1,r(s)}}}function Ni(t){let e,n,i,s,a,o,l,d,c,h,u,p,m,f,b,v,A,I,E,T,L,B,D,M,N,O,z,U,F,R,P=(t[0]?t[0].mapLen:0)+"";function j(t,e){return t[5]&&!t[0]?.sound?Ti:t[0]?.sound?null!==t[6]&&t[6]>=0&&t[8]?Ei:void 0:$i}s=new bi({props:{icon:!0,disabled:!t[0]?.sound,$$slots:{default:[ki]},$$scope:{ctx:t}}}),s.$on("click",t[32]),h=new bi({props:{icon:!0,title:(t[3]?"Unlock":"Lock")+" beat count",disabled:!t[0]?.sound,$$slots:{default:[_i]},$$scope:{ctx:t}}}),h.$on("click",t[14]),p=new bi({props:{icon:!0,disabled:!t[0]?.sound,title:"Copy formatted beatmap",$$slots:{default:[Ai]},$$scope:{ctx:t}}}),p.$on("click",t[33]),v=new bi({props:{disabled:!t[0]?.sound||t[3]||t[0].mapLen<=1,$$slots:{default:[Ci]},$$scope:{ctx:t}}}),v.$on("click",t[34]),I=new bi({props:{disabled:!t[0]?.sound||t[3],$$slots:{default:[Si]},$$scope:{ctx:t}}}),I.$on("click",t[35]),B=new bi({props:{$$slots:{default:[Ii]},$$scope:{ctx:t}}}),B.$on("click",t[37]),M=new bi({props:{disabled:!t[0]?.sound,$$slots:{default:[Vi]},$$scope:{ctx:t}}}),M.$on("click",t[24]);let q=j(t),W=q&&q(t),H=t[0]?.sound&&t[8]&&Bi(t);return{c(){e=y("div"),n=y("span"),i=_(),lt(s.$$.fragment),a=_(),o=y("span"),l=k(P),d=k(" beats"),c=_(),lt(h.$$.fragment),u=_(),lt(p.$$.fragment),m=_(),f=y("div"),b=_(),lt(v.$$.fragment),A=_(),lt(I.$$.fragment),E=_(),T=y("input"),L=_(),lt(B.$$.fragment),D=_(),lt(M.$$.fragment),N=_(),O=y("div"),W&&W.c(),z=_(),H&&H.c(),$(n,"min-width","7ch"),S(o,"class","beat-count svelte-seoydw"),S(T,"type","file"),$(T,"display","none"),S(T,"accept",".mp3, .wav, .ogg"),S(e,"class","header svelte-seoydw"),S(O,"class","edit-box svelte-seoydw")},m(r,x){w(r,e,x),g(e,n),n.innerHTML=t[4],g(e,i),dt(s,e,null),g(e,a),g(e,o),g(o,l),g(o,d),g(e,c),dt(h,e,null),g(e,u),dt(p,e,null),g(e,m),g(e,f),g(e,b),dt(v,e,null),g(e,A),dt(I,e,null),g(e,E),g(e,T),t[36](T),g(e,L),dt(B,e,null),g(e,D),dt(M,e,null),t[38](e),w(r,N,x),w(r,O,x),W&&W.m(O,null),g(O,z),H&&H.m(O,null),t[42](O),U=!0,F||(R=[C(T,"change",t[23]),C(O,"mousemove",t[19])],F=!0)},p(t,e){(!U||16&e[0])&&(n.innerHTML=t[4]);const i={};1&e[0]&&(i.disabled=!t[0]?.sound),16777216&e[1]&&(i.$$scope={dirty:e,ctx:t}),s.$set(i),(!U||1&e[0])&&P!==(P=(t[0]?t[0].mapLen:0)+"")&&V(l,P);const r={};8&e[0]&&(r.title=(t[3]?"Unlock":"Lock")+" beat count"),1&e[0]&&(r.disabled=!t[0]?.sound),8&e[0]|16777216&e[1]&&(r.$$scope={dirty:e,ctx:t}),h.$set(r);const a={};1&e[0]&&(a.disabled=!t[0]?.sound),16777216&e[1]&&(a.$$scope={dirty:e,ctx:t}),p.$set(a);const o={};9&e[0]&&(o.disabled=!t[0]?.sound||t[3]||t[0].mapLen<=1),16777216&e[1]&&(o.$$scope={dirty:e,ctx:t}),v.$set(o);const d={};9&e[0]&&(d.disabled=!t[0]?.sound||t[3]),16777216&e[1]&&(d.$$scope={dirty:e,ctx:t}),I.$set(d);const c={};16&e[0]|16777216&e[1]&&(c.$$scope={dirty:e,ctx:t}),B.$set(c);const u={};1&e[0]&&(u.disabled=!t[0]?.sound),16777216&e[1]&&(u.$$scope={dirty:e,ctx:t}),M.$set(u),q===(q=j(t))&&W?W.p(t,e):(W&&W.d(1),W=q&&q(t),W&&(W.c(),W.m(O,z))),t[0]?.sound&&t[8]?H?H.p(t,e):(H=Bi(t),H.c(),H.m(O,null)):H&&(H.d(1),H=null)},i(t){U||(it(s.$$.fragment,t),it(h.$$.fragment,t),it(p.$$.fragment,t),it(v.$$.fragment,t),it(I.$$.fragment,t),it(B.$$.fragment,t),it(M.$$.fragment,t),U=!0)},o(t){st(s.$$.fragment,t),st(h.$$.fragment,t),st(p.$$.fragment,t),st(v.$$.fragment,t),st(I.$$.fragment,t),st(B.$$.fragment,t),st(M.$$.fragment,t),U=!1},d(n){n&&x(e),ct(s),ct(h),ct(p),ct(v),ct(I),t[36](null),ct(B),ct(M),t[38](null),n&&x(N),n&&x(O),W&&W.d(),H&&H.d(),t[42](null),F=!1,r(R)}}}function Oi(t,e,n){let i,s;const r=N();let a,o,{title:l}=e,{section:d}=e,{showHelp:c=!1}=e,{newLineAtBeat:h}=e,{beatIndex:u}=e,{soundManager:p}=e,{editBox:m}=e,{header:f}=e,g=[],{locked:b=!1}=e,{caret:w}=e,{hiddenBanks:x=[]}=e,v=0,y=0;const k=()=>{var t;let e=0;const n=window.getSelection();if(null==n?void 0:n.rangeCount){const i=n.getRangeAt(0);for(let n of g[v].childNodes){if(i.commonAncestorContainer==n)return e+=i.endOffset,e;e+=(null===(t=n.textContent)||void 0===t?void 0:t.length)||0}}},_=(t,e)=>{void 0===e?e=g[v]:n(10,v=g.indexOf(e)),n(26,w=Math.min(t,d.mapLen));let i=window.getSelection();const s=[...e.childNodes].find((t=>t.nodeType===Node.TEXT_NODE));s&&i&&i.collapse(s,w)},A=async t=>{C();let e=d.banks[v];const i=window.getSelection();if(null==i?void 0:i.rangeCount){const t=i.getRangeAt(0);t.endOffset-t.startOffset>1&&(e=e.slice(0,t.startOffset)+e.slice(t.endOffset),n(26,w=t.startOffset))}n(0,d.banks[v]=e.slice(0,w)+t+e.slice(w),d);const s=w+t.length;await W(),_(s),await $()};let C=()=>{o=d.mapLen,r("beforeinput")};const S=()=>"Unsaved beatmap - leave anyway?";let I=(t,e,i)=>{const s=d.banks[t];n(0,d.banks[t]=s.slice(0,i)+s.slice(i+e),d)},V=(t,e,i)=>{const s=d.banks[t],r=".".repeat(e);n(0,d.banks[t]=s.slice(0,i)+r+s.slice(i),d)},E=(t,e,n)=>{const i=d.banks[t].length;i<e?V(t,e-i,n):e<i&&I(t,i-e,n)},$=async()=>{n(26,w=k());const t=d.banks[v].length;if(b&&o!=t&&void 0!==w)t>o?(n(26,w=Math.min(o,w)),I(v,t-o,w)):V(v,o-t,w),await W(),_(w);else if(!b&&o!=t&&void 0!==w)for(let e=0;e<d.banks.length;e++)e!=v&&E(e,t,t>o?Math.max(0,w-(t-o)):Math.max(0,w));window.onbeforeunload=S,r("afterinput")};const T=t=>{if(!(null==i?void 0:i.length))return[0,void 0];let e=m,n=0,s=0;for(;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)n+=e.offsetLeft-e.scrollLeft,s+=e.offsetTop-e.scrollTop,e=e.offsetParent;n=t.clientX-n,s=t.clientY-s;const r=i[0][0].clientWidth/h,a=i.length,o=Math.ceil(d.mapLen/h)*a,l=i[0][0].clientHeight/o;n=Math.floor(n/r),s=Math.floor(s/l);let c=i[s%a][0];return s=Math.floor(s/a),[n+s*h,c]};let L=()=>{let t=new RegExp("(.{"+h+"})","g"),e=d.banks[v].replace(t,"$1\n"),n=document.createElement("textarea");n.className="copybox",n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)};return t.$$set=t=>{"title"in t&&n(4,l=t.title),"section"in t&&n(0,d=t.section),"showHelp"in t&&n(5,c=t.showHelp),"newLineAtBeat"in t&&n(27,h=t.newLineAtBeat),"beatIndex"in t&&n(6,u=t.beatIndex),"soundManager"in t&&n(28,p=t.soundManager),"editBox"in t&&n(1,m=t.editBox),"header"in t&&n(2,f=t.header),"locked"in t&&n(3,b=t.locked),"caret"in t&&n(26,w=t.caret),"hiddenBanks"in t&&n(29,x=t.hiddenBanks)},t.$$.update=()=>{536871041&t.$$.dirty[0]&&n(8,i=null==d?void 0:d.banks.map(((t,e)=>[g[e],e])).filter(((t,e)=>!x[e]))),134217984&t.$$.dirty[0]&&n(12,s=t=>`width:${h}ch; top: calc(-${i.length-1}ch/2 + ${t}ch); line-height: ${i.length}ch;`)},[d,m,f,b,l,c,u,g,i,a,v,y,s,r,()=>{n(3,b=!b)},C,$,t=>{const[e,n]=T(t);_(e,n),r("seek",e/d.mapLen),t.preventDefault()},t=>{const[e,i]=T(t);n(26,w=e),n(10,v=g.indexOf(i)),t.stopPropagation()},t=>{const[e,i]=T(t);void 0!==i&&n(11,y=g.indexOf(i))},t=>{13==t.keyCode&&(t.preventDefault(),t.stopPropagation())},t=>{if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)){const t=k();void 0!==t&&n(26,w=t)}},t=>{var e;t.preventDefault(),t.stopPropagation();let n=null===(e=t.clipboardData)||void 0===e?void 0:e.getData("text/plain");n&&A(n)},async()=>{if(!a.files||a.files.length<1)return;let t,e,n=a.files[0];try{let e=await n.arrayBuffer();t=new li(void 0,e),await p.loadBuffer(t)}catch(t){return console.error(t),void r("error","Couldn't load song! Is it a LAME encoded MP3?")}void 0===d?(e=new li,e.banks=["x...o...x...o..."]):e=d,e.filename=n.name,e.sound=t.sound,r("songload",e)},()=>{n(0,d.banks=["."],d),n(0,d.filename=void 0,d),n(0,d.sound=void 0,d),r("songremove")},L,w,h,p,x,_,A,()=>r("rewind"),()=>L(),()=>r("halve"),()=>r("double"),function(t){U[t?"unshift":"push"]((()=>{a=t,n(9,a)}))},()=>a.click(),function(t){U[t?"unshift":"push"]((()=>{f=t,n(2,f)}))},function(t,e){U[t?"unshift":"push"]((()=>{g[e]=t,n(7,g)}))},function(t){d.banks[t]=this.textContent,n(0,d)},()=>r("focus"),function(t){U[t?"unshift":"push"]((()=>{m=t,n(1,m)}))}]}!function(t){t.COG="&#xe900;",t.PLAY="&#xe901;",t.PAUSE="&#xe902;",t.SHUFFLE="&#xe903;",t.CHAIN_BROKEN="&#xe904;",t.CHAIN="&#xe905;",t.LOCKED="&#xe906;",t.UNLOCKED="&#xe907;",t.MENU="&#xe908;",t.BACKWARD="&#xe909;",t.FORWARD="&#xe90a;",t.REWIND="&#xe90b;",t.COPY="&#xe90c;",t.EYE="&#xe90d;",t.EYE_CLOSED="&#xe90e;"}(wi||(wi={}));const zi=class extends ut{constructor(t){super(),ht(this,t,Oi,Ni,o,{title:4,section:0,showHelp:5,newLineAtBeat:27,beatIndex:6,soundManager:28,editBox:1,header:2,locked:3,caret:26,hiddenBanks:29,setCaret:30,fakeInput:31},xi,[-1,-1])}get title(){return this.$$.ctx[4]}set title(t){this.$$set({title:t}),X()}get section(){return this.$$.ctx[0]}set section(t){this.$$set({section:t}),X()}get showHelp(){return this.$$.ctx[5]}set showHelp(t){this.$$set({showHelp:t}),X()}get newLineAtBeat(){return this.$$.ctx[27]}set newLineAtBeat(t){this.$$set({newLineAtBeat:t}),X()}get beatIndex(){return this.$$.ctx[6]}set beatIndex(t){this.$$set({beatIndex:t}),X()}get soundManager(){return this.$$.ctx[28]}set soundManager(t){this.$$set({soundManager:t}),X()}get editBox(){return this.$$.ctx[1]}set editBox(t){this.$$set({editBox:t}),X()}get header(){return this.$$.ctx[2]}set header(t){this.$$set({header:t}),X()}get locked(){return this.$$.ctx[3]}set locked(t){this.$$set({locked:t}),X()}get caret(){return this.$$.ctx[26]}set caret(t){this.$$set({caret:t}),X()}get hiddenBanks(){return this.$$.ctx[29]}set hiddenBanks(t){this.$$set({hiddenBanks:t}),X()}get setCaret(){return this.$$.ctx[30]}get fakeInput(){return this.$$.ctx[31]}};let Ui=0;function Fi(){return Ui++,"hues-input-"+Ui}function Ri(t){b(t,"svelte-17ofc0v","label.svelte-17ofc0v{grid-column:1}input.svelte-17ofc0v{grid-column:2;font-family:'PetMe64Web';font-size:7pt;margin-right:5px;padding:3px;border-color:rgb(0,0,0);border-width:1px;border-style:solid}")}function Pi(e){let n,i,s,r,a;return{c(){n=y("label"),i=_(),s=y("input"),S(n,"for",e[4]),S(n,"class","svelte-17ofc0v"),S(s,"type","text"),S(s,"placeholder",e[2]),S(s,"id",e[4]),s.disabled=e[3],S(s,"class","svelte-17ofc0v")},m(t,o){w(t,n,o),n.innerHTML=e[1],w(t,i,o),w(t,s,o),E(s,e[0]),r||(a=C(s,"input",e[5]),r=!0)},p(t,[e]){2&e&&(n.innerHTML=t[1]),4&e&&S(s,"placeholder",t[2]),8&e&&(s.disabled=t[3]),1&e&&s.value!==t[0]&&E(s,t[0])},i:t,o:t,d(t){t&&x(n),t&&x(i),t&&x(s),r=!1,a()}}}function ji(t,e,n){let{label:i=""}=e,{value:s=""}=e,{placeholder:r=""}=e,{disabled:a=!1}=e,o=Fi();return t.$$set=t=>{"label"in t&&n(1,i=t.label),"value"in t&&n(0,s=t.value),"placeholder"in t&&n(2,r=t.placeholder),"disabled"in t&&n(3,a=t.disabled)},[s,i,r,a,o,function(){s=this.value,n(0,s)}]}const qi=class extends ut{constructor(t){super(),ht(this,t,ji,Pi,o,{label:1,value:0,placeholder:2,disabled:3},Ri)}};function Wi(t){b(t,"svelte-1vo549f","span.svelte-1vo549f{padding-right:1em}.label.svelte-1vo549f{grid-column:1}.unit.svelte-1vo549f{grid-column:3}.val.svelte-1vo549f{grid-column:2;text-align:right;min-width:6ch}")}function Hi(e){let n,i,s,r,a,o,l,d,c,h=e[0]?":":"";return{c(){n=y("span"),i=k(e[0]),s=k(h),r=_(),a=y("span"),o=k(e[2]),l=_(),d=y("span"),c=k(e[1]),S(n,"class","label svelte-1vo549f"),S(a,"class","val svelte-1vo549f"),S(d,"class","unit svelte-1vo549f")},m(t,e){w(t,n,e),g(n,i),g(n,s),w(t,r,e),w(t,a,e),g(a,o),w(t,l,e),w(t,d,e),g(d,c)},p(t,[e]){1&e&&V(i,t[0]),1&e&&h!==(h=t[0]?":":"")&&V(s,h),4&e&&V(o,t[2]),2&e&&V(c,t[1])},i:t,o:t,d(t){t&&x(n),t&&x(r),t&&x(a),t&&x(l),t&&x(d)}}}function Ki(t,e,n){let{label:i=""}=e,{unit:s=""}=e,{value:r="N/A"}=e;return t.$$set=t=>{"label"in t&&n(0,i=t.label),"unit"in t&&n(1,s=t.unit),"value"in t&&n(2,r=t.value)},[i,s,r]}const Zi=class extends ut{constructor(t){super(),ht(this,t,Ki,Hi,o,{label:0,unit:1,value:2},Wi)}};function Qi(t){b(t,"svelte-1yjditw",".timelock.svelte-1yjditw{grid-column:editor-link;grid-row:buildup-header / rhythm-editor;align-self:center;margin-top:-6px}.timelock-border.svelte-1yjditw{grid-column:editor-link;grid-row:buildup-header / rhythm-header;width:5px;margin-left:9px;margin-top:10px;margin-bottom:-12px;border-left:3px #666 solid;border-top:3px #666 solid;border-bottom:3px #666 solid}.timelock-border.unlocked.svelte-1yjditw{border-left:3px #666 dashed}")}function Xi(t){let e,n,i=(t[1]?wi.CHAIN_BROKEN:wi.CHAIN)+"";return{c(){e=new L(!1),n=A(),e.a=n},m(t,s){e.m(i,t,s),w(t,n,s)},p(t,n){2&n&&i!==(i=(t[1]?wi.CHAIN_BROKEN:wi.CHAIN)+"")&&e.p(i)},d(t){t&&x(n),t&&e.d()}}}function Gi(t){let e,n,i,s,r;return s=new bi({props:{opaque:!0,disabled:t[0],title:"Lock Buildup/Rhythm beat lengths",$$slots:{default:[Xi]},$$scope:{ctx:t}}}),s.$on("click",t[2]),{c(){e=y("div"),n=_(),i=y("div"),lt(s.$$.fragment),S(e,"class","timelock-border svelte-1yjditw"),T(e,"unlocked",t[1]),S(i,"class","hues-icon timelock svelte-1yjditw"),T(i,"unlocked",t[1])},m(t,a){w(t,e,a),w(t,n,a),w(t,i,a),dt(s,i,null),r=!0},p(t,[n]){2&n&&T(e,"unlocked",t[1]);const r={};1&n&&(r.disabled=t[0]),34&n&&(r.$$scope={dirty:n,ctx:t}),s.$set(r),2&n&&T(i,"unlocked",t[1])},i(t){r||(it(s.$$.fragment,t),r=!0)},o(t){st(s.$$.fragment,t),r=!1},d(t){t&&x(e),t&&x(n),t&&x(i),ct(s)}}}function Ji(t,e,n){let i,{unlocked:s=!0}=e,{disabled:r=!1}=e;const a=N();return t.$$set=t=>{"unlocked"in t&&n(3,s=t.unlocked),"disabled"in t&&n(0,r=t.disabled)},t.$$.update=()=>{9&t.$$.dirty&&n(1,i=s||r)},[r,i,()=>{n(3,s=!s),a("click")},s]}const Yi=class extends ut{constructor(t){super(),ht(this,t,Ji,Gi,o,{unlocked:3,disabled:0},Qi)}};function ts(t){b(t,"svelte-16grtgi","canvas.svelte-16grtgi{width:100%}")}function es(e){let n,i,s;return{c(){n=y("canvas"),S(n,"height",is),$(n,"height",is+"px"),S(n,"class","svelte-16grtgi")},m(t,r){w(t,n,r),e[4](n),i||(s=C(window,"resize",e[1]),i=!0)},p:t,i:t,o:t,d(t){t&&x(n),e[4](null),i=!1,s()}}}const ns=100,is=30;function ss(t,e,n){let i,s,r,a,{disabled:o=!1}=e,{soundManager:l=null}=e,d=(t,e)=>{if(!t)return null;let n=document.createElement("canvas"),i=n.getContext("2d");n.height=is,n.width=Math.floor(ns*e);let s=Math.floor(t.sampleRate/ns),r=[];for(let e=0;e<t.numberOfChannels;e++)r.push(t.getChannelData(e));let a=t.numberOfChannels,o=.5,l=is/2;for(let e=0;e<t.length;e+=s){let n,d=0,c=0,h=0,u=0;for(n=0;n<s&&e+n<t.length;n++)for(let t=0;t<a;t++){let i=r[t][e+n];i>0?h+=i:u+=i,i>c&&(c=i),i<d&&(d=i)}let p=Math.floor(l+c*l),m=Math.floor(l+d*l);i.strokeStyle="black",i.globalAlpha=1,i.beginPath(),i.moveTo(o,p),i.lineTo(o,m),i.stroke(),h/=n*a,u/=n*a;let f=Math.floor(l+h*l),g=Math.floor(l+u*l);i.strokeStyle="white",i.globalAlpha=.5,i.beginPath(),i.moveTo(o,f),i.lineTo(o,g),i.stroke(),o+=1}return n},c=(t,e,n,i)=>{let r=Math.min(i-n,t.width-e);return s.drawImage(t,e,0,r,is,n,0,r,is),n+r},h=(t,e)=>{s.strokeStyle=t,s.lineWidth=2,s.beginPath(),s.moveTo(e,0),s.lineTo(e,is),s.stroke()},u=()=>{n(0,i.width=i.clientWidth,i)};return M((()=>{u(),s=i.getContext("2d");let t=requestAnimationFrame((function e(){(()=>{if(!r&&!a||o||!l)return;let t,e,n=i.width,d=l.currentTime,u=n/ns/2,p=d-u,m=d+u,f=l.build.length,g=l.loop.length;if(t=f?Math.max(p,-f):Math.max(p,0),e=Math.floor((t-p)*ns),s.clearRect(0,0,n,is),r&&f&&p<0){let s=Math.floor((1-t/-f)*(r.width-1));try{e=c(r,s,e,n)}catch(t){console.log(i)}t=0}let b=[];if(a&&g&&m>0)for(;e<n;){0===t&&b.push(e);let i=Math.floor(t/g*(a.width-1));e=c(a,i,e,n),t=0}h("red",n/2);for(let t of b)h("green",t)})(),t=requestAnimationFrame(e)})),e=new IntersectionObserver(((t,e)=>{for(let e of t)e.intersectionRatio>0&&u()}));return e.observe(i),()=>{cancelAnimationFrame(t),e.disconnect()}})),t.$$set=t=>{"disabled"in t&&n(2,o=t.disabled),"soundManager"in t&&n(3,l=t.soundManager)},t.$$.update=()=>{8&t.$$.dirty&&l&&(r=d(l.build.buffer,l.build.length),a=d(l.loop.buffer,l.loop.length))},[i,u,o,l,function(t){U[t?"unshift":"push"]((()=>{i=t,n(0,i)}))}]}const rs=class extends ut{constructor(t){super(),ht(this,t,ss,es,o,{disabled:2,soundManager:3},ts)}};function as(t){b(t,"svelte-1jqqz7x","a.svelte-1jqqz7x{text-decoration:none;color:inherit}hr.svelte-1jqqz7x{width:100%}.editor.svelte-1jqqz7x{position:relative;display:flex;flex-direction:column;max-width:calc(100% - 10px);width:1000px;height:100%;margin:5px;font-size:13px}.editor-gate.svelte-1jqqz7x{flex-grow:1;font-size:15px;display:flex;flex-direction:column;align-items:center;justify-content:center}.editor-gate-button.svelte-1jqqz7x{font-size:20px}.top-bar.svelte-1jqqz7x{display:grid;grid-template-columns:auto max-content}.title-buttons.svelte-1jqqz7x{display:flex;align-items:center}.status-msg.svelte-1jqqz7x{font-size:10px;color:red;opacity:1;animation-duration:10s;animation-name:svelte-1jqqz7x-pulsefade;animation-fill-mode:forwards}.info.svelte-1jqqz7x{display:grid;grid-template-columns:max-content auto;align-items:center}.song-stats.svelte-1jqqz7x{display:grid;grid-template-columns:max-content auto;align-self:center}.banks.svelte-1jqqz7x{grid-column:editor-banks;grid-row:1/-1;align-self:center;text-align:center;display:grid;grid-template-columns:auto 1.5ch;justify-items:stretch}.banks-span-both.svelte-1jqqz7x{grid-column:1/-1}.edit-area.svelte-1jqqz7x{--buildup-ratio:1fr;--rhythm-ratio:3fr;flex-grow:1;min-height:0;display:grid;grid-template-columns:[editor-banks] min-content\r\n        [editor-link] min-content\r\n        [editors] auto;grid-template-rows:[buildup-header] min-content\r\n        [buildup-editor] var(--buildup-ratio)\r\n\r\n        [drag-handle] min-content\r\n\r\n        [rhythm-header] min-content\r\n        [rhythm-editor] var(--rhythm-ratio)}.resize-handle.svelte-1jqqz7x{grid-row:drag-handle;grid-column:editors;width:100%;height:20px;cursor:row-resize;overflow:hidden}.handle.svelte-1jqqz7x{transform:scale(10.0, 1.0);font-size:20px;text-align:center;color:#999}.handle.svelte-1jqqz7x:hover{color:#000}.beats.svelte-1jqqz7x{grid-column:editors;display:flex;margin:3px 10px 0}.controls.svelte-1jqqz7x{grid-column:editors;display:grid;grid-template-columns:repeat(3, max-content) auto repeat(2, max-content);align-items:center;margin:3px 10px}input.svelte-1jqqz7x::-webkit-outer-spin-button,input.svelte-1jqqz7x::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number].svelte-1jqqz7x{-moz-appearance:textfield}@keyframes svelte-1jqqz7x-pulsefade{from{opacity:0}5%{opacity:1}10%{opacity:0.5}15%{opacity:1}20%{opacity:0.5}25%{opacity:1}30%{opacity:0.5}35%{opacity:1}40%{opacity:0.5}45%{opacity:1}50%{opacity:0.5}to{opacity:0}}")}function os(t,e,n){const i=t.slice();return i[101]=e[n],i}function ls(t,e,n){const i=t.slice();return i[104]=e[n],i[106]=n,i}function ds(t){let e,n,i,s,a,l,d,c,h,u,p,m,f,b,$,T,L,B,D,M,N,O,z,F,R,P,j,q,W,H,Z,Q,X,G,J,Y,tt,ht,ut,pt,mt,ft,gt,bt,wt,xt,vt,yt,kt,_t,At,Ct,St,It,Vt,Et,$t,Tt,Lt,Bt,Dt,Mt,Nt,Ot,zt,Ut,Ft,Rt,Pt,jt,qt,Wt,Ht,Kt,Zt,Qt,Xt=t[25],Gt=wi.MENU+"",Jt=t[27].toFixed(2)+"";n=new bi({props:{$$slots:{default:[hs]},$$scope:{ctx:t}}}),n.$on("click",t[52]),s=new bi({props:{disabled:t[11],$$slots:{default:[us]},$$scope:{ctx:t}}}),s.$on("click",t[53]),l=new bi({props:{disabled:t[11],$$slots:{default:[ps]},$$scope:{ctx:t}}}),l.$on("click",t[54]),c=new bi({props:{disabled:t[11],$$slots:{default:[ms]},$$scope:{ctx:t}}}),c.$on("click",t[55]),u=new bi({props:{disabled:!t[7]||!t[7].length,$$slots:{default:[fs]},$$scope:{ctx:t}}}),u.$on("click",t[56]),m=new bi({props:{disabled:!t[8]||!t[8].length,$$slots:{default:[gs]},$$scope:{ctx:t}}}),m.$on("click",t[57]),b=new bi({props:{glow:t[23],$$slots:{default:[bs]},$$scope:{ctx:t}}}),b.$on("click",t[58]);let Yt=ws(t);function te(e){t[59](e)}let ee={label:"Title:",placeholder:"Song name",disabled:t[11]};function ne(e){t[60](e)}void 0!==t[1]&&(ee.value=t[1]),D=new qi({props:ee}),U.push((()=>ot(D,"value",te)));let ie={label:"Link:",placeholder:"Source link (YouTube, Soundcloud, etc)",disabled:t[11]};void 0!==t[2]&&(ie.value=t[2]),O=new qi({props:ie}),U.push((()=>ot(O,"value",ne)));let se={ctx:t,current:null,token:null,hasCatch:!0,pending:ys,then:vs,catch:xs,blocks:[,,,]};function re(e){t[61](e)}rt(P=t[12],se);let ae={disabled:!t[28]};void 0!==t[0]&&(ae.unlocked=t[0]),Z=new Yi({props:ae}),U.push((()=>ot(Z,"unlocked",re))),Z.$on("click",t[62]);let oe=t[3]&&ks(t);function le(e){t[67](e)}function de(e){t[68](e)}function ce(e){t[69](e)}ut=new bi({props:{title:"Add bank",$$slots:{default:[Vs]},$$scope:{ctx:t}}}),ut.$on("click",t[65]);let he={title:"Buildup",beatIndex:t[32],newLineAtBeat:t[26],soundManager:t[10],hiddenBanks:t[5]};function ue(e){t[78](e)}function pe(e){t[79](e)}function me(e){t[80](e)}function fe(e){t[81](e)}void 0!==t[4]&&(he.section=t[4]),void 0!==t[17]&&(he.editBox=t[17]),void 0!==t[9]&&(he.locked=t[9]),mt=new zi({props:he}),t[66](mt),U.push((()=>ot(mt,"section",le))),U.push((()=>ot(mt,"editBox",de))),U.push((()=>ot(mt,"locked",ce))),mt.$on("rewind",t[70]),mt.$on("seek",t[71]),mt.$on("error",t[72]),mt.$on("songload",t[73]),mt.$on("double",t[39]),mt.$on("halve",t[40]),mt.$on("beforeinput",t[41]),mt.$on("afterinput",t[42]),mt.$on("focus",t[43]),mt.$on("songremove",t[74]),mt.$on("songnew",t[75]);let ge={title:"Rhythm",showHelp:!0,beatIndex:t[31],newLineAtBeat:t[26],soundManager:t[10],hiddenBanks:t[5]};void 0!==t[3]&&(ge.section=t[3]),void 0!==t[19]&&(ge.header=t[19]),void 0!==t[18]&&(ge.editBox=t[18]),void 0!==t[9]&&(ge.locked=t[9]),kt=new zi({props:ge}),t[77](kt),U.push((()=>ot(kt,"section",ue))),U.push((()=>ot(kt,"header",pe))),U.push((()=>ot(kt,"editBox",me))),U.push((()=>ot(kt,"locked",fe))),kt.$on("rewind",t[82]),kt.$on("seek",t[83]),kt.$on("error",t[84]),kt.$on("songload",t[85]),kt.$on("double",t[39]),kt.$on("halve",t[40]),kt.$on("beforeinput",t[41]),kt.$on("afterinput",t[42]),kt.$on("focus",t[43]),kt.$on("songremove",t[86]),kt.$on("songnew",t[87]);let be=t[34],we=[];for(let e=0;e<be.length;e+=1)we[e]=$s(os(t,be,e));const xe=t=>st(we[t],1,1,(()=>{we[t]=null}));Tt=new bi({props:{icon:!0,$$slots:{default:[Ts]},$$scope:{ctx:t}}}),Tt.$on("click",t[89]),Bt=new bi({props:{icon:!0,$$slots:{default:[Ls]},$$scope:{ctx:t}}}),Bt.$on("click",t[90]);let ve={ctx:t,current:null,token:null,hasCatch:!0,pending:Ms,then:Ds,catch:Bs,blocks:[,,,]};return rt(Ht=t[12],ve),{c(){e=y("div"),lt(n.$$.fragment),i=_(),lt(s.$$.fragment),a=_(),lt(l.$$.fragment),d=_(),lt(c.$$.fragment),h=_(),lt(u.$$.fragment),p=_(),lt(m.$$.fragment),f=_(),lt(b.$$.fragment),$=_(),Yt.c(),T=_(),L=y("div"),B=y("div"),lt(D.$$.fragment),N=_(),lt(O.$$.fragment),F=_(),R=y("div"),se.block.c(),j=_(),q=y("hr"),W=_(),H=y("div"),lt(Z.$$.fragment),X=_(),G=y("div"),J=y("div"),J.textContent="BANKS",Y=_(),oe&&oe.c(),tt=_(),ht=y("div"),lt(ut.$$.fragment),pt=_(),lt(mt.$$.fragment),wt=_(),xt=y("div"),vt=y("div"),yt=_(),lt(kt.$$.fragment),It=_(),Vt=y("div");for(let t=0;t<we.length;t+=1)we[t].c();Et=_(),$t=y("div"),lt(Tt.$$.fragment),Lt=_(),lt(Bt.$$.fragment),Dt=_(),Mt=y("div"),Nt=_(),Ot=y("span"),zt=k(Jt),Ut=k("x"),Ft=_(),Rt=y("span"),Rt.textContent="New line at beat ",Pt=_(),jt=y("input"),qt=_(),Wt=A(),ve.block.c(),S(e,"class","title-buttons svelte-1jqqz7x"),S(B,"class","info svelte-1jqqz7x"),S(R,"class","settings-individual song-stats svelte-1jqqz7x"),S(L,"class","top-bar svelte-1jqqz7x"),S(q,"class","svelte-1jqqz7x"),S(J,"class","banks-span-both svelte-1jqqz7x"),S(ht,"class","banks-span-both svelte-1jqqz7x"),S(G,"class","banks svelte-1jqqz7x"),S(vt,"class","hues-icon handle svelte-1jqqz7x"),S(xt,"title","Resize"),S(xt,"class","resize-handle svelte-1jqqz7x"),S(Vt,"class","beats svelte-1jqqz7x"),S(Ot,"class","settings-individual"),S(Rt,"class","settings-individual"),S(jt,"class","settings-input svelte-1jqqz7x"),S(jt,"type","number"),S(jt,"min","1"),S($t,"class","controls svelte-1jqqz7x"),S(H,"class","edit-area svelte-1jqqz7x")},m(r,o){w(r,e,o),dt(n,e,null),g(e,i),dt(s,e,null),g(e,a),dt(l,e,null),g(e,d),dt(c,e,null),g(e,h),dt(u,e,null),g(e,p),dt(m,e,null),g(e,f),dt(b,e,null),g(e,$),Yt.m(e,null),w(r,T,o),w(r,L,o),g(L,B),dt(D,B,null),g(B,N),dt(O,B,null),g(L,F),g(L,R),se.block.m(R,se.anchor=null),se.mount=()=>R,se.anchor=null,w(r,j,o),w(r,q,o),w(r,W,o),w(r,H,o),dt(Z,H,null),g(H,X),g(H,G),g(G,J),g(G,Y),oe&&oe.m(G,null),g(G,tt),g(G,ht),dt(ut,ht,null),g(H,pt),dt(mt,H,null),g(H,wt),g(H,xt),g(xt,vt),vt.innerHTML=Gt,t[76](xt),g(H,yt),dt(kt,H,null),g(H,It),g(H,Vt);for(let t=0;t<we.length;t+=1)we[t].m(Vt,null);g(H,Et),g(H,$t),dt(Tt,$t,null),g($t,Lt),dt(Bt,$t,null),g($t,Dt),g($t,Mt),g($t,Nt),g($t,Ot),g(Ot,zt),g(Ot,Ut),g($t,Ft),g($t,Rt),g($t,Pt),g($t,jt),E(jt,t[26]),t[92](H),w(r,qt,o),w(r,Wt,o),ve.block.m(r,ve.anchor=o),ve.mount=()=>Wt.parentNode,ve.anchor=Wt,Kt=!0,Zt||(Qt=[C(xt,"mousedown",t[46]),C(jt,"input",t[91])],Zt=!0)},p(i,r){t=i;const a={};16384&r[3]&&(a.$$scope={dirty:r,ctx:t}),n.$set(a);const d={};2048&r[0]&&(d.disabled=t[11]),16384&r[3]&&(d.$$scope={dirty:r,ctx:t}),s.$set(d);const h={};2048&r[0]&&(h.disabled=t[11]),16384&r[3]&&(h.$$scope={dirty:r,ctx:t}),l.$set(h);const p={};2048&r[0]&&(p.disabled=t[11]),16384&r[3]&&(p.$$scope={dirty:r,ctx:t}),c.$set(p);const f={};128&r[0]&&(f.disabled=!t[7]||!t[7].length),16384&r[3]&&(f.$$scope={dirty:r,ctx:t}),u.$set(f);const g={};256&r[0]&&(g.disabled=!t[8]||!t[8].length),16384&r[3]&&(g.$$scope={dirty:r,ctx:t}),m.$set(g);const w={};8388608&r[0]&&(w.glow=t[23]),16384&r[3]&&(w.$$scope={dirty:r,ctx:t}),b.$set(w),33554432&r[0]&&o(Xt,Xt=t[25])?(Yt.d(1),Yt=ws(t),Yt.c(),Yt.m(e,null)):Yt.p(t,r);const x={};2048&r[0]&&(x.disabled=t[11]),!M&&2&r[0]&&(M=!0,x.value=t[1],K((()=>M=!1))),D.$set(x);const v={};2048&r[0]&&(v.disabled=t[11]),!z&&4&r[0]&&(z=!0,v.value=t[2],K((()=>z=!1))),O.$set(v),se.ctx=t,4096&r[0]&&P!==(P=t[12])&&rt(P,se)||at(se,t,r);const y={};268435456&r[0]&&(y.disabled=!t[28]),!Q&&1&r[0]&&(Q=!0,y.unlocked=t[0],K((()=>Q=!1))),Z.$set(y),t[3]?oe?(oe.p(t,r),8&r[0]&&it(oe,1)):(oe=ks(t),oe.c(),it(oe,1),oe.m(G,tt)):oe&&(et(),st(oe,1,1,(()=>{oe=null})),nt());const k={};16384&r[3]&&(k.$$scope={dirty:r,ctx:t}),ut.$set(k);const _={};2&r[1]&&(_.beatIndex=t[32]),67108864&r[0]&&(_.newLineAtBeat=t[26]),1024&r[0]&&(_.soundManager=t[10]),32&r[0]&&(_.hiddenBanks=t[5]),!ft&&16&r[0]&&(ft=!0,_.section=t[4],K((()=>ft=!1))),!gt&&131072&r[0]&&(gt=!0,_.editBox=t[17],K((()=>gt=!1))),!bt&&512&r[0]&&(bt=!0,_.locked=t[9],K((()=>bt=!1))),mt.$set(_);const A={};if(1&r[1]&&(A.beatIndex=t[31]),67108864&r[0]&&(A.newLineAtBeat=t[26]),1024&r[0]&&(A.soundManager=t[10]),32&r[0]&&(A.hiddenBanks=t[5]),!_t&&8&r[0]&&(_t=!0,A.section=t[3],K((()=>_t=!1))),!At&&524288&r[0]&&(At=!0,A.header=t[19],K((()=>At=!1))),!Ct&&262144&r[0]&&(Ct=!0,A.editBox=t[18],K((()=>Ct=!1))),!St&&512&r[0]&&(St=!0,A.locked=t[9],K((()=>St=!1))),kt.$set(A),536887296&r[0]|8&r[1]){let e;for(be=t[34],e=0;e<be.length;e+=1){const n=os(t,be,e);we[e]?(we[e].p(n,r),it(we[e],1)):(we[e]=$s(n),we[e].c(),it(we[e],1),we[e].m(Vt,null))}for(et(),e=be.length;e<we.length;e+=1)xe(e);nt()}const C={};16384&r[3]&&(C.$$scope={dirty:r,ctx:t}),Tt.$set(C);const S={};16384&r[3]&&(S.$$scope={dirty:r,ctx:t}),Bt.$set(S),(!Kt||134217728&r[0])&&Jt!==(Jt=t[27].toFixed(2)+"")&&V(zt,Jt),67108864&r[0]&&I(jt.value)!==t[26]&&E(jt,t[26]),ve.ctx=t,4096&r[0]&&Ht!==(Ht=t[12])&&rt(Ht,ve)||at(ve,t,r)},i(t){if(!Kt){it(n.$$.fragment,t),it(s.$$.fragment,t),it(l.$$.fragment,t),it(c.$$.fragment,t),it(u.$$.fragment,t),it(m.$$.fragment,t),it(b.$$.fragment,t),it(D.$$.fragment,t),it(O.$$.fragment,t),it(se.block),it(Z.$$.fragment,t),it(oe),it(ut.$$.fragment,t),it(mt.$$.fragment,t),it(kt.$$.fragment,t);for(let t=0;t<be.length;t+=1)it(we[t]);it(Tt.$$.fragment,t),it(Bt.$$.fragment,t),it(ve.block),Kt=!0}},o(t){st(n.$$.fragment,t),st(s.$$.fragment,t),st(l.$$.fragment,t),st(c.$$.fragment,t),st(u.$$.fragment,t),st(m.$$.fragment,t),st(b.$$.fragment,t),st(D.$$.fragment,t),st(O.$$.fragment,t);for(let t=0;t<3;t+=1)st(se.blocks[t]);st(Z.$$.fragment,t),st(oe),st(ut.$$.fragment,t),st(mt.$$.fragment,t),st(kt.$$.fragment,t),we=we.filter(Boolean);for(let t=0;t<we.length;t+=1)st(we[t]);st(Tt.$$.fragment,t),st(Bt.$$.fragment,t);for(let t=0;t<3;t+=1)st(ve.blocks[t]);Kt=!1},d(i){i&&x(e),ct(n),ct(s),ct(l),ct(c),ct(u),ct(m),ct(b),Yt.d(i),i&&x(T),i&&x(L),ct(D),ct(O),se.block.d(),se.token=null,se=null,i&&x(j),i&&x(q),i&&x(W),i&&x(H),ct(Z),oe&&oe.d(),ct(ut),t[66](null),ct(mt),t[76](null),t[77](null),ct(kt),v(we,i),ct(Tt),ct(Bt),t[92](null),i&&x(qt),i&&x(Wt),ve.block.d(i),ve.token=null,ve=null,Zt=!1,r(Qt)}}}function cs(t){let e,n,i,s,r,a,o,l={ctx:t,current:null,token:null,hasCatch:!0,pending:zs,then:Os,catch:Ns};return rt(e=t[12],l),a=new bi({props:{$$slots:{default:[Us]},$$scope:{ctx:t}}}),a.$on("click",t[51]),{c(){l.block.c(),n=_(),i=y("div"),s=y("div"),s.textContent="Ready to go?",r=_(),lt(a.$$.fragment),S(i,"class","editor-gate svelte-1jqqz7x")},m(t,e){l.block.m(t,l.anchor=e),l.mount=()=>n.parentNode,l.anchor=n,w(t,n,e),w(t,i,e),g(i,s),g(i,r),dt(a,i,null),o=!0},p(n,i){t=n,l.ctx=t,4096&i[0]&&e!==(e=t[12])&&rt(e,l);const s={};16384&i[3]&&(s.$$scope={dirty:i,ctx:t}),a.$set(s)},i(t){o||(it(a.$$.fragment,t),o=!0)},o(t){st(a.$$.fragment,t),o=!1},d(t){l.block.d(t),l.token=null,l=null,t&&x(n),t&&x(i),ct(a)}}}function hs(t){let e;return{c(){e=k("New Song")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function us(t){let e;return{c(){e=k("Save ZIP")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function ps(t){let e;return{c(){e=k("Save XML")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function ms(t){let e;return{c(){e=k("Copy XML")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function fs(t){let e;return{c(){e=k("Undo")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function gs(t){let e;return{c(){e=k("Redo")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function bs(e){let n;return{c(){n=y("a"),n.textContent="Help?",S(n,"href","https://github.com/mon/0x40-web/tree/master/docs/Editor.md"),S(n,"target","_blank"),S(n,"class","svelte-1jqqz7x")},m(t,e){w(t,n,e)},p:t,d(t){t&&x(n)}}}function ws(t){let e,n;return{c(){e=y("span"),n=k(t[24]),S(e,"class","status-msg svelte-1jqqz7x")},m(t,i){w(t,e,i),g(e,n)},p(t,e){16777216&e[0]&&V(n,t[24])},d(t){t&&x(e)}}}function xs(e){let n,i,s,r,a,o,l,d;return n=new Zi({props:{label:"Loop",unit:"s",value:"???"}}),s=new Zi({props:{label:"Build",unit:"s",value:"???"}}),a=new Zi({props:{label:"Beats",unit:"ms",value:"???"}}),l=new Zi({props:{label:"",unit:"bpm",value:"???"}}),{c(){lt(n.$$.fragment),i=_(),lt(s.$$.fragment),r=_(),lt(a.$$.fragment),o=_(),lt(l.$$.fragment)},m(t,e){dt(n,t,e),w(t,i,e),dt(s,t,e),w(t,r,e),dt(a,t,e),w(t,o,e),dt(l,t,e),d=!0},p:t,i(t){d||(it(n.$$.fragment,t),it(s.$$.fragment,t),it(a.$$.fragment,t),it(l.$$.fragment,t),d=!0)},o(t){st(n.$$.fragment,t),st(s.$$.fragment,t),st(a.$$.fragment,t),st(l.$$.fragment,t),d=!1},d(t){ct(n,t),t&&x(i),ct(s,t),t&&x(r),ct(a,t),t&&x(o),ct(l,t)}}}function vs(t){let e,n,i,s,r,a,o,l;return e=new Zi({props:{label:"Loop",unit:"s",value:t[10].loop.length.toFixed(2)}}),i=new Zi({props:{label:"Build",unit:"s",value:t[10].build.length.toFixed(2)}}),r=new Zi({props:{label:"Beats",unit:"ms",value:(t[10].loop.length/t[30]*1e3).toFixed(2)}}),o=new Zi({props:{label:"",unit:"bpm",value:(60/(t[10].loop.length/t[30])).toFixed(2)}}),{c(){lt(e.$$.fragment),n=_(),lt(i.$$.fragment),s=_(),lt(r.$$.fragment),a=_(),lt(o.$$.fragment)},m(t,d){dt(e,t,d),w(t,n,d),dt(i,t,d),w(t,s,d),dt(r,t,d),w(t,a,d),dt(o,t,d),l=!0},p(t,n){const s={};1024&n[0]&&(s.value=t[10].loop.length.toFixed(2)),e.$set(s);const a={};1024&n[0]&&(a.value=t[10].build.length.toFixed(2)),i.$set(a);const l={};1073742848&n[0]&&(l.value=(t[10].loop.length/t[30]*1e3).toFixed(2)),r.$set(l);const d={};1073742848&n[0]&&(d.value=(60/(t[10].loop.length/t[30])).toFixed(2)),o.$set(d)},i(t){l||(it(e.$$.fragment,t),it(i.$$.fragment,t),it(r.$$.fragment,t),it(o.$$.fragment,t),l=!0)},o(t){st(e.$$.fragment,t),st(i.$$.fragment,t),st(r.$$.fragment,t),st(o.$$.fragment,t),l=!1},d(t){ct(e,t),t&&x(n),ct(i,t),t&&x(s),ct(r,t),t&&x(a),ct(o,t)}}}function ys(e){let n,i,s,r,a,o,l,d;return n=new Zi({props:{label:"Loop",unit:"s",value:"..."}}),s=new Zi({props:{label:"Build",unit:"s",value:"..."}}),a=new Zi({props:{label:"Beats",unit:"ms",value:"..."}}),l=new Zi({props:{label:"",unit:"bpm",value:"..."}}),{c(){lt(n.$$.fragment),i=_(),lt(s.$$.fragment),r=_(),lt(a.$$.fragment),o=_(),lt(l.$$.fragment)},m(t,e){dt(n,t,e),w(t,i,e),dt(s,t,e),w(t,r,e),dt(a,t,e),w(t,o,e),dt(l,t,e),d=!0},p:t,i(t){d||(it(n.$$.fragment,t),it(s.$$.fragment,t),it(a.$$.fragment,t),it(l.$$.fragment,t),d=!0)},o(t){st(n.$$.fragment,t),st(s.$$.fragment,t),st(a.$$.fragment,t),st(l.$$.fragment,t),d=!1},d(t){ct(n,t),t&&x(i),ct(s,t),t&&x(r),ct(a,t),t&&x(o),ct(l,t)}}}function ks(t){let e,n,i=t[3].banks,s=[];for(let e=0;e<i.length;e+=1)s[e]=Is(ls(t,i,e));const r=t=>st(s[t],1,1,(()=>{s[t]=null}));return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=A()},m(t,i){for(let e=0;e<s.length;e+=1)s[e].m(t,i);w(t,e,i),n=!0},p(t,n){if(40&n[0]|68&n[1]){let a;for(i=t[3].banks,a=0;a<i.length;a+=1){const r=ls(t,i,a);s[a]?(s[a].p(r,n),it(s[a],1)):(s[a]=Is(r),s[a].c(),it(s[a],1),s[a].m(e.parentNode,e))}for(et(),a=i.length;a<s.length;a+=1)r(a);nt()}},i(t){if(!n){for(let t=0;t<i.length;t+=1)it(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)st(s[t]);n=!1},d(t){v(s,t),t&&x(e)}}}function _s(t){let e,n,i,s=t[106]+1+"",r=(t[5][t[106]]?wi.EYE_CLOSED:"&emsp;")+"";return{c(){e=k(s),n=_(),i=y("span"),S(i,"class","hues-icon")},m(t,s){w(t,e,s),w(t,n,s),w(t,i,s),i.innerHTML=r},p(t,e){32&e[0]&&r!==(r=(t[5][t[106]]?wi.EYE_CLOSED:"&emsp;")+"")&&(i.innerHTML=r)},d(t){t&&x(e),t&&x(n),t&&x(i)}}}function As(t){let e,n;return e=new bi({props:{nopad:!0,nouppercase:!0,title:"Remove bank",$$slots:{default:[Ss]},$$scope:{ctx:t}}}),e.$on("click",(function(){return t[64](t[106])})),{c(){lt(e.$$.fragment)},m(t,i){dt(e,t,i),n=!0},p(n,i){t=n;const s={};16384&i[3]&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ct(e,t)}}}function Cs(e){let n;return{c(){n=y("div")},m(t,e){w(t,n,e)},p:t,i:t,o:t,d(t){t&&x(n)}}}function Ss(t){let e;return{c(){e=k("x\r\n                ")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function Is(t){let e,n,i,s,r,a;e=new bi({props:{nopad:!0,title:"Toggle bank visibility",$$slots:{default:[_s]},$$scope:{ctx:t}}}),e.$on("click",(function(){return t[63](t[106])}));const o=[Cs,As],l=[];function d(t,e){return 1==t[3].banks.length?0:1}return i=d(t),s=l[i]=o[i](t),{c(){lt(e.$$.fragment),n=_(),s.c(),r=A()},m(t,s){dt(e,t,s),w(t,n,s),l[i].m(t,s),w(t,r,s),a=!0},p(n,a){t=n;const c={};32&a[0]|16384&a[3]&&(c.$$scope={dirty:a,ctx:t}),e.$set(c);let h=i;i=d(t),i===h?l[i].p(t,a):(et(),st(l[h],1,1,(()=>{l[h]=null})),nt(),s=l[i],s?s.p(t,a):(s=l[i]=o[i](t),s.c()),it(s,1),s.m(r.parentNode,r))},i(t){a||(it(e.$$.fragment,t),it(s),a=!0)},o(t){st(e.$$.fragment,t),st(s),a=!1},d(t){ct(e,t),t&&x(n),l[i].d(t),t&&x(r)}}}function Vs(t){let e;return{c(){e=k("+")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function Es(e){let n,i,s=e[101][0]+"";return{c(){n=k(s),i=_()},m(t,e){w(t,n,e),w(t,i,e)},p:t,d(t){t&&x(n),t&&x(i)}}}function $s(t){let e,n;return e=new bi({props:{title:t[101][1],nouppercase:!0,disabled:!t[29],$$slots:{default:[Es]},$$scope:{ctx:t}}}),e.$on("click",(function(){return t[88](t[101])})),{c(){lt(e.$$.fragment)},m(t,i){dt(e,t,i),n=!0},p(n,i){t=n;const s={};536870912&i[0]&&(s.disabled=!t[29]),16384&i[3]&&(s.$$scope={dirty:i,ctx:t}),e.$set(s)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ct(e,t)}}}function Ts(e){let n,i,s=wi.BACKWARD+"";return{c(){n=new L(!1),i=A(),n.a=i},m(t,e){n.m(s,t,e),w(t,i,e)},p:t,d(t){t&&x(i),t&&n.d()}}}function Ls(e){let n,i,s=wi.FORWARD+"";return{c(){n=new L(!1),i=A(),n.a=i},m(t,e){n.m(s,t,e),w(t,i,e)},p:t,d(t){t&&x(i),t&&n.d()}}}function Bs(e){let n,i;return n=new rs({}),{c(){lt(n.$$.fragment)},m(t,e){dt(n,t,e),i=!0},p:t,i(t){i||(it(n.$$.fragment,t),i=!0)},o(t){st(n.$$.fragment,t),i=!1},d(t){ct(n,t)}}}function Ds(t){let e,n;return e=new rs({props:{soundManager:t[10]}}),{c(){lt(e.$$.fragment)},m(t,i){dt(e,t,i),n=!0},p(t,n){const i={};1024&n[0]&&(i.soundManager=t[10]),e.$set(i)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){ct(e,t)}}}function Ms(e){let n,i;return n=new rs({}),{c(){lt(n.$$.fragment)},m(t,e){dt(n,t,e),i=!0},p:t,i(t){i||(it(n.$$.fragment,t),i=!0)},o(t){st(n.$$.fragment,t),i=!1},d(t){ct(n,t)}}}function Ns(t){let e;return{c(){e=y("div"),$(e,"display","none")},m(t,n){w(t,e,n)},d(t){t&&x(e)}}}function Os(e){return{c:t,m:t,d:t}}function zs(e){return{c:t,m:t,d:t}}function Us(e){let n;return{c(){n=y("span"),n.textContent="Activate Editor",S(n,"class","editor-gate-button svelte-1jqqz7x")},m(t,e){w(t,n,e)},p:t,d(t){t&&x(n)}}}function Fs(t){let e,n,i,s,a,o;const l=[cs,ds],d=[];function c(t,e){return t[6]?0:1}return n=c(t),i=d[n]=l[n](t),{c(){e=y("div"),i.c(),S(e,"class","editor svelte-1jqqz7x")},m(i,r){w(i,e,r),d[n].m(e,null),t[93](e),s=!0,a||(o=[C(window,"resize",t[45]),C(window,"keydown",t[47])],a=!0)},p(t,s){let r=n;n=c(t),n===r?d[n].p(t,s):(et(),st(d[r],1,1,(()=>{d[r]=null})),nt(),i=d[n],i?i.p(t,s):(i=d[n]=l[n](t),i.c()),it(i,1),i.m(e,null))},i(t){s||(it(i),s=!0)},o(t){st(i),s=!1},d(i){i&&x(e),d[n].d(),t[93](null),a=!1,r(o)}}}function Rs(t,e,n){let i,s,r,a,o,{soundManager:l}=e,{huesRoot:d}=e,{beatIndex:c=0}=e,{totallyDisabled:h=!0}=e,{disabled:u=!0}=e,{independentBuild:p=!1}=e,{title:m=""}=e,{source:f=""}=e,{loop:g}=e,{build:b}=e,{undoQueue:w=[]}=e,{redoQueue:x=[]}=e,{hiddenBanks:v=[]}=e,{songLoadPromise:y=Promise.reject()}=e,{locked:k=!1}=e;const _=N();let A,C,S,V,E,$,T,L,B=null,D=!0,z="",F=!1,R=32,P=1;const j=t=>{n(24,z=t),n(25,F=!F)},q=async t=>{var e;void 0!==t&&(b&&t.builds&&n(4,b.banks=t.builds,b),g&&t.loops&&n(3,g.banks=t.loops,g),n(0,p=t.independentBuild),void 0!==t.caret&&(await W(),null===(e=t.editor)||void 0===e||e.setCaret(t.caret)))},H=()=>{let t={independentBuild:p};return b&&(t.builds=[...b.banks]),g&&(t.loops=[...g.banks]),t},K=()=>{x||n(8,x=[]),x.push(H()),q(w.pop()),n(7,w),n(8,x)},Z=()=>{w.push(H()),q(x.pop()),n(7,w),n(8,x)},Q=t=>{w||n(7,w=[]),n(8,x=[]);let e=H();for(t&&Object.assign(e,t),w.push(e);w.length>200;)w.shift();n(7,w)},X=t=>t==T?l.build.length:l.loop.length,G=t=>t==T?L:T,J=t=>{var e;if(null===(e=t.section)||void 0===e||e.recalcBeatString(),p||!a)return;let n=G(t),i=!1;for(let e=0;e<t.section.banks.length;e++){const s=X(t)/t.section.banks[e].length;let r=Math.round(X(n)/s);if(r=Math.max(r,1),r>n.section.banks[e].length){const t=r-n.section.banks[e].length;n.section.banks[e]+=".".repeat(t),i=!0}else r<n.section.banks[e].length&&(n.section.banks[e]=n.section.banks[e].slice(0,r),i=!0)}i&&(n.section.recalcBeatString(),n.section=n.section)},Y=t=>{for(let e=0;e<t.section.banks.length;e++)t.section.banks[e]=t.section.banks[e].replace(/(.)/g,"$1.");t.section=t.section},tt=t=>{for(let e=0;e<t.section.banks.length;e++){let n=t.section.banks[e].replace(/(.)./g,"$1");n||(n="."),t.section.banks[e]=n}t.section=t.section},et=(t,e)=>{Q(),e(t),!p&&a&&(e(G(t)),J(t))},nt=t=>{let e=l.playbackRate;e+=t,l.setRate(e),n(27,P=l.playbackRate)};let it=()=>{n(15,A.style.height=d.clientHeight-250+"px",A)};return M(it),t.$$set=t=>{"soundManager"in t&&n(10,l=t.soundManager),"huesRoot"in t&&n(48,d=t.huesRoot),"beatIndex"in t&&n(49,c=t.beatIndex),"totallyDisabled"in t&&n(6,h=t.totallyDisabled),"disabled"in t&&n(11,u=t.disabled),"independentBuild"in t&&n(0,p=t.independentBuild),"title"in t&&n(1,m=t.title),"source"in t&&n(2,f=t.source),"loop"in t&&n(3,g=t.loop),"build"in t&&n(4,b=t.build),"undoQueue"in t&&n(7,w=t.undoQueue),"redoQueue"in t&&n(8,x=t.redoQueue),"hiddenBanks"in t&&n(5,v=t.hiddenBanks),"songLoadPromise"in t&&n(12,y=t.songLoadPromise),"locked"in t&&n(9,k=t.locked)},t.$$.update=()=>{63&t.$$.dirty[0]&&_("update",{independentBuild:p,title:m,source:f,loop:g,build:b,hiddenBanks:v}),16&t.$$.dirty[0]|262144&t.$$.dirty[1]&&n(32,i=c<0&&b?b.mapLen+c:null),262144&t.$$.dirty[1]&&n(31,s=c>=0?c:null),8&t.$$.dirty[0]&&n(30,r=g?g.mapLen:NaN),24&t.$$.dirty[0]&&n(28,a=b&&g),16384&t.$$.dirty[0]&&n(29,o=null!==B)},[p,m,f,g,b,v,h,w,x,k,l,u,y,j,B,A,C,S,V,E,$,T,L,D,z,F,R,P,a,o,r,s,i,_,[["x","Vertical blur"],["o","Horizontal blur"],["-","Change image"],["+","Blackout"],["¤","Whiteout"],["|","Short blackout"],["!","Short whiteout"],[":","Color only"],["*","Image only"],["X","Vertical blur only"],["O","Horizontal blur only"],[")","Trippy cirle in and change image"],["(","Trippy circle out and change image"],[">","Trippy cirle in"],["<","Trippy circle out"],["~","Fade color"],["=","Fade and change image"],["i","Invert all colours"],["I","Invert & change image"],["s","Horizontal slice"],["S","Horizontal slice and change image"],["v","Vertical slice"],["V","Vertical slice and change image"],["#","Double slice"],["@","Double slice and change image"],["←","Shutter left"],["↓","Shutter down"],["↑","Shutter up"],["→","Shutter right"]],K,Z,Q,J,function(){et(this,Y)},function(){et(this,tt)},function(){Q({caret:this.caret,editor:this})},function(){J(this)},function(){n(14,B=this)},nt,it,t=>{t.preventDefault();let e=$.clientHeight,n=S.getBoundingClientRect().top+e/2,i=V.getBoundingClientRect().bottom-E.clientHeight-e/2,s=i-n,r=t=>{let e=(Math.max(n,Math.min(i,t.clientY))-n)/s;C.style.setProperty("--buildup-ratio",e+"fr"),C.style.setProperty("--rhythm-ratio",1-e+"fr")},a=()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",a)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",a)},t=>{if(t.ctrlKey){if("z"==t.key)K();else{if("y"!=t.key)return;Z()}t.preventDefault()}},d,c,()=>{J(L)},()=>{n(6,h=!1)},()=>_("songnew"),()=>_("savezip"),()=>_("savexml"),()=>_("copyxml"),()=>K(),()=>Z(),()=>n(23,D=!1),function(t){m=t,n(1,m)},function(t){f=t,n(2,f)},function(t){p=t,n(0,p)},()=>{Q(),J(L)},t=>{n(5,v[t]=!v[t],v)},t=>{Q(),_("removebank",t)},()=>{Q(),_("addbank")},function(t){U[t?"unshift":"push"]((()=>{T=t,n(21,T)}))},function(t){b=t,n(4,b)},function(t){S=t,n(17,S)},function(t){k=t,n(9,k)},()=>l.seek(-l.build.length),t=>l.seek(-l.build.length*(1-t.detail)),t=>j(t.detail),t=>_("loadbuildup",t.detail),t=>_("removebuildup"),function(e){O.call(this,t,e)},function(t){U[t?"unshift":"push"]((()=>{$=t,n(20,$)}))},function(t){U[t?"unshift":"push"]((()=>{L=t,n(22,L)}))},function(t){g=t,n(3,g)},function(t){E=t,n(19,E)},function(t){V=t,n(18,V)},function(t){k=t,n(9,k)},()=>l.seek(0),t=>l.seek(l.loop.length*t.detail),t=>j(t.detail),t=>_("loadrhythm",t.detail),t=>_("removerhythm"),function(e){O.call(this,t,e)},t=>{B&&B.fakeInput(t[0])},()=>{nt(-.25)},()=>{nt(.25)},function(){R=I(this.value),n(26,R)},function(t){U[t?"unshift":"push"]((()=>{C=t,n(16,C)}))},function(t){U[t?"unshift":"push"]((()=>{A=t,n(15,A)}))}]}const Ps=class extends ut{constructor(t){super(),ht(this,t,Rs,Fs,o,{soundManager:10,huesRoot:48,beatIndex:49,totallyDisabled:6,disabled:11,independentBuild:0,title:1,source:2,loop:3,build:4,undoQueue:7,redoQueue:8,hiddenBanks:5,songLoadPromise:12,locked:9,alert:13,resyncEditors:50},as,[-1,-1,-1,-1])}get alert(){return this.$$.ctx[13]}get resyncEditors(){return this.$$.ctx[50]}};class js{constructor(t,e){if(this.core=t,!t.settings.enableWindow)return;this.midUpdate=!1;let n=e.addTab("EDITOR");this.editor=new Ps({target:n,props:{huesRoot:this.core.root,soundManager:this.core.soundManager,totallyDisabled:!1}}),t.addEventListener("newsong",(t=>{this.midUpdate||(this.song=t,this.editor.$set({independentBuild:null==t?void 0:t.independentBuild,title:null==t?void 0:t.title,source:null==t?void 0:t.source,loop:null==t?void 0:t.loop,build:null==t?void 0:t.build,undoQueue:null==t?void 0:t.undoQueue,redoQueue:null==t?void 0:t.redoQueue,hiddenBanks:null==t?void 0:t.hiddenBanks,disabled:!t}))})),t.soundManager.addEventListener("songloading",((t,e)=>{this.editor.$set({songLoadPromise:t})})),t.addEventListener("beat",((t,e)=>{this.editor.$set({beatIndex:e})})),this.editor.$on("update",(e=>{t.currentSong&&(Object.assign(t.currentSong,e.detail),this.core.updateBeatLength(),this.core.recalcBeatIndex(),this.midUpdate=!0,this.core.callEventListeners("newsong",t.currentSong),this.midUpdate=!1)})),this.editor.$on("loadbuildup",(t=>this.onLoadAudio("build",t.detail))),this.editor.$on("loadrhythm",(t=>this.onLoadAudio("loop",t.detail))),this.editor.$on("removebuildup",(t=>this.onRemoveAudio("build"))),this.editor.$on("removerhythm",(t=>this.onRemoveAudio("loop"))),this.editor.$on("addbank",(t=>this.addBank())),this.editor.$on("removebank",(t=>this.removeBank(t.detail))),this.editor.$on("songnew",(t=>this.newSong())),this.editor.$on("savezip",(t=>this.saveZIP())),this.editor.$on("savexml",(t=>this.saveXML())),this.editor.$on("copyxml",(t=>this.copyXML()))}other(t){return{build:"loop",loop:"build"}[t]}async onLoadAudio(t,e){var n,i;this.newSong(this.song),this.editor.$set({[t]:e});let s=!(null===(n=this.song[t])||void 0===n?void 0:n.sound)&&!!(null===(i=this.song[this.other(t)])||void 0===i?void 0:i.sound);this.song.loop.sound&&(await this.core.soundManager.playSong(this.song,!0,!0),s&&this.setIndependentBuild(!1),this.editor.resyncEditors(),this.core.updateBeatLength(),this.core.recalcBeatIndex())}onRemoveAudio(t){this.song.loop.sound?this.core.soundManager.playSong(this.song,!0,!0):this.core.soundManager.stop(),"build"==t&&this.editor.$set({build:void 0})}addBank(){this.song&&(this.song.addBank(),this.editor.$set({loop:this.song.loop,build:this.song.build,hiddenBanks:this.song.hiddenBanks}))}removeBank(t){this.song&&(this.song.removeBank(t),this.editor.$set({loop:this.song.loop,build:this.song.build,hiddenBanks:this.song.hiddenBanks}))}newSong(t){t||((t=new di("Title")).loop.banks=["x...o...x...o..."],this.respack||(this.respack=new pi,this.respack.name="Editor Respack",this.respack.author="You!",this.respack.description="An internal resourcepack for editing new songs",this.core.resourceManager.addPack(this.respack)),this.respack.songs.push(t),this.core.resourceManager.rebuildArrays(),this.core.resourceManager.rebuildEnabled(),this.core.setSongOject(t)),this.updateIndependentBuild(),this.editor.$set({locked:!1}),window.onbeforeunload=()=>"Unsaved beatmap - leave anyway?"}updateIndependentBuild(){var t,e,n;!!(null===(e=null===(t=this.song)||void 0===t?void 0:t.build)||void 0===e?void 0:e.sound)!=!!(null===(n=this.song)||void 0===n?void 0:n.loop.sound)&&this.setIndependentBuild(!0)}setIndependentBuild(t){this.editor.$set({independentBuild:t})}generateXML(t){var e;if(!this.song)return null;let n;t||(t=bt().begin()),n=t.ele("song",{name:this.song.loop.basename}),n.ele("title",this.song.title),this.song.source&&n.ele("source",this.song.source),n.ele("rhythm",this.song.loop.banks[0]);for(let t=1;t<this.song.loop.banks.length;t++)n.ele("rhythm"+(t+1),this.song.loop.banks[t]);if(null===(e=this.song.build)||void 0===e?void 0:e.sound){n.ele("buildup",this.song.build.basename),n.ele("buildupRhythm",this.song.build.banks[0]);for(let t=1;t<this.song.build.banks.length;t++)n.ele("buildupRhythm"+(t+1),this.song.build.banks[t]);this.song.independentBuild&&n.ele("independentBuild","true")}return t.end({pretty:!0})}downloadURI(t,e){let n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}async addSectionToZip(t,e){if(!(null==e?void 0:e.sound))return;const n=new Uint8Array(e.sound);await t.add(e.filename,new dn(n))}async saveZIP(){let t=this.generateXML(bt().create("songs"));if(!t)return;const e=new Jn(new an("application/zip"));await e.add("songs.xml",new sn(t)),await this.addSectionToZip(e,this.song.loop),await this.addSectionToZip(e,this.song.build);const n=await e.close();this.downloadURI(n,"0x40Hues - "+this.song.loop.basename+".zip"),window.onbeforeunload=null}saveXML(){let t=this.generateXML(bt().create("songs"));t&&(this.downloadURI("data:text/plain;charset=utf-8,"+encodeURIComponent(t),"0x40Hues - "+this.song.loop.basename+".xml"),window.onbeforeunload=null)}copyXML(){let t=this.generateXML();if(!t)return;let e,n=document.createElement("textarea");n.className="copybox",n.value=t,document.body.appendChild(n),n.select();try{e=document.execCommand("copy")}catch(t){e=!1}document.body.removeChild(n),e?this.editor.alert("Beatmap XML copied to clipboard!"):this.editor.alert("Copy failed! Try saving instead")}}class qs{constructor(t){this.eventListeners=t}callEventListeners(t,...e){for(const n of this.eventListeners[t])n(...e)}addEventListener(t,e){this.eventListeners[t].push(e)}removeEventListener(t,e){this.eventListeners[t]=this.eventListeners[t].filter((function(t){return t!==e}))}}function Ws(t){b(t,"svelte-1nv84h0",'.settings-individual{font-size:8pt;line-height:9pt;padding-left:10px}.buttons.svelte-1nv84h0.svelte-1nv84h0{display:flex;flex-wrap:wrap}input[type="radio"].svelte-1nv84h0.svelte-1nv84h0{display:none}label.svelte-1nv84h0.svelte-1nv84h0{font-size:7pt;text-transform:uppercase;margin:4px 2px;padding:3px;background:rgba(127,127,127, 0.5);border-color:rgb(0,0,0);border-width:1px;border-style:solid;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}label.svelte-1nv84h0.svelte-1nv84h0:hover{background:rgba(200,200,200,0.5)}input[type="radio"].svelte-1nv84h0:checked+label.svelte-1nv84h0{background:rgba(255,255,255, 0.5)}')}function Hs(t,e,n){const i=t.slice();i[7]=e[n];const s=Fi();return i[8]=s,i}function Ks(t){let e,n,i,s,r,a,o,l,d,c=t[7]+"";return{c(){e=y("input"),s=_(),r=y("label"),a=k(c),S(e,"type","radio"),e.__value=n=t[7],e.value=e.__value,S(e,"name",t[2]),S(e,"id",i=t[8]),S(e,"class","svelte-1nv84h0"),t[6][0].push(e),S(r,"for",o=t[8]),S(r,"class","svelte-1nv84h0")},m(n,i){w(n,e,i),e.checked=e.__value===t[0],w(n,s,i),w(n,r,i),g(r,a),l||(d=C(e,"change",t[5]),l=!0)},p(t,i){2&i&&n!==(n=t[7])&&(e.__value=n,e.value=e.__value),1&i&&(e.checked=e.__value===t[0]),2&i&&c!==(c=t[7]+"")&&V(a,c)},d(n){n&&x(e),t[6][0].splice(t[6][0].indexOf(e),1),n&&x(s),n&&x(r),l=!1,d()}}}function Zs(t){let e,n,i,s,r,a,o=t[1].name+"",l=t[1].options,c=[];for(let e=0;e<l.length;e+=1)c[e]=Ks(Hs(t,l,e));const m=t[4].default,f=d(m,t,t[3],null);return{c(){e=y("div"),n=k(o),i=_(),s=y("div");for(let t=0;t<c.length;t+=1)c[t].c();r=_(),f&&f.c(),S(s,"class","buttons svelte-1nv84h0"),S(e,"class","settings-individual")},m(t,o){w(t,e,o),g(e,n),g(e,i),g(e,s);for(let t=0;t<c.length;t+=1)c[t].m(s,null);g(s,r),f&&f.m(s,null),a=!0},p(t,[e]){if((!a||2&e)&&o!==(o=t[1].name+"")&&V(n,o),7&e){let n;for(l=t[1].options,n=0;n<l.length;n+=1){const i=Hs(t,l,n);c[n]?c[n].p(i,e):(c[n]=Ks(i),c[n].c(),c[n].m(s,r))}for(;n<c.length;n+=1)c[n].d(1);c.length=l.length}f&&f.p&&(!a||8&e)&&u(f,m,t,t[3],a?h(m,t[3],e,null):p(t[3]),null)},i(t){a||(it(f,t),a=!0)},o(t){st(f,t),a=!1},d(t){t&&x(e),v(c,t),f&&f.d(t)}}}function Qs(t,e,n){let{$$slots:i={},$$scope:s}=e,{info:r}=e,{value:a}=e;const o=Fi();return t.$$set=t=>{"info"in t&&n(1,r=t.info),"value"in t&&n(0,a=t.value),"$$scope"in t&&n(3,s=t.$$scope)},[a,r,o,s,i,function(){a=this.__value,n(0,a)},[[]]]}const Xs=class extends ut{constructor(t){super(),ht(this,t,Qs,Zs,o,{info:1,value:0},Ws)}};function Gs(t){b(t,"svelte-1ptm3c8",".options.svelte-1ptm3c8{display:flex;flex-wrap:wrap;width:640px;padding:5px}.category.svelte-1ptm3c8{font-size:16px;width:50%;float:left;margin-bottom:10px}span.svelte-1ptm3c8{font-size:7pt;align-self:center}.settings-input{font-family:'PetMe64Web';font-size:7pt;margin:4px 2px;padding:3px;background:rgba(127,127,127, 0.5);border-color:rgb(0,0,0);border-width:1px;border-style:solid;width:2em;-moz-appearance:textfield}.settings-input::-webkit-outer-spin-button,.settings-input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}")}function Js(t,e,n){const i=t.slice();return i[7]=e[n][0],i[8]=e[n][1],i}function Ys(t,e,n){const i=t.slice();return i[11]=e[n],i[12]=e,i[13]=n,i}function tr(t){let e,n,i,s,r,a,o;function l(t,e){return"loop"==t[0].autoSong?nr:"time"==t[0].autoSong?er:void 0}let d=l(t),c=d&&d(t);return{c(){e=y("span"),e.textContent="after",n=_(),i=y("input"),s=_(),c&&c.c(),r=A(),S(e,"class","svelte-1ptm3c8"),S(i,"class","settings-input"),S(i,"type","number"),S(i,"min","1")},m(l,d){w(l,e,d),w(l,n,d),w(l,i,d),E(i,t[0].autoSongDelay),w(l,s,d),c&&c.m(l,d),w(l,r,d),a||(o=C(i,"input",t[4]),a=!0)},p(t,e){1&e&&I(i.value)!==t[0].autoSongDelay&&E(i,t[0].autoSongDelay),d===(d=l(t))&&c?c.p(t,e):(c&&c.d(1),c=d&&d(t),c&&(c.c(),c.m(r.parentNode,r)))},d(t){t&&x(e),t&&x(n),t&&x(i),t&&x(s),c&&c.d(t),t&&x(r),a=!1,o()}}}function er(t){let e,n,i;return{c(){e=y("span"),n=k("min"),i=k(t[2]),S(e,"class","svelte-1ptm3c8")},m(t,s){w(t,e,s),g(e,n),g(e,i)},p(t,e){4&e&&V(i,t[2])},d(t){t&&x(e)}}}function nr(t){let e,n,i;return{c(){e=y("span"),n=k("loop"),i=k(t[2]),S(e,"class","svelte-1ptm3c8")},m(t,s){w(t,e,s),g(e,n),g(e,i)},p(t,e){4&e&&V(i,t[2])},d(t){t&&x(e)}}}function ir(t){let e,n="autoSong"==t[11]&&"off"!=t[0].autoSong&&tr(t);return{c(){n&&n.c(),e=A()},m(t,i){n&&n.m(t,i),w(t,e,i)},p(t,i){"autoSong"==t[11]&&"off"!=t[0].autoSong?n?n.p(t,i):(n=tr(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&x(e)}}}function sr(t){let e,n,i;function s(e){t[5](e,t[11])}let r={info:t[1][t[11]],$$slots:{default:[ir]},$$scope:{ctx:t}};return void 0!==t[0][t[11]]&&(r.value=t[0][t[11]]),e=new Xs({props:r}),U.push((()=>ot(e,"value",s))),{c(){lt(e.$$.fragment)},m(t,n){dt(e,t,n),i=!0},p(i,s){t=i;const r={};2&s&&(r.info=t[1][t[11]]),16389&s&&(r.$$scope={dirty:s,ctx:t}),!n&&9&s&&(n=!0,r.value=t[0][t[11]],K((()=>n=!1))),e.$set(r)},i(t){i||(it(e.$$.fragment,t),i=!0)},o(t){st(e.$$.fragment,t),i=!1},d(t){ct(e,t)}}}function rr(t){let e,n,i,s,r,a=t[7]+"",o=t[8],l=[];for(let e=0;e<o.length;e+=1)l[e]=sr(Ys(t,o,e));const d=t=>st(l[t],1,1,(()=>{l[t]=null}));return{c(){e=y("div"),n=k(a),i=_();for(let t=0;t<l.length;t+=1)l[t].c();s=_(),S(e,"class","category svelte-1ptm3c8")},m(t,a){w(t,e,a),g(e,n),g(e,i);for(let t=0;t<l.length;t+=1)l[t].m(e,null);g(e,s),r=!0},p(t,n){if(15&n){let i;for(o=t[8],i=0;i<o.length;i+=1){const r=Ys(t,o,i);l[i]?(l[i].p(r,n),it(l[i],1)):(l[i]=sr(r),l[i].c(),it(l[i],1),l[i].m(e,s))}for(et(),i=o.length;i<l.length;i+=1)d(i);nt()}},i(t){if(!r){for(let t=0;t<o.length;t+=1)it(l[t]);r=!0}},o(t){l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)st(l[t]);r=!1},d(t){t&&x(e),v(l,t)}}}function ar(t){let e,n,i=Object.entries(t[3]),s=[];for(let e=0;e<i.length;e+=1)s[e]=rr(Js(t,i,e));const r=t=>st(s[t],1,1,(()=>{s[t]=null}));return{c(){e=y("div");for(let t=0;t<s.length;t+=1)s[t].c();S(e,"class","options svelte-1ptm3c8")},m(t,i){w(t,e,i);for(let t=0;t<s.length;t+=1)s[t].m(e,null);n=!0},p(t,[n]){if(15&n){let a;for(i=Object.entries(t[3]),a=0;a<i.length;a+=1){const r=Js(t,i,a);s[a]?(s[a].p(r,n),it(s[a],1)):(s[a]=rr(r),s[a].c(),it(s[a],1),s[a].m(e,null))}for(et(),a=i.length;a<s.length;a+=1)r(a);nt()}},i(t){if(!n){for(let t=0;t<i.length;t+=1)it(s[t]);n=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)st(s[t]);n=!1},d(t){t&&x(e),v(s,t)}}}function or(t,e,n){let i,{settings:s={}}=e,{schema:r}=e;const a=N();var o;return o=()=>{a("update")},D().$$.after_update.push(o),t.$$set=t=>{"settings"in t&&n(0,s=t.settings),"schema"in t&&n(1,r=t.schema)},t.$$.update=()=>{1&t.$$.dirty&&n(2,i=(s.autoSongDelay||0)>1?"s":"")},[s,r,i,{Functionality:["autoSong","autoSongShuffle","autoSongFadeout","playBuildups"],Graphics:["blurAmount","blurDecay","blurQuality","trippyMode"],Visuals:["smartAlign","shuffleImages","colourSet","visualiser"],Interface:["currentUI","blackoutUI","skipPreloader"]},function(){s.autoSongDelay=I(this.value),n(0,s)},function(e,i){t.$$.not_equal(s[i],e)&&(s[i]=e,n(0,s))}]}const lr=class extends ut{constructor(t){super(),ht(this,t,or,ar,o,{settings:0,schema:1},Gs)}},dr={workersPath:"lib/workers/",respacks:[],parseQueryString:!0,respackPath:"respacks/",load:!0,autoplay:!0,overwriteLocal:!1,firstSong:null,firstImage:null,fullAuto:!0,packsURL:"https://cdn.0x40hu.es/getRespacks.php",disableRemoteResources:!1,enableWindow:!0,showWindow:!1,firstWindow:"INFO",preloadPrefix:"0x",preloadBase:16,preloadMax:64,preloadTitle:"",huesName:"0x40 Hues of JS, v%VERSION%",root:null,disableKeyboard:!1,smartAlign:"on",blurAmount:"medium",blurDecay:"fast",blurQuality:"medium",currentUI:"modern",colourSet:"normal",blackoutUI:"off",playBuildups:"on",visualiser:"off",shuffleImages:"on",autoSong:"off",autoSongDelay:5,autoSongShuffle:"on",autoSongFadeout:"on",trippyMode:"off",volume:.7,skipPreloader:"on"},cr={smartAlign:{name:"Smart Align images",options:["off","on"]},blurAmount:{name:"Blur amount",options:["low","medium","high"]},blurDecay:{name:"Blur decay",options:["slow","medium","fast","faster!"]},blurQuality:{name:"Blur quality",options:["low","medium","high","extreme"]},visualiser:{name:"Spectrum analyser",options:["off","on"]},currentUI:{name:"UI style",options:["retro","v4.20","modern","xmas","hlwn","mini"]},colourSet:{name:"Colour set",options:["normal","pastel","v4.20"]},blackoutUI:{name:"Blackout affects UI",options:["off","on"]},playBuildups:{name:"Play buildups",options:["off","once","on"]},autoSong:{name:"AutoSong",options:["off","loop","time"]},autoSongShuffle:{name:"AutoSong shuffle",options:["off","on"]},autoSongFadeout:{name:"AutoSong fade out",options:["off","on"]},trippyMode:{name:"Trippy Mode",options:["off","on"]},shuffleImages:{name:"Shuffle images",options:["off","on"]},skipPreloader:{name:"Skip preloader warning",options:["off","on"]}};class hr extends qs{constructor(t){super({updated:[]}),"1"!=localStorage.settingsVersion&&(localStorage.clear(),localStorage.settingsVersion="1"),this.ephemerals={};for(let e in dr){let n=e;Object.defineProperty(this,n,{set:this.makeSetter(n),get:this.makeGetter(n)}),void 0!==t[n]&&(t.overwriteLocal?this[n]=t[n]:this.ephemerals[n]=t[n])}if(this.parseQueryString){let t=this.getQuerySettings();for(let e in dr){let n=e;void 0!==t[n]&&"respacks"!=n&&(this.ephemerals[n]=t[n])}this.respacks=this.respacks.concat(t.respacks)}}getQuerySettings(){let t={respacks:[]},e=window.location.search.substring(1).split("&");for(let n=0;n<e.length;n++){let i=e[n].split("="),s=decodeURIComponent(i[1]);if("packs"==i[0]||"respacks"==i[0]){let e=s.split(",");for(let n=0;n<e.length;n++)t.respacks.push(this.respackPath+e[n])}else"song"==i[0]?t.firstSong=s:("true"!==s&&"false"!==s||(s="true"==s),t[i[0]]=s)}return t}initUI(t){let e=t.addTab("OPTIONS");this.ui=new lr({target:e,props:{settings:this,schema:cr}}),this.ui.$on("update",(()=>{this.callEventListeners("updated")}))}makeGetter(t){return()=>dr.hasOwnProperty(t)?void 0!==this.ephemerals[t]?this.ephemerals[t]:void 0!==localStorage[t]?localStorage[t]:dr[t]:(console.log("WARNING: Attempted to fetch invalid setting:",t),null)}makeSetter(t){return e=>{if(this.isEphemeral(t))this.ephemerals[t]=e;else{let n=cr[t];if(!n||-1==n.options.indexOf(e))return console.error(e,"is not a valid value for",t),!1;localStorage[t]=e,this.ephemerals[t]=void 0}return this.ui&&this.ui.$set({settings:this}),!0}}isEphemeral(t){return!cr.hasOwnProperty(t)}}class ur extends qs{constructor(t,e){super({windowshown:[],tabselected:[]}),this.hasUI=e.enableWindow,this.window=document.createElement("div"),this.window.className="hues-win-helper",t.appendChild(this.window);let n=document.createElement("div");n.className="hues-win",this.window.appendChild(n);let i=document.createElement("div");i.className="hues-win__closebtn",i.onclick=this.hide.bind(this),n.appendChild(i),this.tabContainer=document.createElement("div"),this.tabContainer.className="hues-win__tabs",n.appendChild(this.tabContainer),this.contentContainer=document.createElement("div"),this.contentContainer.className="hues-win__content",n.appendChild(this.contentContainer),this.contents=[],this.tabs=[],this.tabNames=[],e.showWindow?this.show():this.hide()}addTab(t,e){let n=document.createElement("div");n.textContent=t,n.className="tab-label",n.onclick=()=>this.selectTab(t),this.tabContainer.appendChild(n),this.tabs.push(n),this.tabNames.push(t);let i=document.createElement("div");return i.className="tab-content",e&&i.appendChild(e),this.contentContainer.appendChild(i),this.contents.push(i),i}selectTab(t,e){if(this.hasUI){e||this.show();for(let e=0;e<this.tabNames.length;e++){let n=this.tabNames[e];t.toLowerCase()==n.toLowerCase()?(this.contents[e].classList.add("tab-content--active"),this.tabs[e].classList.add("tab-label--active"),this.callEventListeners("tabselected",n)):(this.contents[e].classList.remove("tab-content--active"),this.tabs[e].classList.remove("tab-label--active"))}}}hide(){this.hasUI&&(this.window.classList.add("hidden"),this.callEventListeners("windowshown",!1))}show(){this.hasUI&&(this.window.classList.remove("hidden"),this.callEventListeners("windowshown",!0))}toggle(){this.hasUI&&(this.window.classList.contains("hidden")?this.show():this.hide())}}class pr{constructor(t,e){t&&(this.root=document.createElement("div"),this.root.className=e||this.constructor.name,t.appendChild(this.root),this.root.style.visibility="hidden",this.callbacks=[],this.hidden=!1,this.initUI())}addCoreCallback(t,e){this.callbacks.push({name:t,func:e})}initUI(){let t=document.createElement("div");this.imageName=t,this.imageLink=document.createElement("a"),this.imageLink.target="_blank",this.imageName.appendChild(this.imageLink);let e=document.createElement("div");this.songName=e,this.songLink=document.createElement("a"),this.songLink.target="_blank",this.songName.appendChild(this.songLink);let n=document.createElement("div");this.hueName=n;let i=document.createElement("div");i.textContent="<",i.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.previousImage()},this.imagePrev=i;let s=document.createElement("div");s.textContent=">",s.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.nextImage()},this.imageNext=s;let r=document.createElement("div");r.textContent="<",this.songPrev=r,r.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.previousSong()};let a=document.createElement("div");a.textContent=">",a.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.nextSong()},this.songNext=a;let o=document.createElement("div");o.textContent="SONGS",o.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.toggleSongList()},this.songList=o;let l=document.createElement("div");l.textContent="IMAGES",l.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.toggleImageList()},this.imageList=l,this.timer=document.createElement("div"),this.timer.textContent="T=$0x00000",this.beatCount=document.createElement("div"),this.beatCount.textContent="B=$0x0000",this.xBlur=document.createElement("div"),this.xBlur.textContent="X=$0x00",this.yBlur=document.createElement("div"),this.yBlur.textContent="Y=$0x00",this.settingsToggle=document.createElement("div"),this.settingsToggle.innerHTML=wi.COG,this.settingsToggle.className="hues-icon",this.settingsToggle.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.window.toggle()},this.hideToggle=document.createElement("div"),this.hideToggle.innerHTML="&#x25BC;",this.hideToggle.onclick=()=>{this.toggleHide()},this.listContainer=document.createElement("div"),this.visualiserContainer=document.createElement("div"),this.addCoreCallback("newsong",this.newSong.bind(this)),this.addCoreCallback("newimage",this.newImage.bind(this)),this.addCoreCallback("newcolour",this.newColour.bind(this)),this.addCoreCallback("blurupdate",this.blurUpdated.bind(this)),this.addCoreCallback("time",this.updateTime.bind(this)),this.addCoreCallback("invert",this.invert.bind(this)),this.resizeHandler=this.resize.bind(this)}connectCore(t){this.core=t,this.root.style.visibility="visible",t.resourceManager.hasUI&&this.listContainer.appendChild(t.resourceManager.listView),this.visualiserContainer.appendChild(this.core.visualiser),this.callbacks.forEach((function(e){t.addEventListener(e.name,e.func)})),window.addEventListener("resize",this.resizeHandler),this.resizeHandler()}disconnect(){for(this.callbacks.forEach((t=>{this.core.removeEventListener(t.name,t.func)})),this.core=void 0,this.root.style.visibility="hidden";this.listContainer.firstElementChild;)this.listContainer.removeChild(this.listContainer.firstElementChild);for(;this.visualiserContainer.firstElementChild;)this.visualiserContainer.removeChild(this.visualiserContainer.firstElementChild);window.removeEventListener("resize",this.resizeHandler)}show(){this.root.style.visibility="visible"}hide(){this.root.style.visibility="hidden"}toggleHide(){this.hidden=!this.hidden,this.hidden?this.root.classList.add("hues-ui--hidden"):this.root.classList.remove("hues-ui--hidden")}resize(){}updateVolume(t){}newSong(t){t&&(this.songLink.textContent=t.title.toUpperCase(),this.songLink.href=t.source)}newImage(t){if(!t)return;let e=t.fullname?t.fullname:t.name;this.imageLink.textContent=e.toUpperCase(),this.imageLink.href=t.source?t.source:""}newColour(t){this.hueName.textContent=t.n.toUpperCase()}blurUpdated(t,e){t=Math.floor(255*t),e=Math.floor(255*e),this.xBlur.textContent="X="+this.intToHex(t,2),this.yBlur.textContent="Y="+this.intToHex(e,2)}updateTime(t){t=Math.floor(1e3*t),this.timer.textContent="T="+this.intToHex(t,5)}intToHex(t,e){let n=Math.abs(t).toString(16);for(;n.length<e;)n="0"+n;return(t<0?"-":"$")+"0x"+n}invert(t){t?this.root.classList.add("inverted"):this.root.classList.remove("inverted")}}class mr extends pr{constructor(t,e){super(t,e||"RetroUI")}initUI(){super.initUI();let t=document.createElement("div");t.className="hues-r-container",this.root.appendChild(t),this.container=t,this.mode=document.createElement("div"),t.appendChild(this.mode),t.appendChild(this.imageName),t.appendChild(this.timer),t.appendChild(this.beatCount),t.appendChild(this.xBlur),t.appendChild(this.yBlur),this.colourIndex=document.createElement("div"),this.colourIndex.textContent="C=$0x00",t.appendChild(this.colourIndex),this.version=document.createElement("div"),t.appendChild(this.version),t.appendChild(this.hueName),t.appendChild(this.songName),this.beatBar=document.createElement("div"),t.appendChild(this.beatBar),this.controls=document.createElement("div"),this.controls.className="hues-r-controls";let e=document.createElement("div");this.imageModeManual=document.createElement("div"),this.imageModeManual.textContent="NORMAL",this.imageModeManual.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.setIsFullAuto(!1)},this.imageModeManual.className="hues-r-manualmode hues-r-button",this.imageModeAuto=document.createElement("div"),this.imageModeAuto.textContent="FULL AUTO",this.imageModeAuto.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.setIsFullAuto(!0)},this.imageModeAuto.className="hues-r-automode hues-r-button",e.appendChild(this.imageModeManual),e.appendChild(this.imageModeAuto),this.imagePrev.className="hues-r-button",this.imageNext.className="hues-r-button",this.songPrev.className="hues-r-button",this.songNext.className="hues-r-button",this.controls.appendChild(this.imagePrev),this.controls.appendChild(e),this.controls.appendChild(this.imageNext),this.songList.className="hues-r-songs hues-r-button",this.controls.appendChild(this.songPrev),this.controls.appendChild(this.songList),this.controls.appendChild(this.songNext),this.root.appendChild(this.controls);let n=document.createElement("div");n.className="hues-r-subcontrols",n.appendChild(this.settingsToggle),this.imageList.textContent="C",n.appendChild(this.imageList),n.appendChild(this.hideToggle),this.subControls=n,this.root.appendChild(n),this.hideRestore=document.createElement("div"),this.hideRestore.className="hues-r-hiderestore",this.hideRestore.innerHTML="&#x25B2;",this.hideRestore.onclick=()=>{this.toggleHide()},this.root.appendChild(this.hideRestore),this.listContainer.className="hues-r-listcontainer",this.root.appendChild(this.listContainer),this.visualiserContainer.className="hues-r-visualisercontainer",this.root.appendChild(this.visualiserContainer),this.addCoreCallback("beat",this.beat.bind(this)),this.addCoreCallback("newmode",this.newMode.bind(this))}toggleHide(){this.hidden=!this.hidden,this.hidden?(this.subControls.classList.add("hues-ui--hidden"),this.controls.classList.add("hues-ui--hidden"),this.container.classList.add("hues-ui--hidden"),this.hideRestore.classList.add("hues-ui--hidden")):(this.subControls.classList.remove("hues-ui--hidden"),this.controls.classList.remove("hues-ui--hidden"),this.container.classList.remove("hues-ui--hidden"),this.hideRestore.classList.remove("hues-ui--hidden"))}connectCore(t){super.connectCore(t),this.version.textContent="V=$"+t.versionHex}newMode(t){this.mode.textContent="M="+(t?"FULL AUTO":"NORMAL")}newImage(t){t&&(this.imageLink.textContent="I="+t.name.toUpperCase(),this.imageLink.href=t.source)}newColour(t){super.newColour(t),this.colourIndex.textContent="C="+this.intToHex(this.core.colourIndex,2)}beat(t,e){let n=t.slice(1);this.beatBar.textContent=">>"+n,this.beatCount.textContent="B="+this.intToHex(e,4)}resize(){this.core.visualiser.width=this.visualiserContainer.offsetWidth,this.core.resizeVisualiser()}}class fr extends mr{constructor(t,e){super(t,e||"MinimalUI")}initUI(){super.initUI(),this.root.removeChild(this.controls),this.root.removeChild(this.subControls),this.container.removeChild(this.beatBar),this.container.innerHTML="",this.container.appendChild(this.beatBar)}}class gr extends mr{constructor(t,e){super(t,e||"WeedUI"),this.xVariance=10,this.yVariance=20}initUI(){super.initUI(),this.container.removeChild(this.beatBar),this.controls.className="hues-w-controls",this.subControls.className="hues-w-subcontrols";let t=document.createElement("div");t.className="hues-w-beatbar",this.root.appendChild(t),this.beatBar=t;let e=document.createElement("div");e.className="hues-w-beatleft",t.appendChild(e),this.beatLeft=e;let n=document.createElement("div");n.className="hues-w-beatright",t.appendChild(n),this.beatRight=n,this.imageModeManual.textContent="ONE",this.imageModeAuto.textContent="MANY",this.visualiserContainer.className+=" hues-w-visualisercontainer"}toggleHide(){super.toggleHide(),this.hidden?this.beatBar.classList.add("hues-ui--hidden"):this.beatBar.classList.remove("hues-ui--hidden")}beat(t,e){let n=t.slice(1);if(this.beatLeft.textContent=n,this.beatRight.textContent=n,this.beatCount.textContent="B="+this.intToHex(e,4),-1!=["x","o","X","O"].indexOf(t[0])){let e=document.createElement("div");e.className="hues-w-beataccent";let n="rotate("+this.round10(15-30*Math.random())+"deg) translate("+this.round10(-this.xVariance/2+Math.random()*this.xVariance)+"px, "+this.round10(30-this.yVariance/2+Math.random()*this.yVariance)+"px)";e.style.transform=n,e.textContent=t[0].toUpperCase(),this.root.appendChild(e),window.setTimeout(this.removeBeat.bind(this,e),1500)}}round10(t){return Math.round(10*t)/10}removeBeat(t){this.root.removeChild(t)}}class br extends pr{constructor(t,e){super(t,e||"ModernUI"),this.textSize_normal=0,this.textSize_small=0,this.songLink_size=0,this.imageLink_size=0,this.currentBeat=".",this.hidden=0}initUI(){super.initUI(),this.imageName.className="hues-m-imagename",this.songName.className="hues-m-songtitle";let t=document.createElement("div");t.className="hues-m-controls",this.root.appendChild(t),this.controls=t,t.appendChild(this.imageName),t.appendChild(this.songName);let e=document.createElement("div");e.className="hues-m-leftbox",t.appendChild(e),this.leftBox=e,this.hueName.className="hues-m-huename",e.appendChild(this.hueName);let n=document.createElement("div");n.className="hues-m-vol-cluster",e.appendChild(n),this.settingsToggle.className+=" hues-m-cog",n.appendChild(this.settingsToggle),this.hideToggle.className="hues-m-hide",n.appendChild(this.hideToggle);let i=document.createElement("div");i.className="hues-m-vol-bar",this.volBar=i,n.appendChild(i);let s=document.createElement("div");s.textContent="VOL",s.className="hues-m-vol-label",s.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.soundManager.toggleMute()},i.appendChild(s),this.volLabel=s,this.infoToggle=document.createElement("div"),this.infoToggle.innerHTML="?",this.infoToggle.className="hues-m-question",this.infoToggle.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.window.selectTab("INFO")},n.appendChild(this.infoToggle);let r=document.createElement("input");r.type="range",r.min="0",r.max="1",r.step="0.1",i.appendChild(r),this.volInput=r,r.oninput=()=>{var t;null===(t=this.core)||void 0===t||t.soundManager.setVolume(parseFloat(r.value))};let a=document.createElement("div");a.className="hues-m-rightbox",t.appendChild(a),this.rightBox=a;let o=document.createElement("div");o.className="hues-m-controlblock",this.songBlock=o,this.songList.className="hues-m-songbutton";let l=document.createElement("div");l.className="hues-m-controlbuttons",this.songPrev.className="hues-m-prevbutton",this.songNext.className="hues-m-nextbutton",this.songShuffle=document.createElement("div"),this.songShuffle.innerHTML=wi.SHUFFLE,this.songShuffle.className="hues-m-actbutton hues-icon",this.songShuffle.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.randomSong()},o.appendChild(this.songList),l.appendChild(this.songPrev),l.appendChild(this.songShuffle),l.appendChild(this.songNext),o.appendChild(l),a.appendChild(o);let d=document.createElement("div");d.className="hues-m-controlblock",this.imageList.className="hues-m-songbutton",this.imageBlock=d;let c=document.createElement("div");c.className="hues-m-controlbuttons",this.imageMode=document.createElement("div"),this.imageMode.innerHTML=wi.PLAY,this.imageMode.className="hues-m-actbutton hues-icon",this.imageMode.onclick=()=>{var t;null===(t=this.core)||void 0===t||t.toggleFullAuto()},this.imagePrev.className="hues-m-prevbutton",this.imageNext.className="hues-m-nextbutton",d.appendChild(this.imageList),c.appendChild(this.imagePrev),c.appendChild(this.imageMode),c.appendChild(this.imageNext),d.appendChild(c),a.appendChild(d);let h=document.createElement("div");h.className="hues-m-leftinfo";let u=document.createElement("div");u.className="hues-m-rightinfo",h.appendChild(this.xBlur),h.appendChild(this.yBlur),u.appendChild(this.timer),u.appendChild(this.beatCount),this.rightInfo=u,this.leftInfo=h,t.appendChild(h),t.appendChild(u),this.visualiserContainer.className="hues-m-visualisercontainer",t.appendChild(this.visualiserContainer);let p=document.createElement("div");p.className="hues-m-beatbar",this.root.appendChild(p),this.beatBar=p;let m=document.createElement("div");m.className="hues-m-beatleft",p.appendChild(m),this.beatLeft=m;let f=document.createElement("div");f.className="hues-m-beatright",p.appendChild(f),this.beatRight=f;let g=document.createElement("div");g.className="hues-m-beatcenter",this.root.appendChild(g),this.beatCenter=g,this.hideRestore=document.createElement("div"),this.hideRestore.className="hues-m-hiderestore",this.hideRestore.onclick=()=>{this.toggleHide()},this.root.appendChild(this.hideRestore),this.listContainer.className="hues-m-listcontainer",this.root.appendChild(this.listContainer),this.addCoreCallback("beat",this.beat.bind(this)),this.addCoreCallback("newmode",this.newMode.bind(this))}toggleHide(){switch(this.beatBar.classList.remove("hues-ui--hidden"),this.beatCenter.classList.remove("hues-ui--hidden"),this.controls.classList.remove("hues-ui--hidden"),this.hideRestore.classList.remove("hues-ui--hidden"),this.hidden){case 1:this.beatBar.classList.add("hues-ui--hidden"),this.beatCenter.classList.add("hues-ui--hidden");case 0:this.controls.classList.add("hues-ui--hidden"),this.hideRestore.classList.add("hues-ui--hidden")}this.hidden=(this.hidden+1)%3}updateVolume(t){this.volInput.value=t.toString(),this.volLabel.textContent=0===t?"(VOL)":"VOL"}newMode(t){this.imageMode.innerHTML=t?wi.PAUSE:wi.PLAY}beat(t,e){this.currentBeat=t[0];let n=t.slice(1);if(this.beatLeft.textContent=n,this.beatRight.textContent=n,"."!=this.currentBeat){for(;this.beatCenter.firstElementChild;)this.beatCenter.removeChild(this.beatCenter.firstElementChild);let t=this.beatCenter.ownerDocument.createElement("span");t.textContent=this.currentBeat,this.beatCenter.appendChild(t)}this.beatCount.textContent="B="+this.intToHex(e,4)}textWidth(t){let e=this.songLink,n=e.innerHTML,i="";for(let t=0;t<100;t++)i+="&nbsp;";e.innerHTML=i,e.className=t;let s=e.offsetWidth/100;return e.innerHTML=n,s}resize(){this.textSize_normal=this.textWidth(""),this.textSize_small=this.textWidth("small"),this.songLink_size=this.songName.clientWidth,this.imageLink_size=this.imageName.clientWidth,this.resizeSong(),this.resizeImage(),this.core.visualiser.width=this.controls.offsetWidth,this.core.resizeVisualiser()}resizeElement(t,e){let n=t.textContent.length;n*this.textSize_normal<e?t.className="":n*this.textSize_small<e?t.className="small":t.className="x-small"}resizeSong(){this.resizeElement(this.songLink,this.songLink_size)}resizeImage(){this.resizeElement(this.imageLink,this.imageLink_size)}newSong(t){super.newSong(t),t&&this.resizeSong()}newImage(t){super.newImage(t),t&&this.resizeImage()}}class wr extends br{constructor(t,e){super(t,e||"XmasUI"),this.initSnow(),this.invert(!0),this.controls.className+=" hues-x-controls",this.beatBar.className+=" hues-x-beatbar",this.lights=[];let n=document.createElement("div");n.className="hues-x-wires";let i=document.createElement("div");i.className="hues-x-wiresleft";for(const t of vr){let e=this.newLight(i);e.style.transform="rotate("+t.angle+"deg)",e.style.left=t.x+"px",e.style.top=t.y+"px",this.lights.push(e)}let s=document.createElement("div");s.className="hues-x-wiresright";for(const t of yr){let e=this.newLight(s);e.style.transform="rotate("+-t.angle+"deg)",e.style.right=t.x+"px",e.style.top=t.y+"px",this.lights.push(e)}let r=document.createElement("div");r.className="hues-x-wiresbottomhelper";let a=document.createElement("div");a.className="hues-x-wiresbottom";for(const t of kr){let e=this.newLight(a);e.style.transform="rotate("+t.angle+"deg)",e.style.left=t.x+"px",e.style.bottom=t.y+"px",this.lights.push(e)}n.appendChild(i),n.appendChild(s),r.appendChild(a),n.appendChild(r),this.root.appendChild(n),this.visualiserContainer.className="hues-x-visualisercontainer",this.controls.removeChild(this.visualiserContainer),this.beatBar.appendChild(this.visualiserContainer)}invert(t){super.invert(t),this.snowContext.fillStyle=t?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.8)"}connectCore(t){super.connectCore(t),this.startSnow()}disconnect(){this.stopSnow(),super.disconnect()}lightOn(t){t.on.className="hues-x-lighton",t.off.className="hues-x-lightoff"}lightOff(t){t.on.className="hues-x-lighton off",t.off.className="hues-x-lightoff off"}lightFadeOut(t){t.on.className="hues-x-lighton hues-x-fade off",t.off.className="hues-x-lightoff hues-x-fade off"}lightRecolour(t){let e=-56*Math.floor(7*Math.random());t.on.style.backgroundPosition=e+"px 0",t.off.style.backgroundPosition=e+"px 0"}randomLight(t){Math.random()>=.5?this.lightOn(t):this.lightOff(t)}newLight(t){let e=document.createElement("div");e.className="hues-x-light";let n=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div");return n.appendChild(i),n.appendChild(s),e.appendChild(n),t.appendChild(e),e.on=i,e.off=s,e.bulb=n,this.randomLight(e),this.lightRecolour(e),e}beat(t,e){if(super.beat(t,e),"."!=this.currentBeat)for(const t of this.lights)switch(this.currentBeat){case":":this.lightOn(t),this.lightRecolour(t);break;case"+":this.lightFadeOut(t);break;default:this.randomLight(t)}}initSnow(){this.snowCanvas=document.createElement("canvas"),this.snowContext=this.snowCanvas.getContext("2d"),this.snowCanvas.width=1280,this.snowCanvas.height=720,this.snowCanvas.style.display="none",this.snowCanvas.className="hues-canvas hues-x-snow",this.root.appendChild(this.snowCanvas),this.snowing=!1,this.maxSnow=30,this.snowAngle=0,this.lastSnow=0,this.snowflakes=[],this.addCoreCallback("frame",this.drawSnow.bind(this))}startSnow(){this.snowing=!0,this.snowCanvas.style.display="block";let t=this.snowCanvas.height,e=this.snowCanvas.width;this.snowAngle=0,this.snowflakes=[];for(let n=0;n<this.maxSnow;n++)this.snowflakes.push({x:Math.random()*e,y:Math.random()*t,r:4*Math.random()+1,d:25*Math.random()});this.lastSnow=Date.now()/1e3}stopSnow(){this.snowing=!1,this.snowCanvas.style.display="none"}drawSnow(){let t=this.snowCanvas.width,e=this.snowCanvas.height,n=Date.now()/1e3,i=this.lastSnow-n;this.lastSnow=n,this.snowContext.clearRect(0,0,t,e),this.snowContext.beginPath();for(let t=0;t<this.maxSnow;t++){let e=this.snowflakes[t];this.snowContext.moveTo(e.x,e.y),this.snowContext.arc(e.x,e.y,e.r,0,2*Math.PI,!0)}this.snowContext.fill(),this.snowAngle+=i/6;for(let n=0;n<this.maxSnow;n++){let i=this.snowflakes[n];i.y+=Math.cos(this.snowAngle+i.d)+1+i.r/2,i.x+=2*Math.sin(this.snowAngle),(i.x>t+5||i.x<-5||i.y>e)&&(n%3>0?this.snowflakes[n]={x:Math.random()*t,y:-10,r:i.r,d:i.d}:Math.sin(this.snowAngle)>0?this.snowflakes[n]={x:-5,y:Math.random()*e,r:i.r,d:i.d}:this.snowflakes[n]={x:t+5,y:Math.random()*e,r:i.r,d:i.d})}}resize(){super.resize();let t=window.innerWidth/window.innerHeight,e=this.snowContext.fillStyle;this.snowCanvas.width=Math.ceil(720*t),this.snowContext.fillStyle=e}}class xr extends br{constructor(t,e){super(t,e||"HalloweenUI"),this.invert(!0)}initUI(){super.initUI(),this.controls.className+=" hues-h-controls",this.beatBar.className+=" hues-h-beatbar",this.leftBox.className+=" hues-h-leftbox",this.rightBox.className+=" hues-h-rightbox",this.volBar.className+=" hues-h-vol-bar",this.beatLeft.className+=" hues-h-text",this.beatRight.className+=" hues-h-text",this.beatCenter.className+=" hues-h-text",this.songShuffle.className+=" hues-h-text",this.songNext.className+=" hues-h-text",this.songPrev.className+=" hues-h-text",this.songList.className+=" hues-h-text",this.songName.className+=" hues-h-text",this.imageMode.className+=" hues-h-text",this.imageNext.className+=" hues-h-text",this.imagePrev.className+=" hues-h-text",this.imageList.className+=" hues-h-text",this.imageName.className+=" hues-h-text",this.hueName.className+=" hues-h-text",this.settingsToggle.className+=" hues-h-text",this.hideToggle.className+=" hues-h-text",this.infoToggle.className+=" hues-h-text",this.volLabel.className+=" hues-h-text",this.timer.className="hues-h-textfade",this.beatCount.className="hues-h-textfade",this.xBlur.className="hues-h-textfade",this.yBlur.className="hues-h-textfade";let t=document.createElement("div");t.className="hues-h-tombstone",this.leftBox.appendChild(t);let e=document.createElement("div");e.className="hues-h-tombstone",this.songBlock.insertBefore(e,this.songBlock.firstChild);let n=document.createElement("div");n.className="hues-h-tombstone",this.imageBlock.insertBefore(n,this.imageBlock.firstChild);let i=document.createElement("div");i.className="hues-h-topleft";let s=document.createElement("div");s.className="hues-h-topright";let r=document.createElement("div");r.className="hues-h-bottomright",this.root.appendChild(i),this.root.appendChild(s),this.root.appendChild(r);let a=document.createElement("div");a.className="hues-h-left-hand",this.beatBar.appendChild(a);let o=document.createElement("div");o.className="hues-h-right-hand",this.beatBar.appendChild(o),this.vignette=document.createElement("div"),this.vignette.className="hues-h-vignette",this.root.appendChild(this.vignette)}beat(t,e){if(super.beat(t,e),"."!=this.currentBeat){let t=this.beatCenter.ownerDocument.createElement("div");t.className="hues-m-beatcenter hues-h-eyes",this.beatCenter.appendChild(t)}}connectCore(t){super.connectCore(t),this.core.preloader.classList.add("hues-h-text")}disconnect(){this.core.preloader.classList.remove("hues-h-text"),super.disconnect()}}const vr=[{angle:122.529582194,x:19.4,y:-19.35},{angle:92.5309436511,x:25.4,y:38.7},{angle:107.530202659,x:39.4,y:107.75},{angle:77.5309700777,x:20.75,y:184.8},{angle:77.5309700777,x:32.3,y:249.8},{angle:107.530202659,x:40.45,y:327.9},{angle:88.3307935055,x:35,y:410.9},{angle:107.530202659,x:54.35,y:490.95},{angle:74.9981580491,x:28.15,y:573.8},{angle:89.9973772074,x:23.45,y:675.35},{angle:107.530202659,x:21.65,y:762.6},{angle:107.530202659,x:15.8,y:842.75},{angle:92.5309436511,x:36.55,y:905.7},{angle:88.3307935055,x:31.1,y:988.7},{angle:107.530202659,x:50.45,y:1068.75},{angle:74.9981580491,x:45.75,y:1158.5},{angle:88.3307935055,x:35.85,y:1238.55}],yr=[{angle:120.001009518,x:33.3,y:-29.75},{angle:90.0026227926,x:35.35,y:53.65},{angle:102.469029922,x:41.5,y:136.5},{angle:91.6692064945,x:22.15,y:216.55},{angle:72.4697973408,x:34.4,y:278.25},{angle:102.469029922,x:45.75,y:361.85},{angle:87.4699314665,x:26.65,y:426.35},{angle:72.4697973408,x:41.6,y:502.15},{angle:102.469029922,x:27.5,y:566},{angle:72.4697973408,x:7.65,y:638.45},{angle:102.469029922,x:11,y:721.25},{angle:76.1887724128,x:7.65,y:792.7},{angle:87.4690563489,x:36.15,y:850.35},{angle:102.46813454,x:16.6,y:924.3},{angle:72.4697973408,x:15.3,y:990.8},{angle:76.1887724128,x:11.95,y:1062.25},{angle:87.4690563489,x:40.45,y:1119.9},{angle:102.46813454,x:20.9,y:1193.85}],kr=[{angle:32.5804579323,x:110.35,y:-12.1},{angle:3.28979777069,x:168.05,y:-5.55},{angle:17.6989154099,x:238.35,y:7.7},{angle:-12.6587029361,x:314.8,y:-10.4},{angle:-12.6587029361,x:379.4,y:1.05},{angle:17.6989154099,x:457.75,y:9.4},{angle:2.59102780115,x:540.6,y:3.75},{angle:17.6989154099,x:620.35,y:22.7},{angle:-15.134241831,x:703,y:-2.9},{angle:2.30443717424,x:804.75,y:-7.85},{angle:17.6989154099,x:892.45,y:-9.55},{angle:17.6989154099,x:971.65,y:-15.5},{angle:3.28979777069,x:1035.2,y:4.35},{angle:2.59102780115,x:1118,y:.2},{angle:17.6989154099,x:1198.05,y:18.95},{angle:-18.378894807,x:1288.2,y:14.2},{angle:-4.561224264,x:1367.9,y:4.6},{angle:32.5804579323,x:1452.6,y:-1.7},{angle:3.28979777069,x:1511.45,y:4.45},{angle:17.6989154099,x:1580.6,y:17.6},{angle:-12.6587029361,x:1656.6,y:-.95},{angle:-12.6587029361,x:1722.1,y:11.1},{angle:17.6989154099,x:1800.5,y:18.8},{angle:2.59102780115,x:1883.1,y:13},{angle:17.6989154099,x:1963,y:32.6},{angle:-15.134241831,x:2045.8,y:7},{angle:2.30443717424,x:2147.55,y:1.55},{angle:17.6989154099,x:2234.1,y:.4},{angle:17.6989154099,x:2315,y:-5.6},{angle:3.28979777069,x:2377.8,y:14.5},{angle:2.59102780115,x:2460.65,y:9.75},{angle:17.6989154099,x:2540.2,y:28.5},{angle:-18.378894807,x:2627.55,y:24.9},{angle:-4.561224264,x:2710.4,y:14.4}];let _r=0;class Ar{constructor(t,e){this.core=t,this.hasUI=!1,this.resourcePacks=[],this.allSongs=[],this.allImages=[],this.enabledSongs=[],this.enabledImages=[],this.progressState=[],this.currentTab=0,this.unique=_r++,this.remotes=null,t.settings.enableWindow&&(this.initUI(),e.addTab("RESOURCES",this.root))}getSizes(t){let e=[];return t.forEach((t=>{let n=new Promise(((e,n)=>{let i=new XMLHttpRequest;i.open("HEAD",t,!0),i.onreadystatechange=function(){if(this.readyState==this.DONE){let t=i.getResponseHeader("Content-Length");if(null===t)return void e(null);let n=parseInt(t);e(n/1024/1024)}},i.onerror=function(){n(Error(i.status+": Could not fetch respack at "+t))},i.send()})).catch((e=>{throw 1012==e.code?Error("Respack at URL "+t+" is restricted. Check CORS."):e}));e.push(n)})),Promise.all(e)}addAll(t,e){e&&(this.progressCallback=e,this.progressState=Array.apply(null,Array(t.length)).map(Number.prototype.valueOf,0));let n=[];for(let e=0;e<t.length;e++){let i=(t,n)=>{this.progressState[e]=t,this.updateProgress(n)},s=new pi;n.push(s.loadFromURL(t[e],i))}return n.reduce(((t,e)=>t.then((()=>e)).then((t=>{this.addPack(t)}))),Promise.resolve())}updateProgress(t){let e=0;for(const t of this.progressState)e+=t;e/=this.progressState.length,this.progressCallback&&this.progressCallback(e,t)}addPack(t){console.log("Added",t.name,"to respacks");let e=this.resourcePacks.length;this.resourcePacks.push(t),this.addResourcesToArrays(t),this.rebuildEnabled(),this.updateTotals(),this.appendListItem("respacks",t.name,"res"+e,this.packsView.respackList,(e=>{t.enabled=e,this.rebuildEnabled()}),(()=>this.selectPack(e)))}addResourcesToArrays(t){this.allImages=this.allImages.concat(t.images),this.allSongs=this.allSongs.concat(t.songs)}rebuildArrays(){this.allSongs=[],this.allImages=[];for(const t of this.resourcePacks)this.addResourcesToArrays(t)}rebuildEnabled(){this.enabledSongs=[],this.enabledImages=[];for(const t of this.resourcePacks)if(!0===t.enabled){for(let e=0;e<t.songs.length;e++){let n=t.songs[e];n.enabled&&-1==this.enabledSongs.indexOf(n)&&this.enabledSongs.push(n)}for(let e=0;e<t.images.length;e++){let n=t.images[e];n.enabled&&-1==this.enabledImages.indexOf(n)&&this.enabledImages.push(n)}}if(this.hasUI){let t=this.enabledSongList;for(;t.firstElementChild;)t.removeChild(t.firstElementChild);let e=this.enabledImageList;for(;e.firstElementChild;)e.removeChild(e.firstElementChild);for(const[e,n]of this.enabledSongs.entries())this.appendSimpleListItem(n.title,t,(()=>{this.core.setSong(e)}));for(const[t,n]of this.enabledImages.entries())this.appendSimpleListItem(n.name,e,(()=>{this.core.setImage(t),this.core.setIsFullAuto(!1)}))}this.updateTotals()}removePack(t){let e=this.resourcePacks.indexOf(t);-1!=e&&(this.resourcePacks.splice(e,1),this.rebuildArrays(),this.rebuildEnabled())}removeAllPacks(){this.resourcePacks=[],this.rebuildArrays(),this.rebuildEnabled()}getSongNames(){let t=[];for(const e of this.allSongs)t.push(e);return t}loadLocal(){console.log("Loading local zip(s)");let t=this.fileInput.files;if(!t)return console.log("...empty or null"),Promise.resolve();let e=Promise.resolve();for(const n of t){let t=new pi;e=e.then((()=>t.loadFromBlob(n,((t,e)=>{this.localProgress(t,e)})))).then((t=>{this.addPack(t),this.localComplete()}))}return e.then((()=>{console.log("Local respack parsing complete")}))}localProgress(t,e){this.hasUI&&(this.packsView.progressStatus.textContent="Processing...",this.packsView.progressBar.style.width=100*t+"%",this.packsView.progressCurrent.textContent=e.filesLoaded.toString(),this.packsView.progressTop.textContent=e.filesToLoad.toString(),this.packsView.progressPercent.textContent=Math.round(100*t)+"%")}localComplete(){let t=this.packsView.progressStatus;t.textContent="Complete",window.setTimeout((function(){t.textContent="Idle"}),2e3),this.packsView.progressBar.style.width="100%",this.packsView.progressCurrent.textContent="0b",this.packsView.progressTop.textContent="0b",this.packsView.progressPercent.textContent="0%"}initUI(){this.packView={},this.packsView={},this.root=document.createElement("div"),this.root.className="respacks";let t=document.createElement("div");t.className="respacks__manager";let e=document.createElement("div");e.textContent="Current respacks",e.className="respacks__header";let n=document.createElement("div");n.className="resource-list",this.packsView.respackList=n;let i=null,s=null;this.core.settings.disableRemoteResources||(i=document.createElement("div"),i.textContent="Remote respacks",i.className="respacks__header",s=document.createElement("div"),s.className="resource-list resource-list--fill",n.classList.add("resource-list--fill"),this.appendSimpleListItem("Click to load the list",s,this.loadRemotes.bind(this)),this.packsView.remoteList=s);let r=document.createElement("div");r.className="respacks-buttons";let a=document.createElement("div");a.className="hues-button hidden",a.textContent="LOAD REMOTE",a.onclick=this.loadCurrentRemote.bind(this);let o=document.createElement("div");o.className="hues-button",o.textContent="LOAD ZIPS",o.onclick=()=>{this.fileInput.click()},r.appendChild(o),r.appendChild(a),this.packsView.loadRemote=a,this.fileInput=document.createElement("input"),this.fileInput.type="file",this.fileInput.accept="application/zip",this.fileInput.multiple=!0,this.fileInput.onchange=this.loadLocal.bind(this);let l=document.createElement("div");l.className="progress-container respacks-bottom-container";let d=document.createElement("div");d.className="progress-bar";let c=document.createElement("span");c.className="progress-bar--filled",d.appendChild(c);let h=document.createElement("div");h.textContent="Idle";let u=document.createElement("div");u.className="stat-text";let p=document.createElement("div");p.textContent="0b";let m=document.createElement("div");m.textContent="0b";let f=document.createElement("div");f.textContent="0%",u.appendChild(p),u.appendChild(m),u.appendChild(f),this.packsView.progressBar=c,this.packsView.progressStatus=h,this.packsView.progressCurrent=p,this.packsView.progressTop=m,this.packsView.progressPercent=f,l.appendChild(h),l.appendChild(d),l.appendChild(u),t.appendChild(e),t.appendChild(n),this.core.settings.disableRemoteResources||(t.appendChild(i),t.appendChild(s)),t.appendChild(r),t.appendChild(l);let g=document.createElement("div");g.className="respacks__display";let b=document.createElement("div");b.textContent="<select a respack>",b.className="respacks__header";let w=document.createElement("div");w.className="stat-text";let x=document.createElement("div"),v=document.createElement("a");v.className="unstyled-link",v.textContent="<author>",x.appendChild(v),w.appendChild(x);let y=document.createElement("div");y.textContent="0b",w.appendChild(y);let k=document.createElement("div");k.className="respack-description",k.textContent="<no description>";let _=document.createElement("div");_.className="respack-tab-container";let A=document.createElement("div");A.textContent="Songs:",A.className="respack-tab respack-tab--checked";let C=document.createElement("div");C.textContent="Images:",C.className="respack-tab";let S=document.createElement("div");S.className="resource-list respack-tab__content respack-tab__content--checked";let I=document.createElement("div");I.className="resource-list respack-tab__content",A.onclick=()=>{A.classList.add("respack-tab--checked"),C.classList.remove("respack-tab--checked"),S.classList.add("respack-tab__content--checked"),I.classList.remove("respack-tab__content--checked"),this.currentTab=0},C.onclick=()=>{C.classList.add("respack-tab--checked"),A.classList.remove("respack-tab--checked"),I.classList.add("respack-tab__content--checked"),S.classList.remove("respack-tab__content--checked"),this.currentTab=1};let V=document.createElement("div");V.className="respacks-buttons respacks-buttons--fill invisible";let E=document.createElement("div");E.textContent="ENABLE ALL",E.className="hues-button",E.onclick=this.enableAll.bind(this);let $=document.createElement("div");$.textContent="INVERT",$.className="hues-button",$.onclick=this.invert.bind(this);let T=document.createElement("div");T.textContent="DISABLE ALL",T.className="hues-button",T.onclick=this.disableAll.bind(this),V.appendChild(E),V.appendChild($),V.appendChild(T);let L=document.createElement("div");L.className="respacks-bottom-container";let B=document.createElement("div");B.className="respacks-count-container";let D=document.createElement("span");D.textContent="Total Songs:";let M=document.createElement("span");M.className="respacks-counts",B.appendChild(D),B.appendChild(M);let N=document.createElement("div");N.className="respacks-count-container";let O=document.createElement("span");O.textContent="Total images:";let z=document.createElement("span");z.className="respacks-counts",N.appendChild(O),N.appendChild(z),L.appendChild(B),L.appendChild(N),this.packView.name=b,this.packView.creator=v,this.packView.size=y,this.packView.desc=k,this.packView.songCount=A,this.packView.imageCount=C,this.packView.songList=S,this.packView.imageList=I,this.packView.packButtons=V,this.packView.totalSongs=M,this.packView.totalImages=z,g.appendChild(b),g.appendChild(w),g.appendChild(k),_.appendChild(A),_.appendChild(C),g.appendChild(_),g.appendChild(S),g.appendChild(I),g.appendChild(V),g.appendChild(L),this.root.appendChild(t),this.root.appendChild(g),this.listView=document.createElement("div"),this.enabledSongList=document.createElement("div"),this.enabledSongList.className="resource-list respacks-enabledsongs hidden",this.enabledImageList=document.createElement("div"),this.enabledImageList.className="resource-list respacks-enabledimages hidden",this.listView.appendChild(this.enabledSongList),this.listView.appendChild(this.enabledImageList),this.hasUI=!0}hideLists(){this.hasUI&&(this.enabledSongList.classList.add("hidden"),this.enabledImageList.classList.add("hidden"))}toggleVisible(t,e){this.hasUI&&(t.classList.contains("hidden")?t.classList.remove("hidden"):t.classList.add("hidden"),e.classList.add("hidden"))}toggleSongList(){this.toggleVisible(this.enabledSongList,this.enabledImageList)}toggleImageList(){this.toggleVisible(this.enabledImageList,this.enabledSongList)}updateTotals(){this.hasUI&&(this.packView.totalSongs.textContent=this.enabledSongs.length+"/"+this.allSongs.length,this.packView.totalImages.textContent=this.enabledImages.length+"/"+this.allImages.length)}truncateNum(t){return Math.round(100*t)/100}selectPack(t){let e=this.resourcePacks[t];this.packView.pack=e,this.packView.packButtons.classList.remove("invisible"),this.packsView.loadRemote.classList.add("hidden"),this.packView.name.textContent=e.name,this.packView.creator.textContent=e.author,this.packView.creator.href=e.link?e.link:"";let n=e.size/1024;this.packView.size.textContent=n<512?this.truncateNum(n)+"kB":this.truncateNum(n/1024)+"MB",this.packView.desc.textContent=e.description,this.packView.songCount.textContent="Songs: "+e.songs.length,this.packView.imageCount.textContent="Images: "+e.images.length;let i=this.packView.songList,s=this.packView.imageList;for(;i.firstElementChild;)i.removeChild(i.firstElementChild);for(;s.firstElementChild;)s.removeChild(s.firstElementChild);for(const[t,n]of e.songs.entries()){let n=e.songs[t];this.appendListItem("songs",n.title||"","song"+t,i,(t=>this.selectResourceCallback(n,t)),(()=>this.clickResourceCallback(n,!0)),n.enabled)}for(const[t,n]of e.images.entries())this.appendListItem("images",n.name,"image"+t,s,(t=>this.selectResourceCallback(n,t)),(()=>this.clickResourceCallback(n,!1)),n.enabled)}selectResourceCallback(t,e){t.enabled=e,this.rebuildEnabled()}clickResourceCallback(t,e){t.enabled||(t.enabled=!0,this.rebuildEnabled(),this.selectPack(this.resourcePacks.indexOf(this.packView.pack))),e?this.core.setSong(this.enabledSongs.indexOf(t)):(this.core.setImage(this.enabledImages.indexOf(t)),this.core.setIsFullAuto(!1))}getEnabledTabContents(){let t=this.packView.pack;return t?0==this.currentTab?{arr:t.songs,elName:"song"}:{arr:t.images,elName:"image"}:null}setAll(t){let e=this.getEnabledTabContents();if(e){for(const[n,i]of e.arr.entries()){const s=t(i.enabled);i.enabled=s,document.getElementById(e.elName+n+"-"+this.unique).checked=s}this.rebuildEnabled()}}enableAll(){this.setAll((()=>!0))}disableAll(){this.setAll((()=>!1))}invert(){this.setAll((t=>!t))}appendListItem(t,e,n,i,s,r,a=!0){if(!this.hasUI)return;let o=document.createElement("div");o.className="respacks-listitem";let l=document.createElement("input");l.type="checkbox",l.name=t,l.value=e,l.id=n+"-"+this.unique,l.checked=a,l.onclick=()=>s(l.checked);let d=document.createElement("label");d.htmlFor=l.id;let c=document.createElement("span");c.textContent=e,c.onclick=r,o.appendChild(l),o.appendChild(d),o.appendChild(c),i.appendChild(o)}loadRemotes(){let t=this.packsView.remoteList;for(;t.firstElementChild;)t.removeChild(t.firstElementChild);let e=this.appendSimpleListItem("Loading...",t),n=()=>{e.textContent="Could not load list! Click to try again",e.onclick=this.loadRemotes.bind(this)},i=new XMLHttpRequest;i.open("GET",this.core.settings.packsURL,!0),i.responseType="json",i.onload=()=>{i.response||n(),this.remotes=i.response,this.populateRemotes()},i.onerror=n,i.send()}populateRemotes(){let t=this.packsView.remoteList;for(;t.firstElementChild;)t.removeChild(t.firstElementChild);for(const[e,n]of this.remotes.entries())n.loaded=!1,this.appendSimpleListItem(n.name,t,(()=>{this.selectRemotePack(e)}))}selectRemotePack(t){let e=this.remotes[t];this.packView.pack=e,this.packView.packButtons.classList.add("invisible"),this.packsView.loadRemote.classList.remove("hidden"),e.loaded?(this.packsView.loadRemote.classList.add("hues-button--loaded"),this.packsView.loadRemote.textContent="LOADED"):(this.packsView.loadRemote.classList.remove("hues-button--loaded"),this.packsView.loadRemote.textContent="LOAD REMOTE"),this.packView.name.textContent=e.name,this.packView.creator.textContent=e.author,this.packView.creator.href=e.link?e.link:"";let n=e.size/1024;this.packView.size.textContent=n<512?this.truncateNum(n)+"kB":this.truncateNum(n/1024)+"MB",this.packView.desc.textContent=e.description,this.packView.songCount.textContent="Songs: "+e.songcount,this.packView.imageCount.textContent="Images: "+e.imagecount;let i=this.packView.songList,s=this.packView.imageList;for(;i.firstElementChild;)i.removeChild(i.firstElementChild);for(;s.firstElementChild;)s.removeChild(s.firstElementChild);for(let t=0;t<e.songs.length;t++){let n=e.songs[t];this.appendSimpleListItem(n,i)}let r=e.songcount-e.songs.length;if(r>0){let t="... and "+r+" more song";r>1&&(t+="s"),this.appendSimpleListItem(t+".",i),this.appendSimpleListItem("Load the respack to show the rest!",i)}for(let t=0;t<e.images.length;t++){let n=e.images[t];this.appendSimpleListItem(n,s)}let a=e.imagecount-e.images.length;if(a>0){let t="... and "+a+" more image";a>1&&(t+="s"),this.appendSimpleListItem(t+".",s),this.appendSimpleListItem("Load the respack to show the rest!",s)}}loadCurrentRemote(){let t=this.packView.pack;void 0===t.loaded||t.loaded||(t.loaded=!0,this.packsView.loadRemote.className="hues-button hues-button--loaded",this.packsView.loadRemote.textContent="LOADING",this.addAll([t.url],((t,e)=>{this.remoteProgress(t,e)})).then(this.remoteComplete.bind(this)))}remoteProgress(t,e){t<.5?(this.packsView.progressStatus.textContent="Downloading...",this.packsView.progressCurrent.textContent=Math.round(e.downloaded/1024)+"b",this.packsView.progressTop.textContent=Math.round(e.size/1024)+"b",this.packsView.progressBar.style.width=2*t*100+"%",this.packsView.progressPercent.textContent=Math.round(2*t*100)+"%"):(this.packsView.progressStatus.textContent="Processing...",this.packsView.progressCurrent.textContent=e.filesLoaded.toString(),this.packsView.progressTop.textContent=e.filesToLoad.toString(),this.packsView.progressBar.style.width=2*(t-.5)*100+"%",this.packsView.progressPercent.textContent=Math.round(2*(t-.5)*100)+"%")}remoteComplete(){let t=this.packsView.progressStatus;t.textContent="Complete",window.setTimeout((function(){t.textContent="Idle"}),2e3),this.packsView.loadRemote.textContent="LOADED",this.packsView.progressBar.style.width="100%",this.packsView.progressCurrent.textContent="0b",this.packsView.progressTop.textContent="0b",this.packsView.progressPercent.textContent="0%"}appendSimpleListItem(t,e,n){let i=document.createElement("div");i.className="respacks-listitem";let s=document.createElement("span");return s.textContent=t.replace(/&amp;/g,"&"),n&&(s.onclick=n),i.appendChild(s),e.appendChild(i),s}}class Cr extends qs{constructor(t,e=1){super({seek:[],songloading:[]}),this.core=t,this.playing=!1,this.playbackRate=1,this.locked=!0,this.oggSupport=!1,this.mp3IsSane=!1,this.build={length:0},this.loop={length:0},this.startTime=0,this.mute=!1,this.lastVol=e,this.vReady=!1,this.vBars=0,this.vTotalBars=0,this.analysers=[],this.analyserArrays=[],this.logArrays=[],this.binCutoffs=[],this.linBins=0,this.logBins=0,this.maxBinLin=0}init(){return this.initPromise||(this.initPromise=this._init()),this.initPromise}async _init(){try{this.context=new AudioContext,this.gainNode=this.context.createGain(),this.replayGainNode=this.context.createGain(),this.gainNode.connect(this.context.destination),this.replayGainNode.connect(this.gainNode)}catch(t){throw Error("Web Audio API not supported in this browser.")}try{await this.context.decodeAudioData(Ir),this.oggSupport=!0}catch(t){this.oggSupport=!1}try{const t=await this.context.decodeAudioData($r);this.mp3IsSane=t.length<10}catch(t){this.mp3IsSane=!1}this.oggSupport&&this.mp3IsSane||await new Promise(((t,e)=>{let n;try{n=this.createWorker()}catch(t){return console.log(t),void e(Error("Audio Worker cannot be started - correct path set in defaults?"))}n.addEventListener("message",(e=>{n.terminate(),t()}),!1),n.addEventListener("error",(()=>{e(Error("Audio Worker cannot be started - correct path set in defaults?"))}),!1),n.postMessage({ping:!0,ogg:this.oggSupport,mp3:this.mp3IsSane})})),this.locked="running"!=this.context.state}unlock(){return this.lockedPromise||(this.lockedPromise=new Promise(((t,e)=>{let n=()=>{let e=this.context.createBuffer(1,1,22050),i=this.context.createBufferSource();i.buffer=e,i.connect(this.context.destination),i.start(0),window.removeEventListener("touchend",n),window.removeEventListener("click",n),this.core.clearMessage(),t()};window.addEventListener("touchend",n,!1),window.addEventListener("click",n,!1)}))),this.lockedPromise}playSong(t,e,n=!1){let i=this._playSong(t,e,n);return this.callEventListeners("songloading",i,t),i}async _playSong(t,e,n){if(this.song==t&&!n)return;if(this.stop(),this.song=t,!t||!t.loop.sound)return;this.gainNode.gain.cancelScheduledValues(0),this.setVolume(this.lastVol),this.mute&&this.setMute(!0);let i=await this.loadSong(t);if(t!=this.song)throw Error("Song changed between load and play - this message can be ignored");this.build.buffer=i.buildup,this.build.length=this.build.buffer?this.build.buffer.duration:0,this.loop.buffer=i.loop,this.loop.length=this.loop.buffer.duration,await this.context.suspend(),e?this.seek(-this.build.length,!0):this.seek(0,!0),await this.context.resume(),this.playing=!0}stop(t){this.playing&&(this.build.source&&(this.build.source.stop(0),this.build.source.disconnect(),this.build.source=void 0,t||(this.build.buffer=void 0)),this.loop.source.stop(0),this.loop.source.disconnect(),this.loop.source=void 0,t||(this.loop.buffer=void 0),this.vReady=!1,this.playing=!1,this.startTime=0)}setRate(t){t=Math.max(Math.min(t,2),.25);let e=this.clampedTime;this.playbackRate=t,this.seek(e)}seek(t,e=!1){if(!this.song)return;if(this.callEventListeners("seek"),t=Math.min(Math.max(t,-this.build.length),this.loop.length),this.stop(!0),!this.loop.buffer)return;this.loop.source=this.context.createBufferSource(),this.loop.source.buffer=this.loop.buffer,this.loop.source.playbackRate.value=this.playbackRate,this.loop.source.loop=!0,this.loop.source.loopStart=0,this.loop.source.loopEnd=this.loop.length,this.loop.source.connect(this.replayGainNode),t<0&&this.build.buffer?(this.build.source=this.context.createBufferSource(),this.build.source.buffer=this.build.buffer,this.build.source.playbackRate.value=this.playbackRate,this.build.source.connect(this.replayGainNode),this.build.source.start(0,this.build.length+t),this.loop.source.start(this.context.currentTime-t/this.playbackRate)):this.loop.source.start(0,t);let n=this.loop.buffer.replayGain;this.build.buffer&&(n=Math.min(n,this.build.buffer.replayGain)),this.replayGainNode.gain.setValueAtTime(n,this.context.currentTime),this.startTime=this.context.currentTime-t/this.playbackRate,e||(this.playing=!0),this.initVisualiser(),this.core.recalcBeatIndex()}get currentTime(){return this.playing?(this.context.currentTime-this.startTime)*this.playbackRate:0}get clampedTime(){let t=this.currentTime;return t>0&&(t%=this.loop.length),t}loadSong(t){var e;if(t._loadPromise)return Promise.reject("Song changed between load and play - this message can be ignored");let n={},i=[this.loadBuffer(t.loop).then((t=>{n.loop=t}))];return(null===(e=t.build)||void 0===e?void 0:e.sound)?i.push(this.loadBuffer(t.build).then((t=>{n.buildup=t}))):this.build.length=0,t._loadPromise=Promise.all(i).then((()=>(t._loadPromise=void 0,n))),t._loadPromise}async loadBuffer(t){let e=t.sound;if(!e)throw Error("Section has no buffer: "+t);let n=new Uint8Array(e);if(this.oggSupport&&79==n[0]&&103==n[1]&&103==n[2]&&83==n[3]||this.mp3IsSane&&255==n[0]&&(251==n[1]||250==n[1]||242==n[1]||243==n[1])||73==n[0]&&68==n[1]&&51==n[2]){let n=e.slice(0),i=await this.context.decodeAudioData(e);return t.sound=n,this.applyGain(i),i}return new Promise(((n,i)=>{let s=this.createWorker();s.addEventListener("error",(()=>{i(Error("Audio Worker failed to convert track"))}),!1),s.addEventListener("message",(e=>{let r=e.data;if(s.terminate(),t.sound=r.arrayBuffer,r.error)return void i(new Error(r.error));let a=this.audioBufFromRaw(r.rawAudio);this.applyGain(a),n(a)}),!1),s.postMessage({buffer:e,ogg:this.oggSupport,mp3:this.mp3IsSane},[e])}))}audioBufFromRaw(t){let e=t.array,n=t.channels,i=e.length/n,s=this.context.createBuffer(n,i,t.sampleRate);for(let t=0;t<n;t++){let n=new Float32Array(e.buffer,t*i*4,i);"function"==typeof s.copyToChannel?s.copyToChannel(n,t,0):s.getChannelData(t).set(n)}return s}applyGain(t){let e=t.getChannelData(0);for(var n=Math.floor(.05*t.sampleRate),i=[],s=0,r=0;r<e.length;r++)s+=Math.pow(e[r],2),r%n==0&&(s=Math.sqrt(s/n),i.push(s),s=0);i.sort((function(t,e){return t-e}));var a=1/i[Math.floor(.95*i.length)];a=Math.max(a,.02),a=Math.min(a,100),t.replayGain=a/4}createWorker(){return new Worker(this.core.settings.workersPath+"audio-worker.js")}initVisualiser(t){t||(t=this.vTotalBars),this.vReady=!1,this.vTotalBars=t;for(let t=0;t<this.analysers.length;t++)this.analysers[t].disconnect();this.splitter&&(this.splitter.disconnect(),this.splitter=void 0),this.analysers=[],this.analyserArrays=[],this.logArrays=[],this.binCutoffs=[],this.linBins=0,this.logBins=0,this.maxBinLin=0,this.attachVisualiser()}attachVisualiser(){if(!this.playing||this.vReady)return;let t=this.loop.source.channelCount;this.splitter=this.context.createChannelSplitter(t),this.loop.source.connect(this.splitter),this.build.source&&this.build.source.connect(this.splitter),this.vBars=Math.floor(this.vTotalBars/t);for(let e=0;e<t;e++){let t=this.context.createAnalyser();try{t.fftSize=8192}catch(e){t.fftSize=2048}t.smoothingTimeConstant=.6,t.minDecibels=-70,t.maxDecibels=-25,this.analyserArrays.push(new Uint8Array(t.frequencyBinCount)),t.getByteTimeDomainData(this.analyserArrays[e]),this.splitter.connect(t,e),this.analysers.push(t),this.logArrays.push(new Uint8Array(this.vBars))}let e=this.analysers[0].frequencyBinCount,n=this.loop.source.buffer.sampleRate/e;this.maxBinLin=Math.floor(2e3/n),this.linBins=Math.min(this.maxBinLin,Math.floor(this.vBars/2)),Math.floor(22e3/n);let i=this.vBars-this.linBins,s=Math.log2(2e3),r=Math.log2(22e3)-s;for(let t=0;t<i;t++){let e=t*(r/i)+s,a=Math.pow(2,e),o=Math.floor(a/n);this.binCutoffs.push(o)}this.vReady=!0}sumArray(t,e,n){let i=0;for(let s=e;s<=n;s++)i+=t[s];return i/(n-e+1)}getVisualiserData(){if(!this.vReady)return null;for(let t=0;t<this.analyserArrays.length;t++){let e=this.analyserArrays[t],n=this.logArrays[t];this.analysers[t].getByteFrequencyData(e);for(let t=0;t<this.linBins;t++){let i=Math.round(t*this.maxBinLin/this.linBins);n[t]=e[i]}n[this.linBins]=e[this.binCutoffs[0]];for(let t=this.linBins+1;t<this.vBars;t++){let i=t-this.linBins;n[t]=this.sumArray(e,this.binCutoffs[i-1],this.binCutoffs[i])}}return this.logArrays}setMute(t){var e;let n;return!this.mute&&t&&(this.lastVol=this.gainNode.gain.value),n=t?0:this.lastVol,this.gainNode.gain.setValueAtTime(n,this.context.currentTime),null===(e=this.core.userInterface)||void 0===e||e.updateVolume(n),this.mute=t,t}toggleMute(){return this.setMute(!this.mute)}decreaseVolume(){this.setMute(!1);let t=Math.max(this.gainNode.gain.value-.1,0);this.setVolume(t)}increaseVolume(){this.setMute(!1);let t=Math.min(this.gainNode.gain.value+.1,1);this.setVolume(t)}setVolume(t){var e;this.gainNode.gain.setValueAtTime(t,this.context.currentTime),this.lastVol=t,null===(e=this.core.userInterface)||void 0===e||e.updateVolume(t)}fadeOut(t){this.mute||(this.gainNode.gain.setValueAtTime(this.lastVol,this.context.currentTime),this.gainNode.gain.exponentialRampToValueAtTime(.01,this.context.currentTime+2)),setTimeout(t,2e3)}}let Sr=atob("T2dnUwACAAAAAAAAAADFYgAAAAAAAMLKRdwBHgF2b3JiaXMAAAAAAUSsAAAAAAAAgLsAAAAAAAC4AU9nZ1MAAAAAAAAAAAAAxWIAAAEAAACcKCV2Dzv/////////////////MgN2b3JiaXMrAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMjAyMDMgKE9tbmlwcmVzZW50KQAAAAABBXZvcmJpcx9CQ1YBAAABABhjVClGmVLSSokZc5QxRplikkqJpYQWQkidcxRTqTnXnGusubUghBAaU1ApBZlSjlJpGWOQKQWZUhBLSSV0EjonnWMQW0nB1phri0G2HIQNmlJMKcSUUopCCBlTjCnFlFJKQgcldA465hxTjkooQbicc6u1lpZji6l0kkrnJGRMQkgphZJKB6VTTkJINZbWUikdc1JSakHoIIQQQrYghA2C0JBVAAABAMBAEBqyCgBQAAAQiqEYigKEhqwCADIAAASgKI7iKI4jOZJjSRYQGrIKAAACABAAAMBwFEmRFMmxJEvSLEvTRFFVfdU2VVX2dV3XdV3XdSA0ZBUAAAEAQEinmaUaIMIMZBgIDVkFACAAAABGKMIQA0JDVgEAAAEAAGIoOYgmtOZ8c46DZjloKsXmdHAi1eZJbirm5pxzzjknm3PGOOecc4pyZjFoJrTmnHMSg2YpaCa05pxznsTmQWuqtOacc8Y5p4NxRhjnnHOatOZBajbW5pxzFrSmOWouxeaccyLl5kltLtXmnHPOOeecc84555xzqhenc3BOOOecc6L25lpuQhfnnHM+Gad7c0I455xzzjnnnHPOOeecc4LQkFUAABAAAEEYNoZxpyBIn6OBGEWIacikB92jwyRoDHIKqUejo5FS6iCUVMZJKZ0gNGQVAAAIAAAhhBRSSCGFFFJIIYUUUoghhhhiyCmnnIIKKqmkoooyyiyzzDLLLLPMMuuws8467DDEEEMMrbQSS0211VhjrbnnnGsO0lpprbXWSimllFJKKQgNWQUAgAAAEAgZZJBBRiGFFFKIIaaccsopqKACQkNWAQCAAAACAAAAPMlzREd0REd0REd0REd0RMdzPEeUREmUREm0TMvUTE8VVdWVXVvWZd32bWEXdt33dd/3dePXhWFZlmVZlmVZlmVZlmVZlmVZgtCQVQAACAAAgBBCCCGFFFJIIaUYY8wx56CTUEIgNGQVAAAIACAAAADAURzFcSRHciTJkixJkzRLszzN0zxN9ERRFE3TVEVXdEXdtEXZlE3XdE3ZdFVZtV1Ztm3Z1m1flm3f933f933f933f933f93UdCA1ZBQBIAADoSI6kSIqkSI7jOJIkAaEhqwAAGQAAAQAoiqM4juNIkiRJlqRJnuVZomZqpmd6qqgCoSGrAABAAAABAAAAAAAomuIppuIpouI5oiNKomVaoqZqriibsuu6ruu6ruu6ruu6ruu6ruu6ruu6ruu6ruu6ruu6ruu6ruu6LhAasgoAkAAA0JEcyZEcSZEUSZEcyQFCQ1YBADIAAAIAcAzHkBTJsSxL0zzN0zxN9ERP9ExPFV3RBUJDVgEAgAAAAgAAAAAAMCTDUixHczRJlFRLtVRNtVRLFVVPVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVNU3TNE0gNGQlAAAEAMBijcHlICElJeXeEMIQk54xJiG1XiEEkZLeMQYVg54yogxy3kLjEIMeCA1ZEQBEAQAAxiDHEHPIOUepkxI556h0lBrnHKWOUmcpxZhizSiV2FKsjXOOUketo5RiLC12lFKNqcYCAAACHAAAAiyEQkNWBABRAACEMUgppBRijDmnnEOMKeeYc4Yx5hxzjjnnoHRSKuecdE5KxBhzjjmnnHNSOieVc05KJ6EAAIAABwCAAAuh0JAVAUCcAIBBkjxP8jRRlDRPFEVTdF1RNF3X8jzV9ExTVT3RVFVTVW3ZVFVZljzPND3TVFXPNFXVVFVZNlVVlkVV1W3TdXXbdFXdlm3b911bFnZRVW3dVF3bN1XX9l3Z9n1Z1nVj8jxV9UzTdT3TdGXVdW1bdV1d90xTlk3XlWXTdW3blWVdd2XZ9zXTdF3TVWXZdF3ZdmVXt11Z9n3TdYXflWVfV2VZGHZd94Vb15XldF3dV2VXN1ZZ9n1b14Xh1nVhmTxPVT3TdF3PNF1XdV1fV13X1jXTlGXTdW3ZVF1ZdmXZ911X1nXPNGXZdF3bNl1Xll1Z9n1XlnXddF1fV2VZ+FVX9nVZ15Xh1m3hN13X91VZ9oVXlnXh1nVhuXVdGD5V9X1TdoXhdGXf14XfWW5dOJbRdX1hlW3hWGVZOX7hWJbd95VldF1fWG3ZGFZZFoZf+J3l9n3jeHVdGW7d58y67wzH76T7ytPVbWOZfd1ZZl93juEYOr/w46mqr5uuKwynLAu/7evGs/u+soyu6/uqLAu/KtvCseu+8/y+sCyj7PrCasvCsNq2Mdy+biy/cBzLa+vKMeu+UbZ1fF94CsPzdHVdeWZdx/Z1dONHOH7KAACAAQcAgAATykChISsCgDgBAI8kiaJkWaIoWZYoiqbouqJouq6kaaapaZ5pWppnmqZpqrIpmq4saZppWp5mmpqnmaZomq5rmqasiqYpy6ZqyrJpmrLsurJtu65s26JpyrJpmrJsmqYsu7Kr267s6rqkWaapeZ5pap5nmqZqyrJpmq6reZ5qep5oqp4oqqpqqqqtqqosW55nmproqaYniqpqqqatmqoqy6aq2rJpqrZsqqptu6rs+rJt67ppqrJtqqYtm6pq267s6rIs27ovaZppap5nmprnmaZpmrJsmqorW56nmp4oqqrmiaZqqqosm6aqypbnmaoniqrqiZ5rmqoqy6Zq2qppmrZsqqotm6Yqy65t+77ryrJuqqpsm6pq66ZqyrJsy77vyqruiqYpy6aq2rJpqrIt27Lvy7Ks+6JpyrJpqrJtqqouy7JtG7Ns+7pomrJtqqYtm6oq27It+7os27rvyq5vq6qs67It+7ru+q5w67owvLJs+6qs+ror27pv6zLb9n1E05RlUzVt21RVWXZl2fZl2/Z90TRtW1VVWzZN1bZlWfZ9WbZtYTRN2TZVVdZN1bRtWZZtYbZl4XZl2bdlW/Z115V1X9d949dl3ea6su3Lsq37qqv6tu77wnDrrvAKAAAYcAAACDChDBQashIAiAIAAIxhjDEIjVLOOQehUco55yBkzkEIIZXMOQghlJI5B6GUlDLnIJSSUgihlJRaCyGUlFJrBQAAFDgAAATYoCmxOEChISsBgFQAAIPjWJbnmaJq2rJjSZ4niqqpqrbtSJbniaJpqqptW54niqapqq7r65rniaJpqqrr6rpomqapqq7ruroumqKpqqrrurKum6aqqq4ru7Ls66aqqqrryq4s+8Kquq4ry7Jt68Kwqq7ryrJs27Zv3Lqu677v+8KRreu6LvzCMQxHAQDgCQ4AQAU2rI5wUjQWWGjISgAgAwCAMAYhgxBCBiGEkFJKIaWUEgAAMOAAABBgQhkoNGRFABAnAAAYQymklFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSCmllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSqmklFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimVUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFIKAJCKcACQejChDBQashIASAUAAIxRSinGnIMQMeYYY9BJKClizDnGHJSSUuUchBBSaS23yjkIIaTUUm2Zc1JaizHmGDPnpKQUW805h1JSi7HmmmvupLRWa64151paqzXXnHPNubQWa64515xzyzHXnHPOOecYc84555xzzgUA4DQ4AIAe2LA6wknRWGChISsBgFQAAAIZpRhzzjnoEFKMOecchBAihRhzzjkIIVSMOeccdBBCqBhzzDkIIYSQOecchBBCCCFzDjroIIQQQgcdhBBCCKGUzkEIIYQQSighhBBCCCGEEDoIIYQQQgghhBBCCCGEUkoIIYQQQgmhlFAAAGCBAwBAgA2rI5wUjQUWGrISAAACAIAclqBSzoRBjkGPDUHKUTMNQkw50ZliTmozFVOQORCddBIZakHZXjILAACAIAAgwAQQGCAo+EIIiDEAAEGIzBAJhVWwwKAMGhzmAcADRIREAJCYoEi7uIAuA1zQxV0HQghCEIJYHEABCTg44YYn3vCEG5ygU1TqIAAAAAAADADgAQDgoAAiIpqrsLjAyNDY4OjwCAAAAAAAFgD4AAA4PoCIiOYqLC4wMjQ2ODo8AgAAAAAAAAAAgICAAAAAAABAAAAAgIBPZ2dTAAQBAAAAAAAAAMViAAACAAAA22A/JwIBAQAK"),Ir=new ArrayBuffer(Sr.length),Vr=new Uint8Array(Ir);for(let t=0;t<Sr.length;t++)Vr[t]=Sr.charCodeAt(t);let Er=atob("//tQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAACAAACcQCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA//////////////////////////////////////////////////////////////////8AAAA5TEFNRTMuMTAwAaUAAAAAAAAAABRAJAa/QgAAQAAAAnFDELIBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/7UMQAA8AAAaQAAAAgAAA0gAAABExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+1LEXYPAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ=="),$r=new ArrayBuffer(Er.length),Tr=new Uint8Array($r);for(let t=0;t<Er.length;t++)Tr[t]=Er.charCodeAt(t);function Lr(t){b(t,"svelte-odsmsf","div.svelte-odsmsf{float:left;font-size:8pt;text-align:left;background:rgba(100,100,100,0.3);border-radius:15px;margin:10px;padding:0 5px}h3.svelte-odsmsf{font-size:10pt;margin:10px 0 0 10px;text-align:left}ul.svelte-odsmsf{list-style-type:none;padding:0;margin:10px}li.svelte-odsmsf{line-height:9pt}")}function Br(t,e,n){const i=t.slice();return i[2]=e[n],i}function Dr(t){let e,n,i=t[2]+"";return{c(){e=y("li"),n=k(i),S(e,"class","svelte-odsmsf")},m(t,i){w(t,e,i),g(e,n)},p(t,e){2&e&&i!==(i=t[2]+"")&&V(n,i)},d(t){t&&x(e)}}}function Mr(e){let n,i,s,r,a,o=e[1],l=[];for(let t=0;t<o.length;t+=1)l[t]=Dr(Br(e,o,t));return{c(){n=y("div"),i=y("h3"),s=k(e[0]),r=_(),a=y("ul");for(let t=0;t<l.length;t+=1)l[t].c();S(i,"class","svelte-odsmsf"),S(a,"class","svelte-odsmsf"),S(n,"class","svelte-odsmsf")},m(t,e){w(t,n,e),g(n,i),g(i,s),g(n,r),g(n,a);for(let t=0;t<l.length;t+=1)l[t].m(a,null)},p(t,[e]){if(1&e&&V(s,t[0]),2&e){let n;for(o=t[1],n=0;n<o.length;n+=1){const i=Br(t,o,n);l[n]?l[n].p(i,e):(l[n]=Dr(i),l[n].c(),l[n].m(a,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=o.length}},i:t,o:t,d(t){t&&x(n),v(l,t)}}}function Nr(t,e,n){let{name:i}=e,{items:s}=e;return t.$$set=t=>{"name"in t&&n(0,i=t.name),"items"in t&&n(1,s=t.items)},[i,s]}const Or=class extends ut{constructor(t){super(),ht(this,t,Nr,Mr,o,{name:0,items:1},Lr)}};function zr(t){b(t,"svelte-102ik4j",".ref.svelte-102ik4j{display:flex;flex-wrap:wrap;width:640px;align-items:center;justify-content:center;padding:5px}.about.svelte-102ik4j{border-bottom:2px solid black}")}function Ur(t){let e,n,i,s,r,a,o,l,d,c,h,u,p,m,f;return u=new Or({props:{name:"Beat glossary",items:t[1]}}),m=new Or({props:{name:"Keyboard shortcuts",items:t[2]}}),{c(){e=y("div"),n=y("div"),i=y("h1"),s=k(t[0]),r=_(),a=y("h2"),a.innerHTML='Adapted from the <a target="_blank" href="http://0x40hues.blogspot.com">0x40 Flash</a>',o=_(),l=y("h2"),l.innerHTML='Web-ified by <a target="_blank" href="https://github.com/mon">mon</a>',d=_(),c=y("h3"),c.innerHTML='With help from <a target="_blank" href="https://github.com/kepstin/0x40hues-html5">Kepstin</a>',h=_(),lt(u.$$.fragment),p=_(),lt(m.$$.fragment),S(n,"class","about svelte-102ik4j"),S(e,"class","ref svelte-102ik4j")},m(t,b){w(t,e,b),g(e,n),g(n,i),g(i,s),g(n,r),g(n,a),g(n,o),g(n,l),g(n,d),g(n,c),g(e,h),dt(u,e,null),g(e,p),dt(m,e,null),f=!0},p(t,[e]){(!f||1&e)&&V(s,t[0])},i(t){f||(it(u.$$.fragment,t),it(m.$$.fragment,t),f=!0)},o(t){st(u.$$.fragment,t),st(m.$$.fragment,t),f=!1},d(t){t&&x(e),ct(u),ct(m)}}}function Fr(t,e,n){let i,{version:s}=e,{huesName:r}=e;return t.$$set=t=>{"version"in t&&n(3,s=t.version),"huesName"in t&&n(4,r=t.huesName)},t.$$.update=()=>{24&t.$$.dirty&&n(0,i=r.replace("%VERSION%",s))},[i,["x Vertical blur (snare)","o Horizontal blur (bass)","- No blur","+ Blackout","¤ Whiteout","| Short blackout","! Short whiteout",": Color only","* Image only","X Vertical blur only","O Horizontal blur only",") Trippy cirle in and change image","( Trippy circle out and change image","> Trippy cirle in","< Trippy circle out","~ Fade color","= Fade and change image","i Invert all colours","I Invert & change image","s Horizontal slice","S Horizontal slice and change image","v Vertical slice","V Vertical slice and change image","# Double slice","@ Double slice and change image","←↓↑→ Shutter"],["↑↓  Change song","←→  Change image","[N] Random song","-+  Change volume","[M] Toggle mute","[B] Restart song from build","[F] Toggle automode","[H] Toggle UI hide","[C] Character list","[S] Song list","[W] Toggle window","[R] Resource packs","[L] Load local zip","[O] Options","[I] Information","[1-6] Change UI","[Alt+Enter] Fullscreen"],s,r]}const Rr=class extends ut{constructor(t){super(),ht(this,t,Fr,Ur,o,{version:3,huesName:4},zr)}};var Pr;n(643),n.p,n.p,function(t){t[t.BlurX=0]="BlurX",t[t.BlurY=1]="BlurY",t[t.TrippyIn=2]="TrippyIn",t[t.TrippyOut=3]="TrippyOut",t[t.Blackout=4]="Blackout",t[t.Whiteout=5]="Whiteout",t[t.ShortBlackout=6]="ShortBlackout",t[t.ShortWhiteout=7]="ShortWhiteout",t[t.RandomColour=8]="RandomColour",t[t.ColourFade=9]="ColourFade",t[t.RandomImage=10]="RandomImage",t[t.SliceX=11]="SliceX",t[t.SliceY=12]="SliceY",t[t.ShutterUp=13]="ShutterUp",t[t.ShutterDown=14]="ShutterDown",t[t.ShutterLeft=15]="ShutterLeft",t[t.ShutterRight=16]="ShutterRight",t[t.InvertToggle=17]="InvertToggle"}(Pr||(Pr={}));const jr=[Pr.RandomColour,Pr.RandomImage],qr={".":[],X:[Pr.BlurY],x:[Pr.BlurY,...jr],O:[Pr.BlurX],o:[Pr.BlurX,...jr],"-":[...jr],"+":[Pr.Blackout,Pr.BlurX],"¤":[Pr.Whiteout,Pr.BlurX],"|":[Pr.ShortBlackout,...jr],"!":[Pr.ShortWhiteout,...jr],":":[Pr.RandomColour],"*":[Pr.RandomImage],")":[Pr.TrippyIn,...jr],"(":[Pr.TrippyOut,...jr],">":[Pr.TrippyIn,Pr.RandomColour],"<":[Pr.TrippyOut,Pr.RandomColour],"~":[Pr.ColourFade],"=":[Pr.ColourFade,Pr.RandomImage],i:[Pr.InvertToggle],I:[Pr.InvertToggle,...jr],s:[Pr.SliceX],S:[Pr.SliceX,...jr],v:[Pr.SliceY],V:[Pr.SliceY,...jr],"#":[Pr.SliceX,Pr.SliceY],"@":[Pr.SliceX,Pr.SliceY,...jr],"←":[Pr.ShutterLeft,...jr],"↓":[Pr.ShutterDown,...jr],"↑":[Pr.ShutterUp,...jr],"→":[Pr.ShutterRight,...jr]},Wr=[{c:0,n:"black"},{c:5570560,n:"brick"},{c:11141120,n:"crimson"},{c:16711680,n:"red"},{c:21760,n:"turtle"},{c:5592320,n:"sludge"},{c:11162880,n:"brown"},{c:16733440,n:"orange"},{c:43520,n:"green"},{c:5614080,n:"grass"},{c:11184640,n:"maize"},{c:16755200,n:"citrus"},{c:65280,n:"lime"},{c:5635840,n:"leaf"},{c:11206400,n:"chartreuse"},{c:16776960,n:"yellow"},{c:85,n:"midnight"},{c:5570645,n:"plum"},{c:11141205,n:"pomegranate"},{c:16711765,n:"rose"},{c:21845,n:"swamp"},{c:5592405,n:"dust"},{c:11162965,n:"dirt"},{c:16733525,n:"blossom"},{c:43605,n:"sea"},{c:5614165,n:"ill"},{c:11184725,n:"haze"},{c:16755285,n:"peach"},{c:65365,n:"spring"},{c:5635925,n:"mantis"},{c:11206485,n:"brilliant"},{c:16777045,n:"canary"},{c:170,n:"navy"},{c:5570730,n:"grape"},{c:11141290,n:"mauve"},{c:16711850,n:"purple"},{c:21930,n:"cornflower"},{c:5592490,n:"deep"},{c:11163050,n:"lilac"},{c:16733610,n:"lavender"},{c:43690,n:"aqua"},{c:5614250,n:"steel"},{c:11184810,n:"grey"},{c:16755370,n:"pink"},{c:65450,n:"bay"},{c:5636010,n:"marina"},{c:11206570,n:"tornado"},{c:16777130,n:"saltine"},{c:255,n:"blue"},{c:5570815,n:"twilight"},{c:11141375,n:"orchid"},{c:16711935,n:"magenta"},{c:22015,n:"azure"},{c:5592575,n:"liberty"},{c:11163135,n:"royalty"},{c:16733695,n:"thistle"},{c:43775,n:"ocean"},{c:5614335,n:"sky"},{c:11184895,n:"periwinkle"},{c:16755455,n:"carnation"},{c:65535,n:"cyan"},{c:5636095,n:"turquoise"},{c:11206655,n:"powder"},{c:16777215,n:"white"}],Hr=[{c:13453898,n:"Mahogany"},{c:16443317,n:"Banana Mania"},{c:10453360,n:"Beaver"},{c:2302755,n:"Black"},{c:12344664,n:"Chestnut"},{c:14521461,n:"Copper"},{c:10145515,n:"Cornflower"},{c:2845892,n:"Denim"},{c:15715768,n:"Desert Sand"},{c:7229792,n:"Eggplant"},{c:1964308,n:"Electric Lime"},{c:7453816,n:"Fern"},{c:16570741,n:"Goldenrod"},{c:11068576,n:"Granny Smith Apple"},{c:9802124,n:"Gray"},{c:1879160,n:"Green"},{c:16719310,n:"Hot Magenta"},{c:11725917,n:"Inch Worm"},{c:6125259,n:"Indigo"},{c:16645236,n:"Laser Lemon"},{c:16561365,n:"Lavender"},{c:16760200,n:"Macaroni and Cheese"},{c:9935530,n:"Manatee"},{c:16745027,n:"Mango Tango"},{c:16628916,n:"Melon"},{c:1722486,n:"Midnight Blue"},{c:16753475,n:"Neon Carrot"},{c:12236908,n:"Olive Green"},{c:16741688,n:"Orange"},{c:15116503,n:"Orchid"},{c:4278860,n:"Outer Space"},{c:16739914,n:"Outrageous Orange"},{c:1878473,n:"Pacific Blue"},{c:12964070,n:"Periwinkle"},{c:9323909,n:"Plum"},{c:7619272,n:"Purple Heart"},{c:14060121,n:"Raw Sienna"},{c:14886251,n:"Razzmatazz"},{c:15605837,n:"Red"},{c:2084555,n:"Robin Egg Blue"},{c:7885225,n:"Royal Purple"},{c:16751530,n:"Salmon"},{c:16525383,n:"Scarlet"},{c:10478271,n:"Sea Green"},{c:10840399,n:"Sepia"},{c:9075037,n:"Shadow"},{c:4574882,n:"Shamrock"},{c:16482045,n:"Shocking Pink"},{c:15526590,n:"Spring Green"},{c:16604755,n:"Sunset Orange"},{c:16426860,n:"Tan"},{c:16550316,n:"Tickle Me Pink"},{c:14407634,n:"Timberwolf"},{c:1540205,n:"Tropical Rain Forest"},{c:7855591,n:"Turquoise Blue"},{c:16752777,n:"Vivid Tangerine"},{c:9392285,n:"Vivid Violet"},{c:15592941,n:"White"},{c:16728996,n:"Wild Strawberry"},{c:16542853,n:"Wild Watermelon"},{c:13477086,n:"Wisteria"},{c:16574595,n:"Yellow"},{c:12968836,n:"Yellow Green"},{c:16758355,n:"Yellow Orange"}],Kr=[{c:65280,n:"Green"},{c:5923665,n:"Lizard"},{c:6516567,n:"Cactus"},{c:4878371,n:"Kakapo"},{c:4018729,n:"Wet Moss"},{c:6659378,n:"Tree Moss"},{c:3297047,n:"Lime Rind"},{c:8357752,n:"Flight Jacket"},{c:12381585,n:"Green Mist"},{c:4751892,n:"Holly"},{c:5732922,n:"Mtn Dew Bottle"},{c:7635561,n:"Seaweed Roll"},{c:8647980,n:"Neon Green"},{c:12638639,n:"Lichen"},{c:10934149,n:"Guacamole"},{c:6848090,n:"Pond Scum"},{c:4153387,n:"Douglas Fir"},{c:4155430,n:"Royal Palm"},{c:6582110,n:"Seaweed"},{c:4680244,n:"Noble Fir"},{c:6159370,n:"Green Led"},{c:4414774,n:"Spinach"},{c:8699498,n:"Frog"},{c:6003812,n:"Emerald"},{c:3827241,n:"Circuit Board"},{c:3178516,n:"Sapgreen"},{c:3258701,n:"Pool Table"},{c:5615162,n:"Leaf"},{c:5094707,n:"Grass"},{c:5860438,n:"Snake"},{c:8832636,n:"100 Euro"},{c:8113264,n:"Night Vision"},{c:10494192,n:"Purple"},{c:10170623,n:"Purple"},{c:9514222,n:"Purple"},{c:8201933,n:"Purple"},{c:11141375,n:"Purple"},{c:8388736,n:"Purple"},{c:10964139,n:"Turnip"},{c:9395865,n:"Violet"},{c:8480391,n:"Eggplant"},{c:13369599,n:"Grape"},{c:8522683,n:"Wild Violet"},{c:6685080,n:"Concord Grape"},{c:7431037,n:"Garden Plum"},{c:11694758,n:"Purple Fish"},{c:6038638,n:"Ultramarine Violet"},{c:6172025,n:"Purple Rose"},{c:6830686,n:"Sea Urchin"},{c:9511326,n:"Cobalt Violet Deep"},{c:9135755,n:"Plum"},{c:10040013,n:"Dark Orchid"},{c:12541951,n:"Violet Flower"},{c:12427467,n:"Purple Candy"},{c:5577355,n:"Deep Purple"},{c:11882652,n:"Thistle"},{c:8855416,n:"Dark Purple"},{c:10251160,n:"Purple Ink"},{c:14381275,n:"Orchid"},{c:10027161,n:"True Purple"},{c:9109643,n:"Darkmagenta"},{c:11935876,n:"Harold's Crayon"},{c:6898825,n:"Purple Rain"},{c:16766720,n:"Gold"}];window.HuesCore=class extends qs{constructor(t){if(super({loaded:[],time:[],blurupdate:[],newsong:[],newimage:[],newcolour:[],newmode:[],beat:[],invert:[],frame:[],songstarted:[],settingsupdated:[]}),this.version=50,this.versionStr=(this.version/10).toFixed(1),this.versionHex=this.version.toString(16),this.beatIndex=0,this.buildLength=-1,this.loopLength=-1,this.currentSong=null,this.currentImage=null,this.songIndex=-1,this.imageIndex=-1,this.lastSongArray=[],this.lastImageArray=[],this.oldColours=Wr,this.weedColours=Kr,this.pastelColours=Hr,this.colourIndex=63,this.colours=this.oldColours,this.invert=!1,this.loopCount=0,this.doBuildup=!0,this.uiArray=[],this.settings=new hr(t),this.settings.root)if("string"==typeof this.settings.root){let t=document.getElementById(this.settings.root);this.root=t||document.body}else this.root=this.settings.root;else this.root=document.body;this.root.classList.add("hues-root"),this.root===document.body&&(document.documentElement.className="hues-root"),this.root.innerHTML="",this.makePreloader(this.root),window.onerror=(t,e,n,i,s)=>(this.error(t),!1),this.window=new ur(this.root,this.settings),console.log("0x40 Hues v"+this.versionStr+" - start your engines!"),this.soundManager=new Cr(this,this.settings.volume),this.resourceManager=new Ar(this,this.window),this.editor=new js(this,this.window),this.settings.initUI(this.window);let e=this.window.addTab("INFO");new Rr({target:e,props:{version:this.versionStr,huesName:this.settings.huesName}}),this.window.selectTab(this.settings.firstWindow,!0);let n=document.createElement("div");n.className="hues-ui",this.root.appendChild(n),this.uiArray.push(new mr(n),new gr(n),new br(n),new wr(n),new xr(n),new fr(n)),this.autoSong=this.settings.autoSong,this.visualiser=document.createElement("canvas"),this.visualiser.className="hues-visualiser",this.visualiser.height=64,this.vCtx=this.visualiser.getContext("2d"),this.asyncInit(),this.settings.disableKeyboard||document.addEventListener("keydown",(t=>{if((t=t||window.event).defaultPrevented)return!0;let e=t.target;if("input"==e.tagName.toLowerCase()||"true"===e.contentEditable)return!0;let n=t.keyCode||t.which;return t.altKey&&13==n&&document.body.requestFullscreen(),!!(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)||this.keyHandler(n)}))}async asyncInit(){try{if(await this.soundManager.init(),this.soundManager.locked||"off"==this.settings.skipPreloader){let t=(await this.resourceManager.getSizes(this.settings.respacks)).reduce(((t,e)=>"number"==typeof t&&"number"==typeof e?t+e:null),0);t="number"==typeof t?t.toFixed(1):'<abbr title="Content-Length header not present for respack URLs">???</abbr>';let e=t+"MB of music/images.<br />Flashing lights.<br /><b>Tap or click to start</b>";this.soundManager.locked||(e+="<br /><span>Skip this screen from Options</span>"),this.warning(e),await this.soundManager.unlock()}this.clearMessage(),setInterval(this.loopCheck.bind(this),1e3),this.renderer=new ft(this.root,this.soundManager,this),this.settings.addEventListener("updated",this.settingsUpdated.bind(this)),this.settingsUpdated(),this.setColour(this.colourIndex),this.animationLoop(),this.settings.load?await this.resourceManager.addAll(this.settings.respacks,(t=>{this.preloader.style.backgroundPosition=100-100*t+"% 0%";let e=Math.floor(t*this.settings.preloadMax),n=this.settings.preloadMax.toString(this.settings.preloadBase).length;this.preloadMsg.textContent=this.settings.preloadPrefix+(Array(n).join("0")+e.toString(this.settings.preloadBase)).slice(-n)})):this.preloader.style.display="none",this.preloader.classList.add("hues-preloader--loaded"),this.callEventListeners("loaded"),this.settings.firstImage?this.setImageByName(this.settings.firstImage):this.setImage(0),this.settings.autoplay&&(this.settings.firstSong?this.setSongByName(this.settings.firstSong):this.setSong(0))}catch(t){this.error(t)}}makePreloader(t){if(this.preloader=document.createElement("div"),this.preloader.className="hues-preloader",t.appendChild(this.preloader),this.settings.preloadTitle){let t=document.createElement("div");t.className="hues-preloader__title",t.textContent=this.settings.preloadTitle,this.preloader.appendChild(t)}this.preloadMsg=document.createElement("div"),this.preloadMsg.className="hues-preloader__text",this.preloadMsg.textContent="Initialising...",this.preloader.appendChild(this.preloadMsg),this.preloadSubMsg=document.createElement("div"),this.preloadSubMsg.className="hues-preloader__subtext",this.preloader.appendChild(this.preloadSubMsg)}resizeVisualiser(){this.soundManager.initVisualiser(this.visualiser.width/2)}updateVisualiser(){if("on"!=this.settings.visualiser)return;let t=this.soundManager.getVisualiserData();if(!t)return;this.vCtx.clearRect(0,0,this.vCtx.canvas.width,this.vCtx.canvas.height);let e=this.vCtx.createLinearGradient(0,64,0,0);this.invert?(e.addColorStop(1,"rgba(20,20,20,0.6)"),e.addColorStop(0,"rgba(255,255,255,0.6)")):(e.addColorStop(1,"rgba(255,255,255,0.6)"),e.addColorStop(0,"rgba(20,20,20,0.6)")),this.vCtx.fillStyle=e;let n,i=0;for(let e=0;e<t.length;e++){let s=t[e];for(let r=0;r<s.length;r++){let a=0;a=2==t.length&&0===e?s.length-r-1:r,n=s[a]/4,this.vCtx.fillRect(i,this.vCtx.canvas.height-n,2,n),i+=2}}}animationLoop(){if(requestAnimationFrame(this.animationLoop.bind(this)),!this.soundManager.playing||!this.currentSong)return void this.callEventListeners("frame");this.updateVisualiser();let t=this.soundManager.currentTime;this.callEventListeners("time",this.soundManager.clampedTime),t>=0&&this.doBuildup&&(this.currentSong.buildupPlayed=!0);for(let e=this.beatIndex*this.getBeatLength();e<t;e=++this.beatIndex*this.getBeatLength())for(const[t,e]of this.getBeats(this.beatIndex).entries())this.beater(e,t);this.callEventListeners("frame")}recalcBeatIndex(t){var e;let n="number"==typeof t?t:this.soundManager.currentTime;if(this.beatIndex=Math.floor(n/(n<0?this.buildLength:this.loopLength)),this.beatIndex!=this.beatIndex||!this.currentSong)return void this.setInvert(!1);let i=0,s=0;for(let t=0;t<this.currentSong.bankCount;t++){const n=this.currentSong.loop.banks[t],r=null===(e=this.currentSong.build)||void 0===e?void 0:e.banks[t];let a;this.beatIndex<0?a=r.slice(0,Math.max(this.beatIndex+r.length,0)):(s+=(n.match(/i|I/g)||[]).length%2,a=(r||"")+n.slice(0,this.beatIndex)),i+=(a.match(/i|I/g)||[]).length}s%2||this.setInvert(i%2)}getBeatIndex(){return this.soundManager.playing&&this.currentSong?this.beatIndex<0?this.beatIndex:this.beatIndex%this.currentSong.loop.mapLen:0}getSafeBeatIndex(){let t=this.getBeatIndex();return t<0?0:t}blurUpdated(t,e){this.callEventListeners("blurupdate",t,e)}nextSong(){let t=(this.songIndex+1)%this.resourceManager.enabledSongs.length;this.setSong(t)}previousSong(){let t=(this.songIndex-1+this.resourceManager.enabledSongs.length)%this.resourceManager.enabledSongs.length;this.setSong(t)}setSongByName(t){let e=0,n=0;for(const[i,s]of this.resourceManager.enabledSongs.entries()){let r=s.title.score(t);r>n&&(n=r,e=i)}return this.setSong(e)}setSongOject(t){for(let e=0;e<this.resourceManager.enabledSongs.length;e++)if(this.resourceManager.enabledSongs[e]===t)return this.setSong(e)}setSong(t,e=!1){var n;if(this.currentSong!=this.resourceManager.enabledSongs[t]){if(e||(this.lastSongArray=[]),this.lastSongArray.push(t),this.songIndex=t,this.currentSong=this.resourceManager.enabledSongs[this.songIndex],void 0===this.currentSong&&(this.currentSong=new di("None")),console.log("Next song:",this.songIndex,this.currentSong),this.callEventListeners("newsong",this.currentSong),this.loopCount=0,null===(n=this.currentSong.build)||void 0===n?void 0:n.sound)switch(this.settings.playBuildups){case"off":this.currentSong.buildupPlayed=!0,this.doBuildup=!1;break;case"on":this.currentSong.buildupPlayed=!1,this.doBuildup=!0;break;case"once":this.doBuildup=!this.currentSong.buildupPlayed}return this.setInvert(!1),this.renderer.doInstantBlackout(),this.soundManager.playSong(this.currentSong,this.doBuildup).then((()=>{this.resetAudio(),this.fillBuildup(),this.callEventListeners("songstarted",this.currentSong)}))}}updateBeatLength(){var t,e,n;(null===(t=this.currentSong)||void 0===t?void 0:t.loop.sound)?this.loopLength=this.soundManager.loop.length/this.currentSong.loop.mapLen:this.loopLength=-1,(null===(n=null===(e=this.currentSong)||void 0===e?void 0:e.build)||void 0===n?void 0:n.sound)?this.buildLength=this.soundManager.build.length/this.currentSong.build.mapLen:this.buildLength=-1}getBeatLength(){return this.beatIndex<0?this.buildLength:this.loopLength}fillBuildup(){var t,e;if(this.updateBeatLength(),null===(e=null===(t=this.currentSong)||void 0===t?void 0:t.build)||void 0===e?void 0:e.sound)if(this.currentSong.independentBuild)console.log("New behaviour - separate build/loop lengths");else{console.log("Flash behaviour - filling buildup");let t=Math.floor(this.soundManager.build.length/this.loopLength);t<1&&(t=1),console.log("Buildup length:",t);let e=this.currentSong.build.banks;for(let n=0;n<e.length;n++)for(;e[n].length<t;)e[n]+=".";this.currentSong.build.checkConsistency()}this.updateBeatLength(),this.recalcBeatIndex(this.doBuildup?-this.soundManager.build.length:0)}randomSong(){let t=this.resourceManager.enabledSongs.length,e=Math.floor(Math.random()*t);if(t>1&&(e==this.songIndex||-1!=this.lastSongArray.indexOf(e)))this.randomSong();else{console.log("Randoming a song!"),this.setSong(e,!0);let n=Math.min(5,Math.floor(t/2));for(;this.lastSongArray.length>n&&n>=0;)this.lastSongArray.shift()}}loopCheck(){Math.floor(this.soundManager.currentTime/this.soundManager.loop.length)>this.loopCount&&this.onLoop()}onLoop(){switch(this.loopCount++,this.settings.autoSong){case"loop":console.log("Checking loops"),this.loopCount>=this.settings.autoSongDelay&&this.doAutoSong();break;case"time":console.log("Checking times"),this.soundManager.loop.length*this.loopCount>=60*this.settings.autoSongDelay&&this.doAutoSong()}}doAutoSong(){if(this.resourceManager.enabledSongs.length<2)return;let t;t="on"===this.settings.autoSongShuffle?()=>this.randomSong():()=>this.nextSong(),"on"===this.settings.autoSongFadeout?this.soundManager.fadeOut(t):t()}songDataUpdated(){this.currentSong&&(this.callEventListeners("newsong",this.currentSong),this.callEventListeners("newimage",this.currentImage))}resetAudio(){this.beatIndex=0,this.songDataUpdated(),"on"==this.settings.visualiser&&this.soundManager.initVisualiser(this.visualiser.width/2)}randomImage(){if("on"==this.settings.shuffleImages){let t=this.resourceManager.enabledImages.length,e=Math.floor(Math.random()*t);if((e==this.imageIndex||-1!=this.lastImageArray.indexOf(e))&&t>1)this.randomImage();else{this.setImage(e,!0),this.lastImageArray.push(e);let n=Math.min(20,Math.floor(t/2));for(;this.lastImageArray.length>n&&n>=0;)this.lastImageArray.shift()}}else{let t=(this.imageIndex+1)%this.resourceManager.enabledImages.length;this.setImage(t)}}setImage(t,e=!1){this.imageIndex=t||0;let n=this.resourceManager.enabledImages[this.imageIndex];n==this.currentImage&&n||(e||(this.lastImageArray=[]),n?this.currentImage=n:(this.currentImage={enabled:!0,name:"None",fullname:"None",align:"center",bitmaps:[],source:"",frameDurations:[],animated:!1,beatsPerAnim:0},this.imageIndex=-1,this.lastImageArray=[]),this.callEventListeners("newimage",this.currentImage))}setImageByName(t){let e=this.resourceManager.enabledImages;for(let n=0;n<e.length;n++)if(e[n].name==t||e[n].fullname==t)return void this.setImage(n);this.setImage(0)}nextImage(){this.setIsFullAuto(!1);let t=(this.imageIndex+1)%this.resourceManager.enabledImages.length;this.setImage(t)}previousImage(){this.setIsFullAuto(!1);let t=(this.imageIndex-1+this.resourceManager.enabledImages.length)%this.resourceManager.enabledImages.length;this.setImage(t)}randomColourIndex(){let t=Math.floor(Math.random()*this.colours.length);return t==this.colourIndex?this.randomColourIndex():t}randomColour(t=!1){let e=this.randomColourIndex();this.setColour(e,t)}setColour(t,e=!1){this.colourIndex=t;let n=this.colours[this.colourIndex];this.callEventListeners("newcolour",n,e)}getBeat(t,e){let n=this.currentSong;return t<0?n.build.banks[e][n.build.mapLen+t]:n.loop.banks[e][t%n.loop.mapLen]}getBeats(t){let e=this.currentSong;return t<0?e.build.beatsAt(e.build.mapLen+t):e.loop.beatsAt(t%e.loop.mapLen)}beater(t,e){var n;this.callEventListeners("beat",this.getBeatString(),this.getBeatIndex());const i=null!==(n=qr[t])&&void 0!==n?n:jr;let s="."!=t;for(const t of i)switch(t){case Pr.BlurX:this.renderer.doXBlur();break;case Pr.BlurY:this.renderer.doYBlur();break;case Pr.TrippyIn:this.renderer.doTrippyX();break;case Pr.TrippyOut:this.renderer.doTrippyY();break;case Pr.Blackout:this.renderer.doBlackout(),s=!1;break;case Pr.Whiteout:this.renderer.doBlackout(!0),s=!1;break;case Pr.ShortBlackout:this.renderer.doShortBlackout(this.getBeatLength()),s=!1;break;case Pr.ShortWhiteout:this.renderer.doShortBlackout(this.getBeatLength(),!0),s=!1;break;case Pr.RandomColour:this.randomColour();break;case Pr.ColourFade:this.renderer.doColourFade(this.timeToNextBeat(e)),this.randomColour(!0);break;case Pr.RandomImage:this.settings.fullAuto&&this.randomImage();break;case Pr.SliceX:this.renderer.doSlice(this.getBeatLength(),this.charsToNextBeat(e),"y");break;case Pr.SliceY:this.renderer.doSlice(this.getBeatLength(),this.charsToNextBeat(e),"x");break;case Pr.ShutterUp:this.renderer.doShutter("↑",this.getBeatLength(),this.charsToNextBeat(e));break;case Pr.ShutterDown:this.renderer.doShutter("↓",this.getBeatLength(),this.charsToNextBeat(e));break;case Pr.ShutterLeft:this.renderer.doShutter("←",this.getBeatLength(),this.charsToNextBeat(e));break;case Pr.ShutterRight:this.renderer.doShutter("→",this.getBeatLength(),this.charsToNextBeat(e));break;case Pr.InvertToggle:this.toggleInvert()}s&&this.renderer.clearBlackout()}charsToNextBeat(t){let e,n=this.currentSong.loop.mapLen;for(this.beatIndex<0&&(n-=this.beatIndex),e=1;e<=n&&"."==this.getBeat(e+this.beatIndex,t);e++);return e}timeToNextBeat(t){return this.charsToNextBeat(t)*this.getBeatLength()/this.soundManager.playbackRate}getBeatString(t=256){var e;let n="";if(this.currentSong){const i=null===(e=this.currentSong.build)||void 0===e?void 0:e.beatString,s=this.currentSong.loop.beatString;for(n=this.beatIndex<0?i.slice(i.length+this.beatIndex):s.slice(this.beatIndex%s.length);n.length<t;)n+=s}return n}setIsFullAuto(t){this.settings.fullAuto=t,this.userInterface&&this.callEventListeners("newmode",this.settings.fullAuto)}toggleFullAuto(){this.setIsFullAuto(!this.settings.fullAuto)}setInvert(t){this.invert=!!t,this.callEventListeners("invert",t)}toggleInvert(){this.setInvert(!this.invert)}changeUI(t){t>=0&&this.uiArray.length>t&&this.userInterface!=this.uiArray[t]&&(this.hideLists(),this.userInterface&&this.userInterface.disconnect(),this.userInterface=this.uiArray[t],this.userInterface.connectCore(this),this.userInterface.updateVolume(this.soundManager.lastVol),this.callEventListeners("newmode",this.settings.fullAuto),this.callEventListeners("newsong",this.currentSong),this.callEventListeners("newimage",this.currentImage),this.callEventListeners("newcolour",this.colours[this.colourIndex],!1),this.callEventListeners("beat",this.getBeatString(),this.getBeatIndex()),this.callEventListeners("invert",this.invert))}settingsUpdated(){var t,e;switch(this.callEventListeners("settingsupdated"),this.settings.currentUI){case"retro":this.changeUI(0);break;case"v4.20":this.changeUI(1);break;case"modern":this.changeUI(2);break;case"xmas":this.changeUI(3);break;case"hlwn":this.changeUI(4);break;case"mini":this.changeUI(5)}switch(this.settings.colourSet){case"normal":this.colours=Wr;break;case"pastel":this.colours=Hr;break;case"v4.20":this.colours=Kr}switch(this.settings.blackoutUI){case"off":null===(t=this.userInterface)||void 0===t||t.show();break;case"on":void 0!==this.renderer.blackoutStart&&(null===(e=this.userInterface)||void 0===e||e.hide())}switch(this.settings.visualiser){case"off":this.visualiser.classList.add("hidden");break;case"on":this.visualiser.classList.remove("hidden"),this.soundManager.vReady||this.soundManager.initVisualiser(this.visualiser.width/2)}"off"==this.autoSong&&"off"!=this.settings.autoSong&&(console.log("Resetting loopCount since AutoSong was enabled"),this.loopCount=0),this.autoSong=this.settings.autoSong}enabledChanged(){this.resourceManager.rebuildEnabled()}hideLists(){this.resourceManager.hideLists()}toggleSongList(){this.window.hide(),this.resourceManager.toggleSongList()}toggleImageList(){this.window.hide(),this.resourceManager.toggleImageList()}openSongSource(){this.currentSong&&this.currentSong.source&&window.open(this.currentSong.source,"_blank")}openImageSource(){this.currentImage&&this.currentImage.source&&window.open(this.currentImage.source,"_blank")}keyHandler(t){var e;switch(t){case 37:this.previousImage();break;case 39:this.nextImage();break;case 38:this.nextSong();break;case 40:this.previousSong();break;case 70:this.toggleFullAuto();break;case 109:case 189:case 173:this.soundManager.decreaseVolume();break;case 107:case 187:case 61:this.soundManager.increaseVolume();break;case 66:this.soundManager.seek(-this.soundManager.build.length);break;case 77:this.soundManager.toggleMute();break;case 72:null===(e=this.userInterface)||void 0===e||e.toggleHide();break;case 82:this.window.selectTab("RESOURCES");break;case 69:this.window.selectTab("EDITOR");break;case 79:this.window.selectTab("OPTIONS");break;case 73:this.window.selectTab("INFO");break;case 49:this.settings.currentUI="retro";break;case 50:this.settings.currentUI="v4.20";break;case 51:this.settings.currentUI="modern";break;case 52:this.settings.currentUI="xmas";break;case 53:this.settings.currentUI="hlwn";break;case 54:this.settings.currentUI="mini";break;case 67:this.toggleImageList();break;case 83:this.toggleSongList();break;case 87:this.window.toggle();break;case 78:this.randomSong();break;case 76:this.resourceManager.fileInput.click();break;default:return!0}return!1}error(t){console.error(t),this.preloadSubMsg.textContent=t,this.preloadMsg.style.color="#F00"}warning(t){console.warn(t),this.preloadSubMsg.innerHTML=t,this.preloadMsg.style.color="#F93"}clearMessage(){this.preloadSubMsg.textContent="",this.preloadMsg.style.color=""}}})()})();
//# sourceMappingURL=hues-min.js.map